(function(){function k(a){throw a;}var l=void 0,p=!0,q=null,s=!1;function aa(){return function(){}}function t(a){return function(){return this[a]}}function ba(a){return function(){return a}}var u,w=this;function ca(a){a=a.split(".");for(var b=w,c;c=a.shift();)if(b[c]!=q)b=b[c];else return q;return b}
function da(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function x(a){return a!==l}function y(a){return"array"==da(a)}function ea(a){var b=da(a);return"array"==b||"object"==b&&"number"==typeof a.length}function A(a){return"string"==typeof a}function fa(a){return"boolean"==typeof a}function B(a){return"number"==typeof a}function ha(a){return"function"==da(a)}function C(a){var b=typeof a;return"object"==b&&a!=q||"function"==b}function ia(a){return a[ja]||(a[ja]=++ka)}
var ja="closure_uid_"+(1E9*Math.random()>>>0),ka=0;function la(a,b,c){return a.call.apply(a.bind,arguments)}function ma(a,b,c){a||k(Error());if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}
function na(a,b,c){na=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?la:ma;return na.apply(q,arguments)}function oa(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=Array.prototype.slice.call(arguments);b.unshift.apply(b,c);return a.apply(this,b)}}var pa=Date.now||function(){return+new Date};
function E(a,b){var c=a.split("."),d=w;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&x(b)?d[e]=b:d=d[e]?d[e]:d[e]={}}function F(a,b){function c(){}c.prototype=b.prototype;a.L=b.prototype;a.prototype=new c};function G(a,b,c,d){this.lower=a;this.upper=b;this.lowerOpen=!!c;this.upperOpen=!!d;ha(Object.freeze)&&Object.freeze(this)}G.prototype.lower=l;G.prototype.upper=l;G.prototype.toJSON=function(){return qa(this)};function ra(a,b,c,d){return new G(a,b,c,d)}function sa(a){var b;y(a)?(b=ta(H(a)),b.push("\uffff")):A(a)?b=a+"\uffff":k(new I);return ra(a,b,s,p)}function qa(a){a=a||{};return{lower:a.lower,upper:a.upper,lowerOpen:a.lowerOpen,upperOpen:a.upperOpen}}
function ua(a){return a==q?q:a instanceof va?a:a.upper!=q&&a.lower!=q?va.bound(a.lower,a.upper,!!a.lowerOpen,!!a.upperOpen):a.upper!=q?va.upperBound(a.upper,a.upperOpen):a.lower!=q?va.lowerBound(a.lower,a.lowerOpen):q}function wa(a){if(a instanceof G)return"";if(a!=q){if(C(a)){for(var b in a)if(a.hasOwnProperty(b)&&!(0<=xa(["lower","upper","lowerOpen","upperOpen"],b)))return'invalid attribute "'+b+'" in key range object';return""}return"key range must be an object"}return""}
G.prototype.sb=function(a){var b=this.lower,c=this.upper,d=this.lowerOpen,e=this.upperOpen;if(a.lower!=q&&(this.lower==q||a.lower>=this.lower))b=a.lower,d=a.lowerOpen||this.lowerOpen;if(a.upper!=q&&(this.upper==q||a.upper<=this.upper))c=a.upper,e=a.upperOpen||this.upperOpen;return ra(b,c,d,e)};
function ya(a,b,c,d){var e,f,g,h;if("^"==a)return sa(b);"<"==a||"<="==a?(e=b,g="<"==a):">"==a||">="==a?(f=b,h=">"==a):"="==a||"=="==a?e=f=b:k(new I("invalid op: "+a));"<"==c||"<="==c?(e=d,g="<"==c):">"==c||">="==c?(f=d,h=">"==c):x(c)&&k(new I("invalid op2: "+c));return ra(f,e,h,g)}var va=w.IDBKeyRange||w.webkitIDBKeyRange||G;function za(a,b){for(var c=1;c<arguments.length;c++){var d=String(arguments[c]).replace(/\$/g,"$$$$");a=a.replace(/\%s/,d)}return a}function Aa(a,b){return a.replace(/(\r\n|\r|\n)/g,b?"<br />":"<br>")}function Ba(a){if(!Ca.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(Da,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(Ea,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(Fa,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(Ga,"&quot;"));return a}var Da=/&/g,Ea=/</g,Fa=/>/g,Ga=/\"/g,Ca=/[&<>\"]/;
function Ha(a){return Aa(a.replace(/  /g," &#160;"),l)}function Ia(a,b){for(var c=b.length,d=0;d<c;d++){var e=1==c?b:b.charAt(d);if(a.charAt(0)==e&&a.charAt(a.length-1)==e)return a.substring(1,a.length-1)}return a}var Ja={"\x00":"\\0","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\x0B",'"':'\\"',"\\":"\\\\"},Ka={"'":"\\'"};
function J(a){a=String(a);if(a.quote)return a.quote();for(var b=['"'],c=0;c<a.length;c++){var d=a.charAt(c),e=d.charCodeAt(0),f=b,g=c+1,h;if(!(h=Ja[d])){if(!(31<e&&127>e))if(d in Ka)d=Ka[d];else if(d in Ja)d=Ka[d]=Ja[d];else{e=d;h=d.charCodeAt(0);if(31<h&&127>h)e=d;else{if(256>h){if(e="\\x",16>h||256<h)e+="0"}else e="\\u",4096>h&&(e+="0");e+=h.toString(16).toUpperCase()}d=Ka[d]=e}h=d}f[g]=h}b.push('"');return b.join("")};function La(a,b){var c,d;2==arguments.length&&A(arguments[1])?(c=p,d=arguments[1].split(".")):d=(c=ea(b))?b:arguments;for(c=c?0:1;c<d.length&&!(a=a[d[c]],!x(a));c++);return a}var Ma={};
function Na(a){a=[a];for(var b=new Oa,c=0,d,e;(e=a.pop())!==l;){0===c%4&&12<c+4&&(b.write(c),c=0);d=typeof e;if(e instanceof Array)if(c+=4,0<e.length){a.push(Ma);for(d=e.length;d--;)a.push(e[d]);continue}else b.write(c);else if("number"===d)c+=1,b.write(c),Pa(b,e);else if(e instanceof Date)c+=2,b.write(c),Pa(b,e.valueOf());else if("string"===d){c+=3;b.write(c);c=b;for(d=0;d<e.length;d++){var f=e.charCodeAt(d);126>=f?c.write(f+1):16510>=f?(f-=127,c.write(128|f>>8,f&255)):c.write(192|f>>10,f>>2|255,
(f|3)<<6)}c.write(0)}else if(e===Ma)b.write(0);else return"";c=0}return b.trim().toString()}
function Pa(a,b){var c,d,e;c=b;var f=e=d=0;if(0!==c)if(isFinite(c)){0>c&&(d=1,c=-c);f=0;if(2.2250738585072014E-308<=c){for(e=c;1>e;)f--,e*=2;for(;2<=e;)f++,e/=2;e=f+1023}f=e?Math.floor(4503599627370496*(c/Math.pow(2,f)-1)):Math.floor(c/4.9E-324)}else e=2047,isNaN(c)?f=0x8000000000000:-Infinity===c&&(d=1);c=d;d=e;e=f;c&&(e=0xfffffffffffff-e,d=2047-d);a.write((c?0:128)|d>>4);a.write((d&15)<<4|0|e/281474976710656);e%=281474976710656;c=0|e/4294967296;a.write(c>>8,c&255);e%=4294967296;c=0|e/65536;a.write(c>>
8,c&255);c=e%65536;a.write(c>>8,c&255)}function Qa(a){var b=a.pa()|0,c=b>>7?s:p,d=c?-1:1,e=(b&127)<<4,b=a.pa()|0,e=e+(b>>4);c&&(e=2047-e);for(var b=[c?15-(b&15):b&15],f=6;f--;)b.push(c?255-(a.pa()|0):a.pa()|0);a=0;for(f=7;f--;)a=a/256+b[f];a/=16;return 0===a&&0===e?0:(a+1)*Math.pow(2,e-1023)*d}
function Ra(a){for(var b=[],c=0,d=0,e=0,f,g;;){f=a.pa();if(0===f||f==q)break;0===c?(g=f>>6,2>g&&!isNaN(f)?b.push(String.fromCharCode(f-1)):(c=g,d=f<<10,e++)):2===c?(b.push(String.fromCharCode(d+f+127)),c=d=e=0):2===e?(d+=f<<2,e++):(b.push(String.fromCharCode(d|f>>6)),c=d=e=0)}return b.join("")}function Ta(a){this.a=q;var b=a.length-1,c=-1;this.pa=function(){return this.a=c<b?parseInt(a[++c]+a[++c],16):q}}
function Oa(){var a=[],b;this.write=function(c){for(var d=0;d<arguments.length;d++)b=arguments[d].toString(16),a.push(2===b.length?b:b="0"+b)};this.toString=function(){return a.length?a.join(""):q};this.trim=function(){for(var b=a.length;"00"===a[--b];);a.length=++b;return this}}function Ua(a,b){var c=Na(a),d=Na(b);return c>d?1:c==d?0:-1};function Va(a){Error.captureStackTrace?Error.captureStackTrace(this,Va):this.stack=Error().stack||"";a&&(this.message=String(a))}F(Va,Error);Va.prototype.name="CustomError";function I(a){Va.call(this,a);this.name="ydn.error.ArgumentException"}F(I,Va);F(I,Va);function Wa(a){Error.captureStackTrace?Error.captureStackTrace(this,Wa):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InternalError"}F(Wa,Error);Wa.prototype.name="ydn.error.InternalError";function Xa(a,b,c,d,e){if(!(b instanceof G)){var f;A(b)?f=ya(b,c,d,e):b!=q?b instanceof G?f=b:C(b)?f=new G(b.lower,b.upper,b.lowerOpen,b.upperOpen):k(new I("Invalid key range: "+b+" of type "+typeof b)):f=q;b=f}this.a=b;this.da=a}Xa.prototype.da="";
function Ya(a,b,c){var d="",e=[];if(c)if(c==q||c.lower==q||c.upper==q?0:y(c.lower)&&y(c.upper)?c.lower.length==c.upper.length-1&&"\uffff"==c.upper[c.upper.length-1]&&c.lower.every(function(a,b){return a==c.upper[b]}):!c.lowerOpen&&!c.upperOpen&&c.lower.length==c.upper.length+1&&"\uffff"==c.upper[c.lower.length-1])if(A(a)){var f=J(a),d=f+" LIKE ?";e.push(K(c.lower,b)+"%")}else for(var g=0;g<c.lower.length;g++)0<g&&(d+=" AND "),f=J(a[g]),d+=f+" = ?",e.push(c.lower[g]);else if(c.lower!=q&&c.upper!=q&&
0==Ua(c.lower,c.upper))if(y(b))f=J(a),d=f+" LIKE ?",e.push("%|"+c.lower+"|%");else if(ea(c.lower))for(g=0;g<c.lower.length;g++)0<g&&(d+=" AND "),f=J(a[g]),d+=f+" = ?",e.push(K(c.lower[g],b[g]));else f=J(y(a)?a.join(", "):a),d=f+" = ?",e.push(K(c.lower,b));else{if(c.lower!=q)if(y(a))for(var h="=",g=0;g<c.lower.length;g++)0<g&&(d+=" AND "),g==c.lower.length-1&&(h=c.lowerOpen?" > ":" >= "),f=J(a[g]),d+=" "+f+h+"?",f=b?b[g]:l,e.push(K(c.lower[g],f));else h=c.lowerOpen?" > ":" >= ",f=J(a),d+=" "+f+h+"?",
e.push(K(c.lower,b));if(c.upper!=q)if(d+=0<d.length?" AND ":" ",y(a)){h="=";for(g=0;g<a.length;g++){0<g&&(d+=" AND ");g>=c.upper.length-1&&(h=c.upperOpen?" < ":" <= ");var f=J(a[g]),d=d+(" "+f+h+"?"),f=b?b[g]:l,j=c.upper[g],j=j!=q?j:"\uffff";e.push(K(j,f))}}else h=c.upperOpen?" < ":" <= ",f=J(a),d+=" "+f+h+"?",e.push(K(c.upper,b))}return{sql:d,params:e}}Xa.prototype.sb=function(a){if(this.da!=a.da)return q;a=this.a!=q&&a.a!=q?this.a.sb(a.a):this.a||a.a;return new Xa(this.da,a)};function Za(a,b){b.unshift(a);Va.call(this,za.apply(q,b));b.shift()}F(Za,Va);Za.prototype.name="AssertionError";function $a(a,b){k(new Za("Failure"+(a?": "+a:""),Array.prototype.slice.call(arguments,1)))};var ab=Array.prototype,xa=ab.indexOf?function(a,b,c){return ab.indexOf.call(a,b,c)}:function(a,b,c){c=c==q?0:0>c?Math.max(0,a.length+c):c;if(A(a))return!A(b)||1!=b.length?-1:a.indexOf(b,c);for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},bb=ab.forEach?function(a,b,c){ab.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=A(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},cb=ab.map?function(a,b,c){return ab.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=A(a)?
a.split(""):a,g=0;g<d;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e},db=ab.some?function(a,b,c){return ab.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=A(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return p;return s};function eb(a,b){var c=fb(a,b,l);return 0>c?q:A(a)?a.charAt(c):a[c]}function fb(a,b,c){for(var d=a.length,e=A(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return f;return-1}
function gb(a){if(!y(a))for(var b=a.length-1;0<=b;b--)delete a[b];a.length=0}function hb(a,b){var c=xa(a,b);0<=c&&ab.splice.call(a,c,1)}function ib(a){var b=a.length;if(0<b){for(var c=Array(b),d=0;d<b;d++)c[d]=a[d];return c}return[]}function kb(a,b,c,d){ab.splice.apply(a,lb(arguments,1))}function lb(a,b,c){return 2>=arguments.length?ab.slice.call(a,b):ab.slice.call(a,b,c)}
function mb(a,b){if(!ea(a)||!ea(b)||a.length!=b.length)return s;for(var c=a.length,d=nb,e=0;e<c;e++)if(!d(a[e],b[e]))return s;return p}function ob(a,b){return a>b?1:a<b?-1:0}function nb(a,b){return a===b};/*
 Portions of this code are from MochiKit, received by
 The Closure Authors under the MIT license. All other code is Copyright
 2005-2009 The Closure Authors. All Rights Reserved.
*/
function L(a,b){this.d=[];this.ja=a;this.j=b||q}u=L.prototype;u.na=s;u.Ia=s;u.tb=s;u.yc=s;u.Hb=s;u.ub=0;function pb(a,b){if(a.na)a.b instanceof L&&pb(a.b);else{if(a.a){var c=a.a;delete a.a;b?pb(c,b):(c.ub--,0>=c.ub&&pb(c))}a.ja?a.ja.call(a.j,a):a.Hb=p;a.na||a.o(new qb)}}u.Tb=function(a,b){this.tb=s;rb(this,a,b)};function rb(a,b,c){a.na=p;a.b=c;a.Ia=!b;sb(a)}function tb(a){a.na&&(a.Hb||k(new ub),a.Hb=s)}function M(a,b){tb(a);rb(a,p,b)}u.o=function(a){tb(this);rb(this,s,a)};
u.ga=function(a,b){return this.G(a,q,b)};u.Qb=function(a,b){return this.G(q,a,b)};u.wc=function(a,b){return this.G(a,a,b)};u.G=function(a,b,c){this.d.push([a,b,c]);this.na&&sb(this);return this};function vb(a){return db(a.d,function(a){return ha(a[1])})}
function sb(a){a.f&&(a.na&&vb(a))&&(w.clearTimeout(a.f),delete a.f);a.a&&(a.a.ub--,delete a.a);for(var b=a.b,c=s,d=s;a.d.length&&!a.tb;){var e=a.d.shift(),f=e[0],g=e[1],e=e[2];if(f=a.Ia?g:f)try{var h=f.call(e||a.j,b);x(h)&&(a.Ia=a.Ia&&(h==b||h instanceof Error),a.b=b=h);b instanceof L&&(d=p,a.tb=p)}catch(j){b=j,a.Ia=p,vb(a)||(c=p)}}a.b=b;d&&(b.G(na(a.Tb,a,p),na(a.Tb,a,s)),b.yc=p);c&&(a.f=w.setTimeout(function(){k(b)},0))}function xb(a){var b=new L;M(b,a);return b}
function yb(a){Error.captureStackTrace?Error.captureStackTrace(this,yb):this.stack=Error().stack||"";a&&(this.message=String(a))}F(yb,Error);function ub(){yb.call(this)}F(ub,yb);ub.prototype.message="Deferred has already fired";ub.prototype.name="AlreadyCalledError";function qb(){yb.call(this)}F(qb,yb);qb.prototype.message="Deferred was cancelled";qb.prototype.name="CancelledError";function zb(){return new L}var Ab={READ_ONLY:"readonly",READ_WRITE:"readwrite",VERSION_CHANGE:"versionchange"},Bb=w.webkitIDBRequest&&"LOADING"in w.webkitIDBRequest?w.webkitIDBTransaction||w.IDBTransaction:w.IDBRequest&&"LOADING"in w.IDBRequest?w.IDBTransaction:Ab,N=Bb.READ_ONLY,Cb=Bb.READ_WRITE,Db=Bb.VERSION_CHANGE;function Eb(a,b){return a?b?"prevunique":"prev":b?"nextunique":"next"};function Fb(a,b){for(var c in a)b.call(l,a[c],c,a)}function Gb(a,b){for(var c=ea(b),d=c?b:arguments,c=c?0:1;c<d.length&&!(a=a[d[c]],!x(a));c++);return a}var Hb="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ib(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<Hb.length;f++)c=Hb[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};var Jb,Kb,Lb,Mb;function Nb(){return w.navigator?w.navigator.userAgent:q}Mb=Lb=Kb=Jb=s;var Pb;if(Pb=Nb()){var Qb=w.navigator;Jb=0==Pb.indexOf("Opera");Kb=!Jb&&-1!=Pb.indexOf("MSIE");Lb=!Jb&&-1!=Pb.indexOf("WebKit");Mb=!Jb&&!Lb&&"Gecko"==Qb.product}var Rb=Jb,Ub=Kb,Vb=Mb,Wb=Lb;function Xb(){var a=w.document;return a?a.documentMode:l}var Yb;
a:{var Zb="",$b;if(Rb&&w.opera)var ac=w.opera.version,Zb="function"==typeof ac?ac():ac;else if(Vb?$b=/rv\:([^\);]+)(\)|;)/:Ub?$b=/MSIE\s+([^\);]+)(\)|;)/:Wb&&($b=/WebKit\/(\S+)/),$b)var bc=$b.exec(Nb()),Zb=bc?bc[1]:"";if(Ub){var cc=Xb();if(cc>parseFloat(Zb)){Yb=String(cc);break a}}Yb=Zb}var dc={};
function ec(a){var b;if(!(b=dc[a])){b=0;for(var c=String(Yb).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),d=String(a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",h=d[f]||"",j=/(\d*)(\D*)/g,m=/(\d*)(\D*)/g;do{var n=j.exec(g)||["","",""],r=m.exec(h)||["","",""];if(0==n[0].length&&0==r[0].length)break;b=((0==n[1].length?0:parseInt(n[1],10))<(0==r[1].length?0:parseInt(r[1],10))?-1:(0==n[1].length?0:parseInt(n[1],10))>(0==r[1].length?
0:parseInt(r[1],10))?1:0)||((0==n[2].length)<(0==r[2].length)?-1:(0==n[2].length)>(0==r[2].length)?1:0)||(n[2]<r[2]?-1:n[2]>r[2]?1:0)}while(0==b)}b=dc[a]=0<=b}return b}var fc=w.document,gc=!fc||!Ub?l:Xb()||("CSS1Compat"==fc.compatMode?parseInt(Yb,10):5);function hc(a){return ic(a||arguments.callee.caller,[])}
function ic(a,b){var c=[];if(0<=xa(b,a))c.push("[...circular reference...]");else if(a&&50>b.length){c.push(jc(a)+"(");for(var d=a.arguments,e=0;e<d.length;e++){0<e&&c.push(", ");var f;f=d[e];switch(typeof f){case "object":f=f?"object":"null";break;case "string":break;case "number":f=String(f);break;case "boolean":f=f?"true":"false";break;case "function":f=(f=jc(f))?f:"[fn]";break;default:f=typeof f}40<f.length&&(f=f.substr(0,40)+"...");c.push(f)}b.push(a);c.push(")\n");try{c.push(ic(a.caller,b))}catch(g){c.push("[exception trying to get caller]\n")}}else a?
c.push("[...long stack...]"):c.push("[end]");return c.join("")}function jc(a){if(kc[a])return kc[a];a=String(a);if(!kc[a]){var b=/function ([^\(]+)/.exec(a);kc[a]=b?b[1]:"[Anonymous]"}return kc[a]}var kc={};function lc(a,b,c,d,e){"number"==typeof e||mc++;this.j=d||pa();this.f=a;this.e=b;this.d=c;delete this.b;delete this.a}lc.prototype.b=q;lc.prototype.a=q;var mc=0;function oc(a){this.f=a}oc.prototype.d=q;oc.prototype.b=q;oc.prototype.e=q;oc.prototype.a=q;function pc(a,b){this.name=a;this.value=b}pc.prototype.toString=t("name");var qc=new pc("SHOUT",1200),rc=new pc("SEVERE",1E3),sc=new pc("WARNING",900),tc=new pc("INFO",800),uc=new pc("CONFIG",700),vc=new pc("FINE",500),wc=new pc("FINER",400),xc=new pc("FINEST",300),yc=[new pc("OFF",Infinity),qc,rc,sc,tc,uc,vc,wc,xc,new pc("ALL",0)],zc=q;oc.prototype.getName=t("f");
function Ac(a){if(a.b)return a.b;if(a.d)return Ac(a.d);$a("Root logger has no level set.");return q}oc.prototype.log=function(a,b,c){if(a.value>=Ac(this).value){a=this.j(a,b,c);b="log:"+a.e;w.console&&(w.console.timeStamp?w.console.timeStamp(b):w.console.markTimeline&&w.console.markTimeline(b));w.msWriteProfilerMark&&w.msWriteProfilerMark(b);for(b=this;b;){c=b;var d=a;if(c.a)for(var e=0,f=l;f=c.a[e];e++)f(d);b=b.d}}};
oc.prototype.j=function(a,b,c){var d=new lc(a,String(b),this.f);if(c){d.b=c;var e;var f=arguments.callee.caller;try{var g;var h=ca("window.location.href");if(A(c))g={message:c,name:"Unknown error",lineNumber:"Not available",fileName:h,stack:"Not available"};else{var j,m,n=s;try{j=c.lineNumber||c.Yc||"Not available"}catch(r){j="Not available",n=p}try{m=c.fileName||c.filename||c.sourceURL||w.$googDebugFname||h}catch(v){m="Not available",n=p}g=n||!c.lineNumber||!c.fileName||!c.stack?{message:c.message,
name:c.name,lineNumber:j,fileName:m,stack:c.stack||"Not available"}:c}e="Message: "+Ba(g.message)+'\nUrl: <a href="view-source:'+g.fileName+'" target="_new">'+g.fileName+"</a>\nLine: "+g.lineNumber+"\n\nBrowser stack:\n"+Ba(g.stack+"-> ")+"[end]\n\nJS stack traversal:\n"+Ba(hc(f)+"-> ")}catch(z){e="Exception trying to expose exception! You win, we lose. "+z}d.a=e}return d};function Bc(a,b){a.log(rc,b,l)}function O(a,b){a.log(sc,b,l)}function Cc(a,b){a.log(vc,b,l)}function Q(a,b){a.log(wc,b,l)}
function R(a,b){a.log(xc,b,l)}var Dc={},Ec=q;function Fc(){Ec||(Ec=new oc(""),Dc[""]=Ec,Ec.b=uc)}function Gc(){Fc();return Ec}function T(a){Fc();var b;if(!(b=Dc[a])){b=new oc(a);var c=a.lastIndexOf("."),d=a.substr(c+1),c=T(a.substr(0,c));c.e||(c.e={});c.e[d]=b;b.d=c;Dc[a]=b}return b};function W(a,b,c,d,e,f){A(a)||k(new I("store name must be a string"));this.P=a;this.index=b;this.N=x(f)?f:!!A(this.index);fa(this.N)||k(new I("key_only"));x(d)&&!fa(d)&&k(new I("reverse"));x(e)&&!fa(e)&&k(new I("unique"));a="next";d&&e?a="prevunique":d?a="prev":e&&(a="nextunique");this.direction=a;(d=wa(c))&&k(new I("Invalid key range: "+d));this.O=ua(c);this.Xa=[];this.Wb=[];this.Xb=[];this.wb=[];this.vb=[];this.d=0;this.J=this.b=this.a=l;this.Ka=s}
function Hc(a,b,c){3<arguments.length&&k(new I("too many argument"));W.call(this,a,l,b,c,l,p)}F(Hc,W);function Ic(a,b,c,d,e){A(b)||k(new I("index name must be string"));W.call(this,a,b,c,d,e,p)}F(Ic,W);function Jc(a,b,c){3<arguments.length&&k(new I("too many argument"));W.call(this,a,l,b,c,l,s)}F(Jc,W);function Kc(a,b,c,d,e){A(b)||k(new I("index name must be string"));W.call(this,a,b,c,d,e,s)}F(Kc,W);function Lc(a){return x(a.J)?a.J===s?a.Ka?"working":"resting":"completed":"initial"}u=W.prototype;
u.nc=T("ydn.db.Iterator");u.Lc=t("P");u.va=t("index");u.J=l;u.Ka=s;u.l=t("a");u.Kc=function(){return A(this.index)?this.b:this.a};u.lc=function(){return this.O?this.O instanceof va?this.O:va.bound(this.O.lower,this.O.upper,this.O.lowerOpen,this.O.upperOpen):q};u.N=p;u.Mc=t("N");u.toJSON=function(){return{store:this.P,index:this.index,key_range:this.O?qa(this.O):q,direction:this.direction}};
u.toString=function(){var a=x(this.index)?":"+this.index:"";if(this.a!=q){var b="]",c="[",d=Lc(this);"working"==d?(c="{",b="}"):"resting"==d&&(c="(",b=")");a+=" "+c+this.a+", "+this.b+b}b=A(this.index)?"Index":"";b+=this.N?"Key":"Value";return b+"Iterator:"+this.P+a};u.key=t("a");u.Gc=function(a,b){this.a=a;this.b=b};u.Jc=t("d");u.Ac=t("J");u.stores=function(){return[this.P].concat(this.fb)};u.fb=[];u.xc=[];u.mc=function(){return"prev"===this.direction||"prevunique"===this.direction};
u.Nc=function(){return"nextunique"===this.direction||"prevunique"===this.direction};u.Xa=[];u.Wb=[];u.Xb=[];u.wb=[];u.vb=[];function Mc(a){a.a=y(a.a)?ib(a.a):a.a;a.b=y(a.b)?ib(a.b):a.b;a.Ka=s;a.J=s;R(a.nc,a+": exited")}
function Nc(a,b,c,d){if(0<a.Xa.length){var e,f,g=a.J===s;g?(e=a.a,f=a.b):a.d=0;a.Ka=p;var h=[],j=d.b(b,c,a.P,a.index,a.O,a.direction,a.N);j.xa(e,f,g);j.u=function(b,c){x(b)?(a.J=s,a.a=b,a.b=c,m()&&n()):(a.J=p,a.Ka=s)};e=function(b,c,d){m();x(c)&&(a.wb[b]=c,a.vb[b]=d);m()&&n()};for(f=0;f<a.Xa.length;f++)g=d.b(b,c,a.Xb[f]||a.P,a.Xa[f],a.Wb[f],a.direction,p),g.xa(a.wb[f],a.vb[f]),h.push(g),g.u=oa(e,f);var m=function(){return!h.some(function(a){return a.Y})},n=function(){for(var b=s,c=p,d=[],e=a.a,f=
0;f<h.length;f++){var g=h[f];if(g.X()){var m=Oc(a.a,g.l());d[f]=m;1===m?c=s:-1===m&&(c=s,b=p,1===Oc(g.l(),e)&&(e=g.l()))}else c=s}if(c){j.A(j.l(),j.W(),j.fa());for(f=0;f<h.length;f++)h[f].forward(p)}else if(b){e!=a.a&&j.Ua(e);for(f=0;f<h.length;f++)0==d[f]?h[f].H(e):-1==d[f]?h[f].H(e):h[f].X()?e!=h[f].l()&&h[f].H(e):h[f].H(e)}else{a.a!=e&&j.H(e);for(f=0;f<h.length;f++)(!h[f].X()||0!==Oc(h[f].l(),e))&&h[f].H(e)}};b=j}else{var r;(e=a.J===s)?(g=a.a,r=a.b):a.d=0;a.J=l;var v=d.b(b,c,a.P,a.index,a.O,a.direction,
a.N);R(a.nc,a+" created "+v);v.u=function(b,c,d){x(b)?(a.a=b,a.b=c,a.d++,v.A(b,c,d)):(a.J=p,v.A(l,l,l))};v.xa(g,r,e);b=v}return b}u.Oc=function(){"working"==Lc(this)&&k(new Pc("working"));this.d=0;this.J=this.b=this.a=l};function Qc(a,b,c,d,e,f){L.call(this,e,f);this.Z=a;this.e=[];this.m=!!b;this.eb=!!c;this.bb=!!d;for(b=0;b<a.length;b++)a[b].G(na(this.w,this,b,p),na(this.w,this,b,s));0==a.length&&!this.m&&M(this,this.e)}F(Qc,L);Qc.prototype.ia=0;Qc.prototype.w=function(a,b,c){this.ia++;this.e[a]=[b,c];this.na||(this.m&&b?M(this,[a,c]):this.eb&&!b?this.o(c):this.ia==this.Z.length&&M(this,this.e));this.bb&&!b&&(c=q);return c};Qc.prototype.o=function(a){Qc.L.o.call(this,a);bb(this.Z,function(a){pb(a)})};function Rc(a){Error.captureStackTrace?Error.captureStackTrace(this,Rc):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.InvalidKeyException"}F(Rc,Error);function Sc(a){Error.captureStackTrace?Error.captureStackTrace(this,Sc):this.stack=Error().stack||"";a&&(this.message=String(a))}F(Sc,Error);Sc.prototype.name="ydn.db.InternalError";
function Tc(a){Error.captureStackTrace?Error.captureStackTrace(this,Tc):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="InvalidStateError"}F(Tc,Error);function Uc(a){Error.captureStackTrace?Error.captureStackTrace(this,Uc):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="InvalidAccessError"}F(Uc,Error);function Vc(a){Error.captureStackTrace?Error.captureStackTrace(this,Vc):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="NotFoundError"}
F(Vc,Error);Vc.prototype.name="NotFoundError";function Wc(a){Error.captureStackTrace?Error.captureStackTrace(this,Wc):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="DataCloneError"}F(Wc,Error);function Xc(a,b){Error.captureStackTrace?Error.captureStackTrace(this,Xc):this.stack=Error().stack||"";b&&(this.message=String(b));this.message+=" :"+a.message+" ["+a.code+"]";this.name="SQLError"}F(Xc,Error);
function Yc(a,b){Error.captureStackTrace?Error.captureStackTrace(this,Yc):this.stack=Error().stack||"";b&&(this.message=String(b));this.message+=" :"+a.message;this.name="SecurityError"}F(Yc,Error);function Zc(a){Error.captureStackTrace?Error.captureStackTrace(this,Zc):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.SqlParseError"}F(Zc,Error);function $c(a,b,c){var d;C(a)?(d=a.store,b=a.id,a.parent!=q&&(c=new $c(a.parent))):x(b)?d=a:(d=a.lastIndexOf("^|"),b=a,0<d&&(b=a.substr(d),c=new $c(a.substring(0,d))),b=b.split("^:"),d=b[0],b=b[1],x(b)||k(Error("Invalid key value: "+a)));this.a=d;this.id=b;this.b=c||q}u=$c.prototype;u.toJSON=function(){var a={store:this.a,id:this.id};this.b&&(a.parent=this.b.toJSON());return a};u.valueOf=function(){return(this.b?this.b.valueOf()+"^|":"")+this.a+"^:"+this.id};
u.toString=function(){return this.valueOf().replace("^|","|").replace("^:",":")};u.Qc=t("a");u.Bc=t("id");u.Pc=t("b");function ad(a,b,c){this.ua=a;this.a=b;this.f=c}ad.prototype.c=T("ydn.db.core.req.RequestExecutor");ad.prototype.ua="";ad.prototype.f="";ad.prototype.toString=function(){return"RequestExecutor:"+this.f};function bd(a){Error.captureStackTrace?Error.captureStackTrace(this,bd):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.ArgumentException"}F(bd,Error);function cd(a){Error.captureStackTrace?Error.captureStackTrace(this,cd):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.NotSupportedException"}F(bd,Error);cd.prototype.name="ydn.error.NotSupportedException";
function dd(a){Error.captureStackTrace?Error.captureStackTrace(this,dd):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.NotImplementedException"}F(dd,Error);function ed(a){Error.captureStackTrace?Error.captureStackTrace(this,ed):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InternalError"}F(ed,Error);ed.prototype.name="ydn.InternalError";
function fd(a){Error.captureStackTrace?Error.captureStackTrace(this,fd):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.ConstrainError"}F(fd,Error);function gd(a){Error.captureStackTrace?Error.captureStackTrace(this,gd):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InvalidOperationException"}F(bd,Error);
function Pc(a){Error.captureStackTrace?Error.captureStackTrace(this,Pc):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InvalidOperationError"}F(Pc,Error);T("ydn");function ta(a){if(!A(a)||/^[\s\xa0]*$/.test(a))return{};try{return JSON.parse(a)}catch(b){k(b)}}function hd(a){var b;try{b=H(a)}catch(c){b=""}return b?b.substr(0,70):""}function H(a){return JSON.stringify(a)};function id(a,b,c){ad.call(this,a,b,c)}F(id,ad);u=id.prototype;u.c=T("ydn.db.core.req.IndexedDb");u.Va=function(a,b,c,d){function e(b){var m=a.objectStore(d[b]).count();m.onsuccess=function(a){g[b]=a.target.result;b++;b==d.length?(Q(f.c,"success "+h),c(g),c=q):e(b)};m.onerror=function(a){O(f.c,"error "+h);c(a,p);c=q}}var f=this,g=[],h="TxNo:"+b+" countStores: "+d;R(this.c,h);0==d.length?(c([]),c=q):e(0)};
u.qb=function(a,b,c,d,e,f){a=a.objectStore(d);var g="TxNo:"+b+" addObject: "+d+" "+f;R(this.c,g);var h=this,j;j=x(f)?a.add(e,f):a.add(e);j.onsuccess=function(a){R(h.c,"success "+g);c(a.target.result)};j.onerror=function(){R(h.c,"error "+g);c(j.error||Error(),p)}};
u.Db=function(a,b,c,d,e,f){a=a.objectStore(d);var g="TxNo:"+b+" putObject: "+d+" "+f;R(this.c,g);var h=this;b=x(f)?a.put(e,f):a.put(e);b.onsuccess=function(a){R(h.c,"success "+g);c(a.target.result)};b.onerror=function(a){"DataError"==a.name&&(a=H(e),a=new Rc(d+": "+a.substring(0,70)));R(h.c,"error "+g);c(a,p)}};
u.rb=function(a,b,c,d,e,f){function g(a){var b;b=f!=q?n.add(e[a],f[a]):n.add(e[a]);b.onsuccess=function(b){j++;h[a]=b.target.result;j==e.length?(R(m.c,"success "+r),c(h)):(b=a+10,b<e.length&&g(b))};b.onerror=function(b){j++;"DataError"==b.name?b=new Rc('put to "'+d+'": '+a+" of "+e.length):"DataCloneError"==b.name&&(b=new Wc('put to "'+d+'": '+a+" of "+e.length));R(m.c,"error "+r);c(b,p)}}var h=[],j=0,m=this,n=a.objectStore(d),r="TxNo:"+b+" addObjects: "+d+" "+e.length+" objects";R(this.c,r);if(0<
e.length)for(a=0;10>a&&a<e.length;a++)g(a);else c([])};
u.Eb=function(a,b,c,d,e,f){function g(a){var b;b=f!=q?v.put(e[a],f[a]):v.put(e[a]);b.onsuccess=function(b){m++;j[a]=b.target.result;m==e.length?h():(b=a+10,b<e.length&&g(b))};b.onerror=function(c){m++;O(r.c,"request result "+c.name+' error when put to "'+d+'" for object "'+hd(e[a])+'" at index '+a+" of "+e.length+" objects.");j[a]=b.error||c.target.result;n=p;m==e.length?h():(c=a+10,c<e.length&&g(c))}}function h(){n?(R(r.c,"error "+z),c(j,p)):(R(r.c,"success "+z),c(j))}var j=[],m=0,n=s,r=this,v=a.objectStore(d),
z="TxNo:"+b+" putObjects: "+d+" "+e.length+" objects";R(this.c,z);if(0<e.length)for(a=0;10>a&&a<e.length;a++)g(a);else c([])};
u.fc=function(a,b,c,d,e){function f(b){var c=e[b],r=c.a,U=a.objectStore(r),P;P=U.keyPath===q?U.put(d[b],c.id):U.put(d[b]);P.onsuccess=function(a){j++;h[b]=a.target.result;j==d.length?g():(a=b+10,a<d.length&&f(a))};P.onerror=function(a){j++;O(n.c,"request result "+a.name+' error when put keys to "'+r+'" for object "'+hd(d[b])+'" at index '+b+" of "+d.length+" objects.");h[b]=P.error||a.target.result;m=p;j==d.length?g():(a=b+10,a<d.length&&f(a))}}function g(){m?(R(n.c,"error "+r),c(h,p)):(R(n.c,"success "+
r),c(h))}var h=[],j=0,m=s,n=this,r="TxNo:"+b+" putByKeys: of "+d.length+" objects";R(this.c,r);if(0<d.length)for(b=0;10>b&&b<d.length;b++)f(b);else g()};u.Fb=function(a,b,c,d,e){var f=this;a=a.objectStore(d);var g="TxNo:"+b+" clearById: "+d+" "+e;R(this.c,g);b=a.openCursor(e);b.onsuccess=function(a){var b=a.target.result;b?(b=b["delete"](),b.onsuccess=function(){R(f.c,"success "+g);c(1)},b.onerror=function(){c(a,p)}):c(l)};b.onerror=function(a){R(f.c,"error "+g);c(a,p)}};
u.hc=function(a,b,c,d,e){var f=this,g=a.objectStore(d);a=g.count(e);var h="TxNo:"+b+" clearByKeyRange: "+d+" "+e;R(this.c,h);a.onsuccess=function(a){var b=a.target.result;a=g["delete"](e);a.onsuccess=function(){R(f.c,"success "+h);c(b)};a.onerror=function(a){R(f.c,"error "+h);c(a,p)}};a.onerror=function(a){R(f.c,"count error "+h);c(a,p)}};
u.Rb=function(a,b,c,d,e){var f=this;a=a.objectStore(d);var g="TxNo:"+b+" clearByKeyRange: "+d+" "+e;R(this.c,g);b=a["delete"](e);b.onsuccess=function(){R(f.c,"success "+g);c(l)};b.onerror=function(a){R(f.c,"error "+g);c(a,p)}};
u.gc=function(a,b,c,d,e,f){var g=this;a=a.objectStore(d).index(e);var h="TxNo:"+b+" clearByIndexKeyRange: "+d+":"+e+" "+f;R(this.c,h);b=a.openCursor(f);var j=0;b.onsuccess=function(a){var b=a.target.result;b?(a=b["delete"](),a.onsuccess=function(){j++;b["continue"]()},a.onerror=function(a){R(g.c,"error "+h);k(a)}):(R(g.c,"success "+h),c(j))};b.onerror=function(a){R(g.c,"error "+h);c(a,p)}};
u.Sa=function(a,b,c,d){var e=this,f=d.length,g=0,h="TxNo:"+b+" clearByStores: "+d;R(this.c,h);for(b=0;b<f;b++){var j=a.objectStore(d[b]).clear();j.onsuccess=function(){g++;g==f&&(R(e.c,"success "+h),c(g))};j.onerror=function(a){g++;g==f&&(R(e.c,"error "+h),c(a,p))}}};
function jd(a,b,c,d,e,f,g,h,j,m,n){var r=[];b=b.objectStore(e);h=Eb(h,n);var v="TxNo:"+c+" listByKeyRange: "+e+(f?":"+f:"")+(g?H(g):"");R(a.c,v);c=f?b.index(f).openCursor(g,h):b.openCursor(g,h);var z=s;c.onsuccess=function(b){if(b=b.target.result)if(!z&&0<m)z=p,b.advance(m);else if(r.push(b.value),r.length<j)b["continue"]();else R(a.c,"success "+v),d(r);else R(a.c,"success "+v),d(r)};c.onerror=function(b){R(a.c,"error "+v);d(b,p)}}u.Ma=function(a,b,c,d,e,f,g,h){jd(this,a,b,c,d,q,e,f,g,h)};
u.La=function(a,b,c,d,e,f,g,h,j,m){jd(this,a,b,c,d,e,f,g,h,j,m)};u.ac=function(a,b,c,d,e,f,g,h){var j=[],m=this;a=a.objectStore(d);f=Eb(f);var n="TxNo:"+b+" keysByKeyRange: "+d+" "+e;R(this.c,n);b=a.openCursor(e,f);var r=s;b.onsuccess=function(a){if(a=a.target.result)if(!r&&0<h)r=p,a.advance(h);else if(j.push(a.key),j.length<g)a["continue"]();else R(m.c,"success "+n),c(j);else R(m.c,"success "+n),c(j)};b.onerror=function(a){R(m.c,"error "+n);c(a,p)}};
u.$b=function(a,b,c,d,e,f,g,h,j,m){var n=[],r=this;a=a.objectStore(d).index(e);var v="TxNo:"+b+" keysByStore: "+d+":"+e+" "+f;R(this.c,v);b=a.openKeyCursor(f,Eb(g,m));var z=s;b.onsuccess=function(a){if(a=a.target.result)if(!z&&0<j)z=p,a.advance(j);else{if(n.push(a.primaryKey),n.length<h)a["continue"]()}else R(r.c,"success "+v),c(n)};b.onerror=function(a){R(r.c,"error "+v);c(a,p)}};
u.Ya=function(a,b,c,d,e){var f=this,g="TxNo:"+b+" getById: "+d+":"+e;R(this.c,g);a=a.objectStore(d).get(e);a.onsuccess=function(a){R(f.c,"success "+g);c(a.target.result)};a.onerror=function(a){R(f.c,"error "+g);c(a,p)}};
u.zb=function(a,b,c,d,e){function f(a){if(e[a]==q)if(j++,h[a]=l,j==n)R(g.c,"success "+r),c(h);else{var b=a+10;b<n&&f(b)}var d;try{d=m.get(e[a])}catch(U){"DataError"==U.name&&k(new Rc(e[a])),k(U)}d.onsuccess=function(b){j++;h[a]=b.target.result;j==n?(R(g.c,"success "+r),c(h)):(b=a+10,b<n&&f(b))};d.onerror=function(a){j++;R(g.c,"error "+r);c(a,p)}}var g=this,h=[],j=0,m=a.objectStore(d),n=e.length,r="TxNo:"+b+" listByIds: "+d+":"+n+" ids";R(this.c,r);if(0<n)for(a=0;10>a&&a<n;a++)f(a);else c([])};
u.Ab=function(a,b,c,d){function e(b){var n=d[b],n=a.objectStore(n.a).get(n.id);n.onsuccess=function(a){h++;g[b]=a.target.result;h==d.length?(R(f.c,"success "+j),c(g)):(a=b+10,a<d.length&&e(a))};n.onerror=function(a){h++;R(f.c,"error "+j);c(a,p)}}var f=this,g=[],h=0,j="TxNo:"+b+" listByKeys: "+d.length+" ids";R(this.c,j);if(0<d.length)for(b=0;10>b&&b<d.length;b++)e(b);else c([])};
u.ta=function(a,b,c,d,e,f){var g=this;a=a.objectStore(d);var h="TxNo:"+b+" countKeyRange: "+d+(f?":"+f:"")+(e?":"+H(e):"");R(this.c,h);f!=q?(b=a.index(f),e=e!=q?b.count(e):b.count()):e=e!=q?a.count(e):a.count();e.onsuccess=function(a){R(g.c,"success "+h);c(a.target.result)};e.onerror=function(a){R(g.c,"error "+h);c(a,p)}};function kd(){0!=ld&&(md[ia(this)]=this)}var ld=0,md={};kd.prototype.ia=s;kd.prototype.I=function(){if(!this.ia&&(this.ia=p,this.wa(),0!=ld)){var a=ia(this);delete md[a]}};kd.prototype.wa=function(){if(this.ja)for(;this.ja.length;)this.ja.shift()()};var nd=!Ub||Ub&&9<=gc,od=Ub&&!ec("9");!Wb||ec("528");Vb&&ec("1.9b")||Ub&&ec("8")||Rb&&ec("9.5")||Wb&&ec("528");Vb&&!ec("8")||Ub&&ec("9");function pd(a,b){this.type=a;this.a=this.target=b}pd.prototype.I=aa();pd.prototype.b=s;pd.prototype.d=p;pd.prototype.xb=function(){this.d=s};function qd(a){qd[" "](a);return a}qd[" "]=aa();function rd(a,b){a&&sd(this,a,b)}F(rd,pd);u=rd.prototype;u.target=q;u.clientX=0;u.clientY=0;u.Vb=q;function sd(a,b,c){var d=a.type=b.type;pd.call(a,d);a.target=b.target||b.srcElement;a.a=c;if((c=b.relatedTarget)&&Vb)try{qd(c.nodeName)}catch(e){}a.clientX=b.clientX!==l?b.clientX:b.pageX;a.clientY=b.clientY!==l?b.clientY:b.pageY;a.Vb=b;b.defaultPrevented&&a.xb();delete a.b}
u.xb=function(){rd.L.xb.call(this);var a=this.Vb;if(a.preventDefault)a.preventDefault();else if(a.returnValue=s,od)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};var td=0;function ud(){}ud.prototype.key=0;ud.prototype.qa=s;ud.prototype.Ra=s;ud.prototype.handleEvent=function(a){return this.a?this.ka.call(this.yb||this.src,a):this.ka.handleEvent.call(this.ka,a)};var vd={},wd={},xd={},yd={};
function zd(a,b,c,d,e){if(y(b))for(var f=0;f<b.length;f++)zd(a,b[f],c,d,e);else{a:{b||k(Error("Invalid event type"));d=!!d;var g=wd;b in g||(g[b]={R:0,C:0});g=g[b];d in g||(g[d]={R:0,C:0},g.R++);var g=g[d],f=ia(a),h;g.C++;if(g[f]){h=g[f];for(var j=0;j<h.length;j++)if(g=h[j],g.ka==c&&g.yb==e){if(g.qa)break;h[j].Ra=s;a=h[j];break a}}else h=g[f]=[],g.R++;var m=Ad,n=nd?function(a){return m.call(n.src,n.ka,a)}:function(a){a=m.call(n.src,n.ka,a);if(!a)return a},j=n,r=g=new ud;ha(c)?r.a=p:c&&c.handleEvent&&
ha(c.handleEvent)?r.a=s:k(Error("Invalid listener argument"));r.ka=c;r.b=j;r.src=a;r.type=b;r.capture=!!d;r.yb=e;r.Ra=s;r.key=++td;r.qa=s;g.Ra=s;j.src=a;j.ka=g;h.push(g);xd[f]||(xd[f]=[]);xd[f].push(g);a.addEventListener?(a==w||!a.Ub)&&a.addEventListener(b,j,d):a.attachEvent(b in yd?yd[b]:yd[b]="on"+b,j);a=g}vd[a.key]=a}}
function Bd(a,b,c,d,e){if(y(b))for(var f=0;f<b.length;f++)Bd(a,b[f],c,d,e);else{d=!!d;a:{f=wd;if(b in f&&(f=f[b],d in f&&(f=f[d],a=ia(a),f[a]))){a=f[a];break a}a=q}if(a)for(f=0;f<a.length;f++)if(a[f].ka==c&&a[f].capture==d&&a[f].yb==e){Cd(a[f].key);break}}}
function Cd(a){var b=vd[a];if(b&&!b.qa){var c=b.src,d=b.type,e=b.b,f=b.capture;c.removeEventListener?(c==w||!c.Ub)&&c.removeEventListener(d,e,f):c.detachEvent&&c.detachEvent(d in yd?yd[d]:yd[d]="on"+d,e);c=ia(c);xd[c]&&(e=xd[c],hb(e,b),0==e.length&&delete xd[c]);b.qa=p;if(b=wd[d][f][c])b.dc=p,Dd(d,f,c,b);delete vd[a]}}
function Dd(a,b,c,d){if(!d.cb&&d.dc){for(var e=0,f=0;e<d.length;e++)d[e].qa?d[e].b.src=q:(e!=f&&(d[f]=d[e]),f++);d.length=f;d.dc=s;0==f&&(delete wd[a][b][c],wd[a][b].R--,0==wd[a][b].R&&(delete wd[a][b],wd[a].R--),0==wd[a].R&&delete wd[a])}}function Ed(a,b,c,d,e){var f=1;b=ia(b);if(a[b]){var g=--a.C,h=a[b];h.cb?h.cb++:h.cb=1;try{for(var j=h.length,m=0;m<j;m++){var n=h[m];n&&!n.qa&&(f&=Fd(n,e)!==s)}}finally{a.C=Math.max(g,a.C),h.cb--,Dd(c,d,b,h)}}return Boolean(f)}
function Fd(a,b){a.Ra&&Cd(a.key);return a.handleEvent(b)}
function Ad(a,b){if(a.qa)return p;var c=a.type,d=wd;if(!(c in d))return p;var d=d[c],e,f;if(!nd){e=b||ca("window.event");var g=p in d,h=s in d;if(g){if(0>e.keyCode||e.returnValue!=l)return p;a:{var j=s;if(0==e.keyCode)try{e.keyCode=-1;break a}catch(m){j=p}if(j||e.returnValue==l)e.returnValue=p}}j=new rd;sd(j,e,this);e=p;try{if(g){for(var n=[],r=j.a;r;r=r.parentNode)n.push(r);f=d[p];f.C=f.R;for(var v=n.length-1;!j.b&&0<=v&&f.C;v--)j.a=n[v],e&=Ed(f,n[v],c,p,j);if(h){f=d[s];f.C=f.R;for(v=0;!j.b&&v<n.length&&
f.C;v++)j.a=n[v],e&=Ed(f,n[v],c,s,j)}}else e=Fd(a,j)}finally{n&&(n.length=0)}return e}c=new rd(b,this);return e=Fd(a,c)};function Gd(){kd.call(this)}F(Gd,kd);u=Gd.prototype;u.Ub=p;u.Cb=q;u.addEventListener=function(a,b,c,d){zd(this,a,b,c,d)};u.removeEventListener=function(a,b,c,d){Bd(this,a,b,c,d)};
function Hd(a,b){var c=b,d=c.type||c,e=wd;if(d in e){if(A(c))c=new pd(c,a);else if(c instanceof pd)c.target=c.target||a;else{var f=c,c=new pd(d,a);Ib(c,f)}var f=1,g,e=e[d],d=p in e,h;if(d){g=[];for(h=a;h;h=h.Cb)g.push(h);h=e[p];h.C=h.R;for(var j=g.length-1;!c.b&&0<=j&&h.C;j--)c.a=g[j],f&=Ed(h,g[j],c.type,p,c)&&c.d!=s}if(s in e)if(h=e[s],h.C=h.R,d)for(j=0;!c.b&&j<g.length&&h.C;j++)c.a=g[j],f&=Ed(h,g[j],c.type,s,c)&&c.d!=s;else for(e=a;!c.b&&e&&h.C;e=e.Cb)c.a=e,f&=Ed(h,e,c.type,s,c)&&c.d!=s}}
u.wa=function(){Gd.L.wa.call(this);var a=0;if(this!=q){var b=ia(this);if(xd[b])for(var b=xd[b],c=b.length-1;0<=c;c--)Cd(b[c].key),a++}else Fb(vd,function(b,c){Cd(c);a++});this.Cb=q};function Id(a,b,c){ha(a)?c&&(a=na(a,c)):a&&"function"==typeof a.handleEvent?a=na(a.handleEvent,a):k(Error("Invalid listener argument"));2147483647<b||w.setTimeout(a,b||0)};function Jd(a,b,c){ad.call(this,a,b,c)}F(Jd,ad);u=Jd.prototype;u.qb=function(a,b,c,d,e,f){a=Kd(a,e,d,f);c(a)};u.Db=function(a,b,c,d,e,f){a=Kd(a,e,d,f);c(a)};u.rb=function(a,b,c,d,e,f){b=[];for(var g=0;g<e.length;g++)b[g]=Kd(a,e[g],d,x(f)?f[g]:l);c(b)};u.Eb=function(a,b,c,d,e,f){b=[];for(var g=0;g<e.length;g++)b[g]=Kd(a,e[g],d,x(f)?f[g]:l);c(b)};u.Ya=function(a,b,c,d,e){c(Ld(a,d,e))};u.zb=function(a,b,c,d,e){b=[];for(var f=0;f<e.length;f++){var g=Ld(a,d,e[f]);b.push(g)}c(b)};u.Ma=aa();
u.Ab=function(a,b,c,d){b=[];for(var e=0;e<d.length;e++){var f=Ld(a,d[e].a,d[e].id);b.push(f)}c(b)};u.La=aa();u.Fb=function(a,b,c,d,e){Md(a,d,e);c(p)};u.Sa=function(a,b,c,d){for(b=0;b<d.length;b++)Md(a,d[b]);c(p)};u.Va=function(a,b,c,d){Id(function(){for(var b=[],f=0;f<d.length;f++){var g=a.Za(d[f]);b[f]=g.length}c(b)},0,this)};u.ta=function(a,b,c,d){b="_database_"+this.ua;x(d)&&(b+="-"+d);d=0;for(var e in a)a.hasOwnProperty(e)&&0==e.lastIndexOf(b,0)&&d++;c(d)};E("ydn.async.all",function(a){for(var b=[],c,d=0;c=a[d];d++){var e=new L;c.success(oa(function(a,b){M(a,b)},e));c.error(oa(function(a,b){a.o(b)},e));b[d]=e}return new Qc(b)});function Nd(a,b,c){ad.call(this,a,b,c)}F(Nd,ad);u=Nd.prototype;u.c=T("ydn.db.core.req.WebSql");function Od(a,b){var c=a._default_?ta(a._default_):{};if(b.keyPath!=q){var d=Pd(a[b.keyPath],b.type);d!=q&&Qd(b,c,d)}for(d=0;d<b.indexes.length;d++){var e=b.indexes[d];if("_default_"!=e.name){var f=a[e.name],f=e.multiEntry?Pd(f,[e.type]):Pd(f,e.type);x(f)&&(c[e.name]=f)}}return c}u.ac=function(a,b,c,d,e,f,g,h){Rd(this,a,b,c,p,d,l,e,f,g,h,s)};
u.$b=function(a,b,c,d,e,f,g,h,j,m){Rd(this,a,b,c,p,d,e,f,g,h,j,m)};
function Rd(a,b,c,d,e,f,g,h,j,m,n,r){var v=[],z=X(a.a,f);f=g!=q;var D=A(g)?Sd(z,g):q,U=g||Td(z);g=D?D.r():z.r();var P=f?D.type:z.type,U=J(U),V=Td(z),S="*";e&&(S=J(V));r="SELECT "+(r?"DISTINCT":"")+S+" FROM "+Ud(z);S=[];h!==q&&(h=Ya(g,f&&D.multiEntry?[P]:P,h),r+=" WHERE "+h.sql,S=h.params);r+=" ORDER BY "+U+" "+(j?"DESC":"ASC");B(m)&&(r+=" LIMIT "+m);B(n)&&(r+=" OFFSET "+n);var ga="TxNo:"+c+" SQL: "+r+" PARAMS: "+H(S);R(a.c,ga);b.executeSql(r,S,function(b,c){for(var f=0,g=c.rows.length;f<g;f++){var h=
c.rows.item(f);e?v[f]=Pd(h[V],z.type):h!=q&&(v[f]=Od(h,z))}Q(a.c,"success "+ga);d(v)},function(b,c){O(a.c,"error: "+ga+c.message);d(c,p);return s})}u.qb=function(a,b,c,d,e,f){Xd(this,a,b,c,p,p,d,[e],[f])};u.Db=function(a,b,c,d,e,f){Xd(this,a,b,c,s,p,d,[e],[f])};u.rb=function(a,b,c,d,e,f){Xd(this,a,b,c,p,s,d,e,f)};
function Xd(a,b,c,d,e,f,g,h,j){function m(b,g){var P;P=x(j)?Yd(n,h[b],j[b]):Yd(n,h[b]);var V=r+Ud(n)+" ("+P.Sb.join(", ")+") VALUES ("+P.jc.join(", ")+");",S="TxNo:"+c+" SQL: "+V+" PARAMS: "+P.F;R(a.c,S);g.executeSql(V,P.F,function(c,e){z++;var g=x(P.key)?P.key:e.insertId;f?(R(a.c,"success "+V),d(g)):(v[b]=g,z==h.length?(R(a.c,"success "+S),d(v)):(g=b+2,g<h.length&&m(g,c)))},function(c,g){z++;if(6==g.code&&e)if(f)Q(a.c,"success "+S),d(g,p);else if(v[b]=q,z==h.length)R(a.c,"success "+S),d(v);else{var j=
b+2;j<h.length&&m(j,c)}else O(a.c,"error: "+g.message+" "+S),d(g,p);return s})}var n=X(a.a,g),r=e?"INSERT INTO ":"INSERT OR REPLACE INTO ",v=[],z=0;if(0<h.length)for(g=0;2>g&&g<h.length;g++)m(g,b);else Q(a.c,"success"),d([])}u.Eb=function(a,b,c,d,e,f){Xd(this,a,b,c,s,s,d,e,f)};
u.fc=function(a,b,c,d,e){if(0==e.length)c([]);else{for(var f=[],g=0,h=0,j=this,m=function(m,n){var r=[];R(j.c,"put "+n.length+" objects to "+m);for(var v,z=(v=!!X(j.a,m).keyPath)?l:[],D=0;D<n.length;D++)r.push(d[n[D]]),v||z.push(e[n[D]].id);Xd(j,a,b,function(a,b){if(b)g++,g==h&&c(a,p);else{for(var d=0;d<n.length;d++)f[n[d]]=a[d];g++;g==h&&c(f)}},s,s,m,r,z)},n="",r=[],v=[],z=0;z<e.length;z++){var D=e[z].a,U=e[z].id;D!=n?(h++,0<r.length&&m(n,r),r=[z],v=[U],n=D):(r.push(z),v.push(U))}0<r.length&&m(n,
r)}};u.Ya=function(a,b,c,d,e){var f=X(this.a,d),g=this;d=Zd(f);e=[K(e,f.type)];var h="SELECT * FROM "+Ud(f)+" WHERE "+d+" = ?",j="TxNo"+b+" SQL: "+h+" PARAMS: "+e;R(this.c,j);a.executeSql(h,e,function(a,b){R(g.c,"success "+h);if(0<b.rows.length){var d=b.rows.item(0);d!=q?(d=Od(d,f),c(d)):(Q(g.c,"success: "+j),c(l))}else Q(g.c,"success: "+j),c(l)},function(a,b){O(g.c,"error: "+j+" "+b.message);c(b,p);return s})};
u.zb=function(a,b,c,d,e){function f(a,d){var v=e[a],z=Zd(m),v=[K(v,m.type)],D="SELECT * FROM "+Ud(m)+" WHERE "+z+" = ?";R(g.c,"SQL: "+D+" PARAMS: "+v);d.executeSql(D,v,function(d,r){j++;if(0<r.rows.length){var v=r.rows.item(0);v!=q&&(h[a]=Od(v,m))}else h[a]=l;j==e.length?(Q(g.c,"TxNo:"+b+"success "+D),c(h)):(v=a+10,v<e.length&&f(v,d))},function(d,m){j++;O(g.c,"error: "+D+" "+m.message);if(j==e.length)Q(g.c,"TxNo:"+b+"success "+D),c(h);else{var r=a+10;r<e.length&&f(r,d)}return s})}var g=this,h=[],
j=0,m=X(this.a,d);if(0<e.length)for(d=0;10>d&&d<e.length;d++)f(d,a);else Q(g.c,"success"),c([])};u.Ma=function(a,b,c,d,e,f,g,h){Rd(this,a,b,c,s,d,l,e,f,g,h,s)};u.La=function(a,b,c,d,e,f,g,h,j,m){Rd(this,a,b,c,s,d,e,f,g,h,j,m)};
u.Ab=function(a,b,c,d){function e(a,b){var n=d[a],r=X(f.a,n.a),v=y(n.id)?n.id.join("^|"):n.id,n=Zd(r),v=[v],z="SELECT * FROM "+Ud(r)+" WHERE "+n+" = ?";R(f.c,"SQL: "+z+" PARAMS: "+v);b.executeSql(z,v,function(b,m){h++;if(0<m.rows.length){var n=m.rows.item(0);n!=q&&(g[a]=Od(n,r))}else g[a]=l;h==d.length?(R(f.c,"success "+z),c(g)):(n=a+10,n<d.length&&e(n,b))},function(a,b){O(f.c,"error: "+z+" "+b.message);c(b,p);return s})}var f=this,g=[],h=0;if(0<d.length)for(b=0;10>b&&b<d.length;b++)e(b,a);else R(this.c,
"success"),c([])};u.Sa=function(a,b,c,d){function e(a,b){var j="DELETE FROM  "+Ud(X(f.a,d[a]));R(f.c,"SQL: "+j+" PARAMS: []");b.executeSql(j,[],function(b){a==d.length-1?(R(f.c,"success "+j),c(d.length)):e(a+1,b)},function(a,b){O(f.c,"error: "+j+" "+b.message);c(b,p);return s})}var f=this;0<d.length?e(0,a):(R(this.c,"success"),c(0))};
u.Fb=function(a,b,c,d,e){b=X(this.a,d);e=K(e,b.type);var f=this,g="DELETE FROM "+Ud(b)+" WHERE "+(A(b.keyPath)?J(b.keyPath):l)+" = ?";R(this.c,"SQL: "+g+" PARAMS: "+[e]);a.executeSql(g,[e],function(a,b){R(f.c,"success "+g);c(b.rowsAffected)},function(a,b){O(f.c,"error: "+g+" "+b.message);c(b,p);return s})};u.Rb=function(a,b,c,d,e){$d(this,a,c,d,l,e)};u.hc=function(a,b,c,d,e){$d(this,a,c,d,l,e)};u.gc=function(a,b,c,d,e,f){$d(this,a,c,d,e,f)};
function $d(a,b,c,d,e,f){var g=X(a.a,d);d=g.type;x(e)?d=Sd(g,e).type:e=Td(g);var h="DELETE FROM "+Ud(g),g=[];f!==q&&(e=Ya(e,d,f),h+=" WHERE "+e.sql,g=e.params);R(a.c,"SQL: "+h+" PARAMS: "+g);b.executeSql(h,g,function(b,d){R(a.c,"success "+h);c(d.rowsAffected)},function(b,d){O(a.c,"error: "+h+" "+d.message);c(d,p);return s})}
u.Va=function(a,b,c,d){function e(b){var j="SELECT COUNT(*) FROM "+J(d[b]);R(f.c,"SQL: "+j+" PARAMS: []");a.executeSql(j,[],function(a,n){var r=n.rows.item(0);g[b]=parseInt(r["COUNT(*)"],10);b++;R(f.c,b+". success "+j);b==d.length?c(g):e(b)},function(a,b){O(f.c,"error: "+j+" "+b.message);c(b,p);return s})}var f=this,g=[];0==d.length?(R(this.c,"success"),c(0)):e(0);return c};
u.ta=function(a,b,c,d,e,f){var g=this,h="SELECT COUNT(*) FROM "+J(d);b=[];d=X(this.a,d);if(e!==q)if(x(f)){var j=Sd(d,f);d=j.keyPath;var m=j.type;if(y(m)){h+=" WHERE ";if(e.lower!=q)if(y(m))for(var n="=",r=0;r<e.lower.length;r++)0<r&&(h+=" AND "),r==e.lower.length-1&&(n=e.lowerOpen?" > ":" >= "),j=J(d[r]),h+=" "+j+n+"?",b.push(K(e.lower[r],m[r]));else n=e.lowerOpen?" > ":" >= ",j=J(f),h+=" "+j+n+"?",b.push(K(e.lower,m));if(e.upper!=q)if(h+=0<h.length?" AND ":" ",y(m)){n="=";for(r=0;r<e.upper.length;r++)0<
r&&(h+=" AND "),r==e.upper.length-1&&(n=e.upperOpen?" < ":" <= "),j=J(d[r]),h+=" "+j+n+"?",b.push(K(e.upper[r],m[r]))}else n=e.upperOpen?" < ":" <= ",j=J(f),h+=" AND "+j+n+"?",b.push(K(e.upper,m))}else e=Ya(d,m,e),h+=" WHERE "+e.sql,b=e.params}else j=Td(d),e=Ya(j,d.type,e),h+=" WHERE "+e.sql,b=e.params;R(this.c,"SQL: "+h+" PARAMS: "+b);a.executeSql(h,b,function(a,b){var d=b.rows.item(0);R(g.c,"success "+h);c(d["COUNT(*)"])},function(a,b){O(g.c,"error: "+h+" "+b.message);c(b,p);return s});return c};var ae="serial parallel atomic-serial multirequest-serial samescope-multirequest-serial atomic-parallel multirequest-parallel samescope-multirequest-parallel open single".split(" ");function be(a){a?"abort"in a?a.abort():"executeSql"in a?a.executeSql("ABORT",[],aa(),ba(p)):k(new cd):k(new Tc("No active transaction"))};/*
 _try.
*/
function ce(a,b){this.g=a;this.f=b;this.b=[];this.Ha=this.e=q;this.a=new de(b)}ce.prototype.d=T("ydn.db.tr.Serial");ce.prototype.a=q;ce.prototype.s=function(){return this.a.b};ce.prototype.j=function(){return this.a.a&&!this.a.d?this.a.a:q};E("ydn.db.tr.Serial.prototype.getTx",ce.prototype.j);u=ce.prototype;u.Ha=q;u.type=function(){return this.g.m()};u.Zb=ba(s);u.abort=function(){Q(this.d,this+": aborting");be(this.Ha)};
u.ya=function(a,b,c,d){var e=a.name||"",f=A(b)?[b]:b;if(ea(f)){0==f.length&&k(new I("number of store names must more than 0"));for(var g=0;g<f.length;g++)A(f[g])||k(new I("store name at "+g+" must be string but found "+f[g]+" of type "+typeof f[g]))}else k(new I("store names must be an array"));var h=x(c)?c:N,j=this;this.a.a||(!this.g.a||!this.g.a.jb())&&0<(this.e!==q)?(c=a,R(this.d,"Serial push tx queue "+c.name),this.b.push({oa:c,K:b,mode:h,S:d})):(this.e=d?[d]:[],this.g.transaction(function(c){var d=
j.a;d.a=c;d.d=s;d.K=b;d.mode=h;d.nb=e||"";d.b++;d.S=q;R(j.d,j+":tx"+j.a.b+H(b)+h+" begin");a(j);for(a=q;j.Zb();)c=j.b.shift(),c.S&&j.e.push(c.S),R(j.d,"pop tx queue in continue "+c.oa.name),c.oa()},f,h,function(a,b){R(j.d,j+":tx"+j.a.b+" committed with "+a);try{for(var c;c=j.e.shift();)c(a,b)}catch(d){k(d)}finally{if(c=j.a,c.a?(c.a=q,c.K=q,c.mode=q,ha(c.S)&&c.S(a,b),c.S=q):O(c.Xc,c+" has no TX to be unlocked for "+a),c=j.b.shift())R(j.d,"pop tx queue of "+j.b.length+" "+c.oa.name),j.ya(c.oa,c.K,c.mode,
c.S)}}))};u.Ob=ba(s);u.i=function(a,b,c,d,e,f){d=d||N;var g=this,h=this.a;if(h.a&&!h.d&&this.Ob(c,d)){var j=h.a,m=function(b,c){g.Ha=j;c?a.o(b):M(a,b);m=g.Ha=q};b(j,g.s(),m);b=q}else{var n=function(){function c(b,e){g.Ha=d;e?a.o(b):M(a,b);c=g.Ha=q}h.a||k(new Sc("Tx not active for scope: "+e));h.d&&k(new Sc("Tx not available for scope: "+e));n.name=e;var d=h.a;b(d,g.s(),c);b=q};g.ya(n,c,d,f)}};u.getName=function(){return this.g.getName()};
u.toString=function(){var a;a="Serial:"+this.g.getName();var b=this.a.nb;return a+":"+this.f+":"+this.s()+(b?" ["+b+"]":"")};function ee(a,b){ce.call(this,a,b)}F(ee,ce);ee.prototype.d=T("ydn.db.tr.AtomicSerial");ee.prototype.i=function(a,b,c,d,e,f){var g,h=s,j=new L;j.G(function(a){g=a},function(a){h=p;g=a});ee.L.i.call(this,j,b,c,d,e,function(b,c){h?a.o(g):M(a,g);f&&(f(b,c),f=l)})};function fe(a,b,c,d,e){x(e)||(e=y(a)?a.join(", "):a);a!=q&&(!A(a)&&!ea(a))&&k(new I("index keyPath for "+e+" must be a string or array, but "+a+" is "+typeof a));y(a)&&Object.freeze&&Object.freeze(a);!x(a)&&x(e)&&(a=e);this.keyPath=a;this.name=e;this.type=ge(b);(y(b)&&!y(this.type)||y(b)&&!mb(this.type,b)||!y(b)&&this.type!=b)&&k(new I("Invalid index type: "+b+" in "+this.name));this.unique=!!c;this.multiEntry=!!d}
function K(a,b){if(y(b)){var c=a==q?[""]:y(a)?a:[a],d=c[0]instanceof Date?"d":B(c[0])?"n":"t",c="d"==d?c.reduce(function(a,b){return a+ +b},""):c.join("|");return d+"|"+c+"|"}if("DATE"==b){if(a instanceof Date)return+a}else return x(b)?a:"X'"+Na(a)+"'"}
function Pd(a,b){if(y(b)){if(A(a)){var c=a.split("|"),d=c[0],c=c.slice(1,c.length-1);return cb(c,function(a){return"d"==d?new Date(parseInt(a,10)):"n"==d?parseFloat(a):a})}}else{if("DATE"==b)c=new Date(a);else if(x(b))c=a;else{for(var e=c=[],f,g=[],h,j,m=new Ta(a);m.pa()!=q;)if(0===m.a)e=g.pop();else{if(m.a===q)break;do{h=m.a/4|0;f=m.a%4;for(var n=0;n<h;n++)j=[],e.push(j),g.push(e),e=j;if(0===f&&12<m.a+4)m.pa();else break}while(1);1===f?e.push(Qa(m)):2===f?e.push(new Date(Qa(m))):3===f?e.push(Ra(m)):
0===f&&(e=g.pop())}c=c[0]}return c}}var he=["BLOB","DATE","INTEGER","NUMERIC","TEXT"];function ge(a){if(y(a))return a=cb(a,function(a){return ge(a)}),Object.freeze&&Object.freeze(a),a;a=xa(he,a);return he[a]}u=fe.prototype;u.getName=t("name");u.toJSON=function(){return{name:this.name,keyPath:this.keyPath,type:this.type,unique:this.unique,multiEntry:this.multiEntry}};
u.Ta=function(){var a=y(this.keyPath)?ib(this.keyPath):this.keyPath,b=y(this.type)?ib(this.type):this.type;return new fe(a,b,this.unique,this.multiEntry,this.name)};function ie(a,b){return a==q&&b==q?q:a!=q?b!=q?ea(a)&&ea(b)?mb(a,b)?q:"expect: "+a+", but: "+b:je(a,b)?q:"expect: "+a+", but: "+b:"keyPath: "+a+" no longer defined":"newly define "+b}
u.hint=function(a){if(!a)return this;var b=y(this.keyPath)?ib(this.keyPath):this.keyPath,c=y(this.type)?ib(this.type):this.type,d=this.multiEntry;a.multiEntry===p&&"TEXT"==this.type&&(d=p);return new fe(b,c,this.unique,d,a.name)};u.r=t("keyPath");function ke(a,b,c,d,e,f,g){this.name=a;A(this.name)||k(new I("store name must be a string"));this.keyPath=x(b)?b:q;this.keyPath!==q&&(!A(this.keyPath)&&!ea(this.keyPath))&&k(new I("keyPath must be a string or array"));this.autoIncrement=c;var h;x(d)&&(h=ge(d),x(h)||k(new I("type invalid in store: "+this.name)));this.type=x(h)?h:this.autoIncrement?"INTEGER":l;this.a=A(this.keyPath)?this.keyPath.split("."):[];this.indexes=e||[];this.ma=!!f;this.tc=!!g}u=ke.prototype;u.ma=s;u.tc=s;
u.toJSON=function(){for(var a=[],b=0;b<this.indexes.length;b++)a.push(this.indexes[b].toJSON());return{name:this.name,keyPath:this.keyPath,autoIncrement:this.autoIncrement,type:this.type,indexes:a}};
function le(a){var b="name keyPath autoIncrement type indexes dispatchEvents fixed Sync".split(" "),c;for(c in a)a.hasOwnProperty(c)&&-1==xa(b,c)&&k(new I('Unknown attribute "'+c+'"'));b=[];c=a.indexes||[];if(y(c))for(var d=0;d<c.length;d++){var e;e=c[d];var f=["name","unique","type","keyPath","multiEntry"],g=l;for(g in e)e.hasOwnProperty(g)&&-1==xa(f,g)&&k(new I("Unknown field: "+g+" in "+H(e)));e=new fe(e.keyPath,e.type,e.unique,e.multiEntry,e.name);x(e.keyPath)&&e.keyPath===a.keyPath||b.push(e)}return new ke(a.name,
a.keyPath,a.autoIncrement,a.type,b,a.dispatchEvents,a.fixed)}u.Ta=function(){return le(this.toJSON())};u.index=function(a){return this.indexes[a]||q};function Sd(a,b){return eb(a.indexes,function(a){return a.name==b})}function me(a,b){return b==a.keyPath?p:db(a.indexes,function(a){return a.name==b})}function Zd(a){return A(a.keyPath)?J(a.keyPath):y(a.keyPath)?J(a.keyPath.join(",")):"_ROWID_"}function Td(a){return y(a.keyPath)?J(a.keyPath.join(",")):A(a.keyPath)?a.keyPath:"_ROWID_"}
function Ud(a){return J(a.name)}
u.hint=function(a){if(!a)return this;var b=this.autoIncrement,c=y(this.keyPath)?ib(this.keyPath):this.keyPath,d=y(this.type)?ib(this.type):this.type,e=cb(this.indexes,function(a){return a.Ta()});y(a.type)&&"TEXT"==d&&(d=ib(a.type));y(a.keyPath)&&(A(c)&&c==a.keyPath.join(","))&&(c=ib(a.keyPath));for(var f=0,g=a.indexes.length;f<g;f++)if(y(a.indexes[f].keyPath))for(var h=a.indexes[f].r(),j=s,m=e.length-1;0<=m;m--)0<=h.indexOf(e[m].r())&&!me(a,e[m].getName())&&(e.splice(m,1),j||(e.push(a.indexes[f].Ta()),
j=p));for(f=0;f<e.length;f++)(g=Sd(a,e[f].getName()))&&(e[f]=e[f].hint(g));return new ke(a.name,c,b,d,e)};u.getName=t("name");u.r=t("keyPath");function Qd(a,b,c){for(var d=0;d<a.a.length;d++){var e=a.a[d];if(d==a.a.length-1){b[e]=c;break}x(b[e])||(b[e]={});b=b[e]}}
function Yd(a,b,c){var d=[];c=x(c)?c:A(a.keyPath)?Gb(b,a.a):l;var e=[];x(c)&&(e=a.keyPath!=q?[A(a.keyPath)?J(a.keyPath):l]:["_ROWID_"],d=[K(c,a.type)]);for(var f=0;f<a.indexes.length;f++){var g=a.indexes[f];if(!(g.name==a.keyPath||"_default_"==g.name)){var h=g.r();if(x(h)){var j=g.type;if(y(h))for(var m=0;m<h.length;m++)x(b[h[m]])&&(g.multiEntry?d.push(K(b[h[m]],[j[m]])):d.push(K(b[h[m]],j[m])),e.push(J(h[m])));else x(b[h])&&(g.multiEntry?d.push(K(b[h],[j])):d.push(K(b[h],j)),e.push(J(h)))}}}if(!a.tc){var f=
{},n;for(n in b)b.hasOwnProperty(n)&&!me(a,n)&&(f[n]=b[n]);d.push(H(f));e.push("_default_")}a=[];for(f=d.length-1;0<=f;f--)a[f]="?";return{Sb:e,jc:a,F:d,key:c}}
function ne(a,b){if(!b)return"missing store: "+a.name;if(a.name!=b.name)return"store name, expect: "+a.name+", but: "+b.name;var c=ie(a.keyPath,b.keyPath);if(c)return"keyPath, "+c;if(x(a.autoIncrement)&&x(b.autoIncrement)&&a.autoIncrement!=b.autoIncrement)return"autoIncrement, expect:  "+a.autoIncrement+", but: "+b.autoIncrement;if(a.indexes.length!=b.indexes.length)return"indexes length, expect:  "+a.indexes.length+", but: "+b.indexes.length;if(x(a.type)&&x(b.type)&&(ea(a.type)?!mb(a.type,b.type):
a.type!=b.type))return"data type, expect:  "+a.type+", but: "+b.type;for(c=0;c<a.indexes.length;c++){var d=Sd(b,a.indexes[c].name),e;e=a.indexes[c];if(d)if(e.name!=d.name)e="name, expect: "+e.name+", but: "+d.name;else{var f=ie(e.keyPath,d.keyPath);e=f?"keyPath, "+f:e.unique!=q&&d.unique!=q&&e.unique!=d.unique?"unique, expect: "+e.unique+", but: "+d.unique:e.multiEntry!=q&&d.multiEntry!=q&&e.multiEntry!=d.multiEntry?"multiEntry, expect: "+e.multiEntry+", but: "+d.multiEntry:x(e.type)&&x(d.type)&&
(ea(e.type)?!mb(e.type,d.type):e.type!=d.type)?"data type, expect: "+e.type+", but: "+d.type:""}else e="no index for "+e.name;if(0<e.length)return'index "'+a.indexes[c].name+'" '+e}return""};function oe(a,b){var c,d=b;if(C(a)){c=["version","stores"];for(var e in a)a.hasOwnProperty(e)&&-1==xa(c,e)&&k(new I("Unknown field: "+e+" in schema."));c=a.version;d=[];e=a.stores||[];y(e)||k(new I("stores must be array"));for(var f=0;f<e.length;f++){var g=le(e[f]);-1!=fb(d,function(a){return a.name==g.name})&&k(new I('duplicate store name "'+g.name+'".'));d.push(g)}}else A(a)?c=0==a.length?l:parseFloat(a):B(a)&&(c=a);x(c)&&((!B(c)||0>c)&&k(new I("Invalid version: "+c+" ("+a+")")),isNaN(c)&&(c=l));
x(b)&&(!y(b)||0<b.length&&!(b[0]instanceof ke))&&k(new I("stores"));this.version=c;this.d=!x(this.version);this.stores=d||[]}oe.prototype.toJSON=function(){var a=this.stores.map(function(a){return a.toJSON()});return{version:this.version,stores:a}};oe.prototype.d=s;oe.prototype.a=ba(s);function pe(a){return a.stores.map(function(a){return a.name})}oe.prototype.b=function(a){return this.stores[a]||q};function X(a,b){return eb(a.stores,function(a){return a.name==b})}
function qe(a,b){return db(a.stores,function(a){return a.name==b})}function re(a,b,c){if(!b||a.stores.length!=b.stores.length)return"Number of store: "+a.stores.length+" vs "+b.stores.length;for(var d=0;d<a.stores.length;d++){var e=X(b,a.stores[d].name),e=e&&c?e.hint(a.stores[d]):e,e=ne(a.stores[d],e);if(0<e.length)return'store: "'+a.stores[d].name+'" '+e}return""};function se(a,b){x(a)&&5242880<a&&O(this.k,"storage size request ignored, use Quota Management API instead");this.n=q;this.hb=b||18E4}
se.prototype.Aa=function(a,b){function c(a,c,d){Q(e.k,(d?"changing":"upgrading")+" version to "+a.version+" from "+g);for(d=0;d<b.stores.length;d++)te(e,a,c,b.stores[d]);c=a.objectStoreNames;var f=c.length;for(d=0;d<f;d++)qe(b,c[d])||(a.deleteObjectStore(c[d]),Q(e.k,"store: "+c[d]+" deleted."))}function d(a,b){x(b)?(O(e.k,b?b.message:"Error received."),e.n=q,f.o(b)):(e.n=a,e.n.onabort=function(a){R(e.k,e+": onabort - "+a.message)},e.n.onerror=function(a){R(e.k,e+": onerror - "+a.message)},e.n.onversionchange=
function(a){R(e.k,e+": onversionchange to: "+a.version);e.n&&(e.n.onabort=q,e.n.onerror=q,e.n.onversionchange=q,e.n.close(),e.n=q,ha(e.b)&&e.b())},M(f,parseFloat(g)))}var e=this,f=new L,g=l,h=b.version;Q(e.k,"Opening database: "+a+" ver: "+(b.d?"auto":h));var j;j=x(h)?ue.open(a,h):ue.open(a);j.onsuccess=function(f){var h=f.target.result;x(g)||(g=h.version);Q(e.k,"Database: "+h.name+", ver: "+h.version+" opened.");if(b.d)e.$(function(f){if(b.a())for(var g=0;g<f.stores.length;g++)if(!qe(b,f.stores[g].getName())){var j=
f.stores[g].Ta();b.stores.push(j)}f=re(b,f);if(0<f.length){Q(e.k,"Schema change require for difference in "+f);var m=B(h.version)?h.version+1:1;if("IDBOpenDBRequest"in w){h.close();var r=ue.open(a,m);r.onupgradeneeded=function(a){a=a.target.result;Q(e.k,"re-open for version "+a.version);c(a,r.transaction,s)};r.onsuccess=function(a){d(a.target.result)};r.onerror=function(){Q(e.k,e+": fail.");d(q)}}else{var V=h.setVersion(m+"");V.a=function(a){O(e.k,"migrating from "+h.version+" to "+m+" failed.");
d(q,a)};V.onsuccess=function(){V.transaction.oncomplete=S;c(h,V.transaction,p)};var S=function(){var b=ue.open(a);b.onsuccess=function(a){a=a.target.result;Q(e.k,e+": OK.");d(a)};b.onerror=function(){Q(e.k,e+": fail.");d(q)}};V.transaction!=q&&(V.transaction.oncomplete=S)}}else d(h)},l,h);else if(b.version>h.version){var j=h.setVersion(b.version);j.a=function(a){O(e.k,"migrating from "+h.version+" to "+b.version+" failed.");d(q,a)};j.onsuccess=function(){c(h,j.transaction,p)}}else b.version==h.version?
Q(e.k,"database version "+h.version+" ready to go"):O(e.k,"connected database version "+h.version+" is higher than requested version."),e.$(function(a){a=re(b,a);0<a.length?(Q(e.k,a),d(q,new fd("different schema: "+a))):d(h)},l,h)};j.onupgradeneeded=function(a){a=a.target.result;g=NaN;Q(e.k,"upgrade needed for version "+a.version);c(a,j.transaction,s)};j.onerror=function(c){Bc(e.k,"opening database "+a+":"+b.version+" failed.");d(q,c)};j.onblocked=function(c){Bc(e.k,"database "+a+" "+b.version+" block, close other connections.");
d(q,c)};B(this.hb)&&Id(function(){"done"!=j.readyState&&(Bc(e.k,e+": database state is still "+j.readyState),d(q,Error("connection timeout after "+e.hb)))},this.hb);return f};var ue=w.indexedDB||w.mozIndexedDB||w.webkitIndexedDB||w.moz_indexedDB||w.msIndexedDB;u=se.prototype;u.hb=18E4;u.Ba=ba("indexeddb");u.Jb=function(){return this.n||q};u.jb=function(){return!!this.n};u.k=T("ydn.db.con.IndexedDb");u.n=q;u.Kb=function(){return this.n?parseFloat(this.n.version):l};
u.$=function(a,b,c){c=c||this.n;if(x(b)){if(b===q){if(0==c.objectStoreNames.length){a(new oe(c.version));return}k(new ed)}c=b.db}else{b=[];for(var d=c.objectStoreNames.length-1;0<=d;d--)b[d]=c.objectStoreNames[d];if(0==b.length){a(new oe(c.version));return}b=c.transaction(b,N)}for(var e=c.objectStoreNames,f=[],g=e.length,d=0;d<g;d++){for(var h=b.objectStore(e[d]),j=[],m=0,n=h.indexNames.length;m<n;m++){var r=h.index(h.indexNames[m]);j[m]=new fe(r.keyPath,l,r.unique,r.multiEntry,r.name)}f[d]=new ke(h.name,
h.keyPath,h.autoIncrement,l,j)}b=new oe(c.version,f);a(b)};
function te(a,b,c,d){function e(){var a={autoIncrement:!!d.autoIncrement};d.r()!=q&&(a.keyPath=d.r());try{return b.createObjectStore(d.getName(),a)}catch(c){"InvalidAccessError"==c.name&&k(new Uc("creating store for "+d.getName()+" of keyPath: "+d.r()+" and autoIncrement: "+d.autoIncrement)),"ConstraintError"==c.name&&k(new fd("creating store for "+d.getName())),k(c)}}R(a.k,"Creating Object Store for "+d.getName()+" keyPath: "+d.r());if(b.objectStoreNames.contains(d.getName()))if(c=c.objectStore(d.getName()),
(d.r()||"")!=(c.keyPath||""))b.deleteObjectStore(d.getName()),O(a.k,"store: "+d.getName()+" deleted due to keyPath change."),c=e();else if(fa(c.autoIncrement)&&fa(d.autoIncrement)&&c.autoIncrement!=d.autoIncrement)b.deleteObjectStore(d.getName()),O(a.k,"store: "+d.getName()+" deleted due to autoIncrement change."),c=e();else{for(var f=c.indexNames,g=0,h=0,j=0;j<d.indexes.length;j++){var m=d.indexes[j];if(!f.contains(m.name)){if(m.unique||m.multiEntry){var n={unique:m.unique,multiEntry:m.multiEntry};
c.createIndex(m.name,m.keyPath,n)}else c.createIndex(m.name,m.keyPath);g++}}for(j=0;j<f.length;j++)me(d,f[j])||(c.deleteIndex(f[j]),h++);R(a.k,"Updated store: "+c.name+", "+g+" index created, "+h+" index deleted.")}else{c=e();for(j=0;j<d.indexes.length;j++)m=d.indexes[j],R(a.k,"Creating index: "+m.name+" multiEntry: "+m.multiEntry),m.unique||m.multiEntry?(n={unique:m.unique,multiEntry:m.multiEntry},c.createIndex(m.name,m.keyPath,n)):c.createIndex(m.name,m.keyPath);R(a.k,"Created store: "+c.name+" keyPath: "+
c.keyPath)}}u.Wa=function(a,b,c,d){var e=this.n;if(!b){b=[];for(var f=e.objectStoreNames.length-1;0<=f;f--)b[f]=e.objectStoreNames[f]}0==b.length?a(q):(b=e.transaction(b,c),b.oncomplete=function(a){d("complete",a)},b.onerror=function(a){d("error",a)},b.onabort=function(a){d("abort",a)},a(b),a=q)};u.ib=function(){this.n.close()};u.toString=function(){return this.Ba()+":"+(this.n?this.n.name+":"+this.n.version:"")};function ve(a){this.a=x(a)?a:4194304}u=ve.prototype;
u.Aa=function(a,b){function c(a,b){x(b)?(d.D=q,f.o(b)):(d.D=a,M(f,parseFloat(e)))}var d=this,e=NaN,f=new L,g=q;try{g=w.openDatabase(a,"",a,this.a)}catch(h){"SECURITY_ERR"==h.name?(O(this.p,"SECURITY_ERR for opening "+a),g=q,this.Lb=new Yc(h)):k(h)}if(g){var e=g.version,j="database "+a+(0==g.version.length?"":" version "+g.version);b.version!=q&&b.version==g.version?(Cc(d.p,"Existing "+j+" opened as requested."),c(g)):this.$(function(e){if(e=re(b,e,p)){0==g.version.length?Cc(d.p,"New "+j+" created."):
b.d?Cc(d.p,"Existing "+j+" opened and  schema change for "+e):Cc(d.p,"Existing "+j+" opened and  schema change to version "+b.version+" for "+e);var f=g;e=f.version?parseInt(f.version,10):0;e=b.d?isNaN(e)?1:e+1:b.version;R(d.p,a+": changing version from "+f.version+" to "+e);var h=s,v=0;f.changeVersion(f.version,e+"",function(a){d.$(function(c){h=p;for(var e=0;e<b.stores.length;e++){var f=X(c,b.b(e).getName()),f=f?f.hint(b.b(e)):q;we(d,a,b.b(e),function(a){a&&v++},f)}if(b instanceof xe)for(e=0;e<
c.stores.length;e++)f=c.b(e),qe(b,f.getName())||b.stores.push(f)},a,f)},function(a){k(a)},function(){if(h){var e=".";v!=b.stores.length&&(e=" but unexpected stores exists.");R(d.p,a+":"+f.version+" ready"+e);c(f)}else O(d.p,a+": changing version voided.")})}else Cc(d.p,"Existing "+j+" with same schema opened."),c(g)},q,g)}else c(q,this.Lb);return f};u.Ba=ba("websql");u.Lb=q;u.D=q;u.Jb=function(){return this.D||q};u.p=T("ydn.db.con.WebSql");
u.Kb=function(){return this.D?parseFloat(this.D.version):l};
u.$=function(a,b,c){function d(a,b){k(b)}function e(b,c){if(c&&c.rows){for(var d=0;d<c.rows.length;d++){var e=c.rows.item(d);if("__WebKitDatabaseInfoTable__"!=e.name&&"sqlite_sequence"!=e.name&&"table"==e.type){var v;v="sql"in e?e.sql:l;R(f.p,"Parsing table schema from SQL: "+v);v=v.substr(v.indexOf("("),v.lastIndexOf(")")).match(/(?:"[^"]*"|[^,])+/g);for(var z=l,D,U=[],P=s,V=s,S=0;S<v.length;S++){var ga=v[S].match(/\w+|"[^"]+"/g),Sa=cb(ga,function(a){return a.toUpperCase()}),ga=Ia(ga[0],'"'),wb=
ge(Sa[1]);-1!=Sa.indexOf("PRIMARY")&&-1!=Sa.indexOf("KEY")?(A(ga)&&(!/^[\s\xa0]*$/.test(ga)&&"_ROWID_"!=ga)&&(z=ga),D=wb,-1!=Sa.indexOf("AUTOINCREMENT")&&(P=p)):"_default_"==ga?V=p:(Sa=new fe(ga,wb,"UNIQUE"==Sa[2]),U.push(Sa))}e=new ke(e.name,z,P,D,U,l,!V);h.push(e)}}d=new oe(g,h);a(d)}}var f=this,g=(c=c||this.D)&&c.version?parseFloat(c.version):l,g=isNaN(g)?l:g,h=[];b?b.executeSql("SELECT * FROM sqlite_master",[],e,d):c.readTransaction(function(b){f.$(a,b,c)},function(a){Bc(f.p,"opening tx: "+a.message);
k(a)},e)};
function we(a,b,c,d,e){function f(a){b.executeSql(a,[],function(){g++;g==h.length&&(d(p),d=q)},function(b,e){g++;g==h.length&&(d(s),d=q);k(new Xc(e,"Error creating table: "+c.name+" "+a))})}var g=0,h,j=c.type||"BLOB";y(j)&&(j="TEXT");var m="CREATE TABLE IF NOT EXISTS "+Ud(c)+" (",m=m+(Zd(c)+" "+j+" UNIQUE PRIMARY KEY ");c.autoIncrement&&(m+=" AUTOINCREMENT ");for(var m=m+" ,_default_ BLOB",j=[],n=[c.r()],r=0,v=c.indexes.length;r<v;r++){var z=c.index(r),D="";z.unique&&(z.multiEntry?O(a.p,'store "'+
c.getName()+'" has both multiEntry and unique set true, but it is not supported under websql'):D=" UNIQUE ");var U=z.r(),P=z.type;if(y(P))for(D=0;D<U.length;D++)z=U[D],-1==n.indexOf(z)&&(m+=", "+J(z)+" "+P[D],n.push(z));else-1==n.indexOf(U)&&(P=z.multiEntry?"TEXT":z.type||"BLOB",m+=", "+J(U)+" "+P+D,n.push(U))}j.unshift(m+");");h=j;m="Create";if(e){e=ne(c,e);if(0==e.length){R(a.p,"same table "+c.name+" exists.");d(p);d=q;return}m="Modify";O(a.p,"table: "+c.name+" has changed by "+e+" additionallly TABLE ALTERATION is not implemented, dropping old table.");
h.unshift("DROP TABLE "+J(c.name))}R(a.p,m+" table: "+c.name+": "+h.join(";"));for(a=0;a<h.length;a++)f(h[a])}u.jb=function(){return!!this.D};u.ib=aa();u.Wa=function(a,b,c,d){function e(a){R(h.p,h+": Tx "+c+" request cause error.");d("error",a)}function f(){d("complete",{type:"complete"})}function g(b){a(b)}var h=this;this.D===q&&(a(q),d("error",this.Lb));c==N?this.D.readTransaction(g,e,f):c==Db?this.D.changeVersion(this.D.version,this.D.version+1+"",g,e,f):this.D.transaction(g,e,f)};var Oc=ue&&ue.cmp?na(ue.cmp,ue):Ua;function ye(a,b,c,d){this.g=a;this.b=b;this.a=d;this.e=c;this.d=q}ye.prototype.h=T("ydn.db.tr.DbOperator");ye.prototype.s=function(){return this.a.s()};ye.prototype.abort=function(){this.a.abort()};function Y(a){a.d||(a.d=a.g.Bb(a.e));return a.d}ye.prototype.toString=function(){return"TxStorage:"+this.g.getName()};function ze(a,b,c,d){ye.call(this,a,b,c,d)}F(ze,ye);u=ze.prototype;u.h=T("ydn.db.core.DbOperator");
u.Ca=function(a,b,c){var d=zb(),e=this,f,g,h;if(x(a))if(y(a)){(x(c)||x(b))&&k(new I("too many arguments."));f=a;for(b=0;b<f.length;b++)qe(this.b,f[b])||k(new I('store name "'+f[b]+'" at '+b+" not found."));Q(this.h,"countStores: "+H(f));this.a.i(d,function(a,b,c){Y(e).Va(a,b,c,f)},f,N,"countStores")}else A(a)?(qe(this.b,a)||k(new I('store name "'+a+'" not found.')),f=[a],A(b)?(g=b,h=ua(c)):C(b)||!x(b)?(x(c)&&k(new I("Invalid key range or index")),(a=wa(b))&&k(new I("invalid key range: "+b+" "+a)),
h=ua(b)):k(new I("key range must be an object, but "+b+" of type "+typeof b+" found.")),Q(this.h,"countKeyRange: "+f[0]+" "+(g?g:"")+H(h)),this.a.i(d,function(a,b,c){Y(e).ta(a,b,c,f[0],h,g)},f,N,"countKeyRange")):k(new I("Invalid store name or store names."));else{(x(c)||x(b))&&k(new I("too many arguments."));f=pe(this.b);var j=new L;Q(this.h,"countStores: "+H(f));this.a.i(d,function(a,b,c){Y(e).Va(a,b,c,f)},f,N,"countStores");d.G(function(a){a=a.reduce(function(a,b){return b+a},0);M(j,a)},function(a){j.o(a)});
return j}return d};
u.Da=function(a,b){var c=this,d=zb();if(a instanceof $c){var e=a.a;if(!qe(this.b,e)){if(this.b.a())return xb(l);k(new I("Store: "+e+" not found."))}var f=a.id;Q(this.h,"getById: "+e+":"+f);this.a.i(d,function(a,b,d){Y(c).Ya(a,b,d,e,f)},[e],N,"getById")}else if(A(a)&&x(b)){if(!X(this.b,a)){if(this.b.a())return xb(l);k(new I('Store name "'+a+'" not found.'))}if(b instanceof va||b instanceof G){var g=new L;g.G(function(a){M(d,a[0])},function(a){d.o(a)});var h=wa(b);h&&k(new I("invalid key range: "+b+
" "+h));var j=ua(b);Q(this.h,"getById: "+a+":"+H(j));this.a.i(g,function(b,d,e){Y(c).Ma(b,d,e,a,j,s,1,0)},[a],N,"getById")}else Q(this.h,"getById: "+a+":"+b),this.a.i(d,function(d,e,f){Y(c).Ya(d,e,f,a,b)},[a],N,"getById")}else k(new I("get require valid input arguments."));return d};
u.keys=function(a,b,c,d,e,f){var g=this,h,j,m=q,n=s,r=X(this.b,a);A(a)||k(new I("store name must be a string, but "+a+" of type "+typeof a+" is not."));this.b.a()||(r||k(new I('store name "'+a+'" not found.')),A(b)&&!Sd(r,b)&&k(new I('index "'+b+'" not found in store "'+a+'".')));if(this.b.a()&&!r)return xb([]);r=new L;if(A(b)){var v=wa(c);v&&k(new I("invalid key range: "+c+" "+v));m=ua(c);B(d)?h=d:(x(d)&&k(new I("limit must be a number")),h=100);B(e)?j=e:(x(e)&&k(new I("offset must be a number")),
j=0);x(f)&&(fa?n=f:k(new I("reverse must be a boolean")));Q(this.h,"keysByIndexKeyRange: "+a);this.a.i(r,function(c,d,e){Y(g).$b(c,d,e,a,b,m,n,h,j,s)},[a],N,"keysByIndexKeyRange")}else(v=wa(b))&&k(new I("invalid key range: "+b+" "+v)),m=ua(b),B(c)?h=c:(x(c)&&k(new I("limit must be a number")),h=100),B(d)?j=d:(x(d)&&k(new I("offset must be a number")),j=0),x(e)&&(fa(e)?n=e:k(new I("reverse must be a boolean"))),Q(this.h,"keysByKeyRange: "+a),this.a.i(r,function(b,c,d){Y(g).ac(b,c,d,a,m,n,h,j)},[a],
N,"keysByKeyRange");return r};
u.F=function(a,b,c,d,e,f){var g=this,h=zb(),j,m,n=s;if(A(a)){if(!X(this.b,a)){if(this.b.a())return xb([]);k(new Vc(a))}if(y(b))(x(c)||x(d))&&k(new I("too many input arguments")),Q(this.h,"listByIds: "+a+" "+b.length+" ids"),this.a.i(h,function(c,d,e){Y(g).zb(c,d,e,a,b)},[a],N,"listByIds");else if(A(b)){var r=wa(c);r&&k(new I("invalid key range: "+c+" "+r));var v=ua(c);x(d)?B(d)?j=d:k(new I("limit must be a number.")):j=100;x(e)?B(e)?m=e:k(new I("offset must be a number.")):m=0;fa(f)?n=f:x(f)&&k(new I("reverse must be a boolean, but "+
f));Q(this.h,"listByIndexKeyRange: "+a+":"+b);this.a.i(h,function(c,d,e){Y(g).La(c,d,e,a,b,v,n,j,m,s)},[a],N,"listByIndexKeyRange")}else(r=wa(b))&&k(new I("invalid key range: "+b+" "+r)),v=ua(b),x(c)?B(c)?j=c:k(new I("limit must be a number, but "+c+" is "+typeof c)):j=100,x(d)?B(d)?m=d:k(new I("offset must be a number, but "+d+" is "+typeof d)):m=0,x(e)&&(fa(e)?n=e:k(new I("reverse must be a boolean, but "+e+" is "+typeof e))),Q(this.h,(v?"listByKeyRange: ":"listByStore: ")+a),this.a.i(h,function(b,
c,d){Y(g).Ma(b,c,d,a,v,n,j,m)},[a],N,"listByKeyRange")}else if(y(a))if(a[0]instanceof $c){c=[];for(d=0;d<a.length;d++){e=a[d].a;if(!qe(this.b,e)){if(this.b.a())return h=[],h[a.length-1]=l,xb(h);k(new I("Store: "+e+" not found."))}0<=xa(c,e)||c.push(e)}Q(this.h,"listByKeys: "+H(c)+" "+a.length+" keys");this.a.i(h,function(b,c,d){Y(g).Ab(b,c,d,a)},c,N,"listByKeys")}else k(new I("first argumentmust be array of ydn.db.Key, but "+a[0]+" of "+typeof a[0]+" found."));else k(new I("first argument "+a+" is invalid."));
return h};
u.kb=function(a,b,c){var d=A(a)?a:C(a)?a.name:l;A(d)||k(new I("store name "+d+" must be a string, but "+typeof d));var e=X(this.b,d);e?this.b.a()&&C(a)&&(a=le(a),(a=ne(e,a))&&k(new cd("schema change: "+a))):(this.b.a()||k(new I('store name "'+d+'" not found.')),e=le(C(a)?a:{name:d}),Q(this.h,"Adding object store: "+d),Ae(this.g,e));a=zb();var f=this;e||k(new I('store name "'+d+'" not found.'));A(e.keyPath)&&x(c)&&k(new I("key cannot provide while in-line key is in used."));e.autoIncrement&&x(c)&&
k(new I("key cannot provide while autoIncrement is true."));!A(e.keyPath)&&(!e.autoIncrement&&!x(c))&&k(new I("out-of-line key must be provided."));if(y(b))Q(this.h,"addObjects: "+d+" "+b.length+" objects"),this.a.i(a,function(a,e,g){Y(f).rb(a,e,g,d,b,c)},[d],Cb,"putObjects"),e.ma&&a.ga(function(a){Hd(f.g,new Be(Ce,f.g,e.getName(),a,b))});else if(C(b)){var g="store: "+d+" key: "+!!e.keyPath?Gb(b,e.a):c;Q(this.h,"addObject: "+g);this.a.i(a,function(a,e,g){Y(f).qb(a,e,g,d,b,c)},[d],Cb,"putObject");
e.ma&&a.ga(function(a){Hd(f.g,new De(Ce,f.g,e.getName(),a,b))})}else k(new I("record must be an object or array list of objects, but "+b+" of type "+typeof b+" found."));return a};
u.Ea=function(a,b,c){var d=zb(),e=this;if(a instanceof $c){var d=a.a,f=X(this.b,d);f||k(new I('store "'+d+'" not found.'));if(f.keyPath){var g=Gb(b,f.a);g!=q?0!=Oc(g,a.id)&&k(new I("Inline key must be "+a+" but "+g+" found.")):Qd(f,b,a.id);return this.Ea(d,b)}return this.Ea(d,b,a.id)}if(y(a)){x(c)&&k(new I("too many arguments"));x(b)||k(new I("record values required"));for(var f=[],g=0,h=a.length;g<h;g++){var j=a[g].a;-1==xa(f,j)&&f.push(j);var m=X(this.b,j);m||k(new I('store "'+j+'" not found.'));
m.keyPath&&Qd(m,b[g],a[g].id)}Q(this.h,"putByKeys: to "+H(f)+" "+b.length+" objects");this.a.i(d,function(c,d,f){Y(e).fc(c,d,f,b,a)},f,Cb,"putByKeys")}else if(A(a)||C(a)){f=A(a)?a:C(a)?a.name:l;A(f)||k(new I("store name must be a string"));(g=X(this.b,f))?this.b.a()&&C(a)&&(h=le(a),(h=ne(g,h))&&k(new cd("schema change: "+h))):(this.b.a()||k(new Vc(f)),g=le(C(a)?a:{name:f}),Q(this.h,"Adding object store: "+f),Ae(this.g,g));g||k(new Vc(f));var m=g,n=m.getName();A(m.keyPath)&&x(c)&&k(new I("key cannot provide while in-line key is in used."));
m.autoIncrement&&x(c)&&k(new I("key cannot provide while autoIncrement is true."));!A(m.keyPath)&&(!m.autoIncrement&&!x(c))&&k(new I("out-of-line key must be provided."));y(b)?(Q(this.h,"putObjects: "+n+" "+b.length+" objects"),this.a.i(d,function(a,d,f){Y(e).Eb(a,d,f,n,b,c)},[n],Cb,"putObjects"),m.ma&&d.ga(function(a){Hd(e.g,new Be(Ee,e.g,n,a,b))})):C(b)?(Q(this.h,"putObject: "+n+" "+c),this.a.i(d,function(a,d,f){Y(e).Db(a,d,f,n,b,c)},[n],Cb,"putObject"),m.ma&&d.ga(function(a){Hd(e.g,new De(Ee,e.g,
n,a,b))})):k(new I("put record value must be Object or array of Objects"))}else k(new I("the first argument of put must be store name, store schema or array of keys."));return d};
u.clear=function(a,b,c){x(c)&&k(new I("too many input arguments"));c=zb();var d=this;if(A(a))if(X(this.b,a)||k(new I('store name "'+a+'" not found.')),C(b)){var e=ua(b);e===q&&k(new I("clear method requires a valid non-null KeyRange object."));Q(this.h,"clearByKeyRange: "+a+":"+H(e));this.a.i(c,function(b,c,f){Y(d).Rb(b,c,f,a,e)},[a],Cb,"clearByKeyRange")}else x(b)&&k(new I("clear method requires a valid KeyRange object as second argument, but found "+b+" of type "+typeof b)),Q(this.h,"clearByStore: "+
a),this.a.i(c,function(b,c,e){Y(d).Sa(b,c,e,[a])},[a],Cb,"clearByStores");else if(!x(a)||y(a)&&A(a[0])){var f=a||pe(this.b);Q(this.h,"clearByStores: "+H(f));this.a.i(c,function(a,b,c){Y(d).Sa(a,b,c,f)},f,Cb,"clearByStores")}else k(new I('first argument "'+a+'" is invalid.'));return c};
u.lb=function(a,b,c){var d=zb(),e=this;if(A(a)){var f=X(this.b,a);f||k(new I('store name "'+a+'" not found.'));if(x(c))if(A(b)){var g=Sd(f,b);g||k(new I("index: "+b+" not found in "+a));if(C(c)||c===q){var h=ua(c);Q(this.h,"removeByIndexKeyRange: "+a+":"+g.getName()+" "+a);this.a.i(d,function(b,c,d){Y(e).gc(b,c,d,a,g.getName(),h)},[a],Cb,"removeByIndexKeyRange")}else k(new I("key range "+c+' is invalid type "'+typeof c+'".'))}else k(new I('index name "'+b+'" must be a string, but '+typeof b+" found."));
else A(b)||B(b)||b instanceof DOMStringList||y(b)||b instanceof Date?(Q(this.h,"removeById: "+a+":"+b),this.a.i(d,function(c,d,f){Y(e).Fb(c,d,f,a,b)},[a],Cb,"removeById"),f.ma&&d.ga(function(b){Hd(e.g,new De(Fe,e.g,a,b,l))})):C(b)?(h=ua(b),Q(this.h,"removeByKeyRange: "+a+":"+H(h)),this.a.i(d,function(b,c,d){Y(e).hc(b,c,d,a,h)},[a],Cb,"removeByKeyRange"),f.ma&&d.ga(function(b){Hd(e.g,new Be(Fe,e.g,a,b,l))})):k(new I('Invalid key or key range "'+b+'" of type '+typeof b))}else k(new I('store name required, but "'+
a+'" of type '+typeof a+" found."));return d};u.toString=function(){return"DbOperator:"+this.g.getName()};E("ydn.db.con.IStorage.prototype.transaction",aa().prototype.transaction);function Ge(a,b,c,d){"transaction"in a?(this.w=a,this.f=this.m=q):"objectStore"in a?(this.w=q,this.m=a.db,this.f=a,this.f.db.objectStoreNames.contains(b)||k(new bd('store "'+b+'" not in transaction.'))):k(new bd("storage instance require."));this.Z=b;this.ia=c;this.ja=d;this.e=[];this.d=0;this.j=s}Ge.prototype.a=T("ydn.db.con.IdbCursorStream");Ge.prototype.j=s;Ge.prototype.e=[];function He(a,b,c){C(a)&&"transaction"in a?(this.Qa=a,this.la=q):C(a)&&"db"in a?(this.Qa=q,Ie(this,a)):k(new I("ydn.db.Streamer: First argument requires storage or transaction instance required."));A(b)||k(new I("a store name required."));this.a=b;x(c)&&!A(c)&&k(new I("index name must be a string."));this.za=c;this.la=q;this.ba=[];this.ra=[];this.Ja=s}u=He.prototype;u.Qa=q;u.g=q;u.Ib=q;u.ra=[];u.ba=[];u.la=q;u.ic=function(a){this.Ib=a};
function Ie(a,b){"db"in b?a.la=new Ge(b,a.a,a.za,na(a.ha,a)):k(new I("Invalid IndexedDB Transaction."))}function Je(a){var b=0<a.ba.length;if(b&&!a.Ja&&ha(a.Ib)){var c=function(){Je(a)},d=a.ra.shift(),e=a.ba.shift(),b=0<a.ba.length,c=a.Ib(d,e,b?c:q);b&&!c&&Je(a)}}u.Ja=s;u.zc=function(a){if(this.la){this.Ja=p;var b=this,c=this.la,d=function(){a(b.ra,b.ba);b.ra=[];b.ba=[];b.Ja=s};0==c.e.length&&0==c.d?d():c.ha=d}else a(this.ra,this.ba),this.ra=[],this.ba=[]};
u.ha=function(a,b){this.ra.push(a);this.ba.push(b);Je(this)};
u.push=function(a,b){this.Ja&&k(new Pc("push not allowed after a collection is started"));if(2<=arguments.length)this.ha(a,b);else{if(!this.la){this.Qa||k(new Pc("Database is not setup."));var c=this.Qa.m();c?"indexeddb"===c?this.la=new Ge(this.Qa,this.a,this.za,na(this.ha,this)):k(new dd(c)):k(new Pc("Database is not connected."))}var d=this.la;d.e.push(a);if(!d.j){var e=function(a,b){d.f=q;"complete"!==a&&O(d.a,b.name+":"+b.message);R(d.a,d+" transaction "+a)},f=function(a){var b=d.e.shift();R(d.a,
d+" transaction started for "+b);var c=a.objectStore(d.Z).openCursor(b);d.d++;c.onsuccess=function(a){if(a=a.target.result){if(ha(d.ja)){var b=a.value;d.ja(a.primaryKey,d.ia!=q?b[d.ia]:b)}else O(d.a,"sink gone, dropping value for: "+a.primaryKey);if(a&&0<d.e.length)a["continue"](d.e.shift());else d.d--,0==d.d&&d.ha&&d.ha()}};c.onerror=function(){O(d.a,"seeking fail. "+("error"in c?c.error.name+":"+c.error.message:""));d.d--;0==d.d&&d.ha&&d.ha()}};d.f?(R(d.a,d+" using existing tx."),f(d.f)):d.m?(R(d.a,
d+" creating tx from IDBDatabase."),d.b=d.m.transaction([d.Z],N),d.b.oncomplete=function(a){e("complete",a)},d.b.onerror=function(a){e("error",a)},d.b.onabort=function(a){e("abort",a)}):d.w?(R(d.a,d+" creating tx from ydn.db.con.IStorage."),d.j=p,d.w.transaction(function(a){d.j=s;f(a)},[d.Z],N,e)):k(new ed("no way to create a transaction provided."))}}};u.va=t("za");u.toString=function(){return"Streamer:"+this.a+(this.za||"")};function Ke(a,b,c,d,e,f,g){kd.call(this);this.mb=c;this.t=d;this.z=e;this.b=a;this.d=b;this.reverse="prev"==f||"prevunique"==f;this.ea=f;this.ab=g}F(Ke,kd);u=Ke.prototype;u.t="";u.Yb="";u.mb="";u.ea="";u.z=q;u.reverse=s;u.ab=p;u.aa=function(a){k(a)};u.Mb=function(){return this.t?this.W():this.l()};u.u=function(a,b,c){this.A(a,b,c)};u.A=aa();u.Y=s;u.wa=function(){this.b=q};
u.toString=function(){var a="";this.X()&&(a=" {"+this.l()+":"+this.W()+"}");return(this.b?"":"~")+"Cursor:"+this.mb+(x(this.t)?":"+this.t:"")+":tx"+this.d+a};function Le(a,b){a!=q&&!("push"in a)&&k(new bd);this.a=a||q;this.j=b;this.f=0}Le.prototype.m=T("ydn.db.algo.AbstractSolver");Le.prototype.a=q;Le.prototype.b=function(a){y(a)||k(new TypeError("iterators must be array"));2>a.length&&k(new RangeError("ZigzagMerge require at least 2 iterators, but  only "+a.length+" found."));for(var b=0;b<a.length;b++)a[b]instanceof W||k(new TypeError("item at iterators "+b+" is not an iterator."));return s};Le.prototype.d=function(){return[]};function Me(a,b,c,d,e,f,g){Ke.call(this,a,b,c,d,e,f,g);this.V=this.M=this.q=q;this.ca=s}F(Me,Ke);u=Me.prototype;u.Fa=T("ydn.db.index.req.IDBCursor");u.q=q;
u.Fc=function(a){var b="IDB"+this;if(this.q=a=a.target.result){if(this.V!=q){b=ue.cmp(a.key,this.V);if(1===b){this.V=this.M=q;this.u(a.primaryKey,a.key,a.value);return}if(0===b)this.V=q;else{a["continue"]();return}}if(this.M!=q)if(b=ue.cmp(this.M,a.primaryKey),0===b)this.M=q,this.ca?(this.ca=s,a["continue"]()):this.u(a.primaryKey,a.key,a.value);else if(1===b)a["continue"]();else this.M=q,this.u(a.primaryKey,a.key,a.value);else this.u(a.primaryKey,a.key,a.value)}else this.M=this.V=q,this.ca=s,R(this.Fa,
b+" completed."),this.u(l,l,l)};u.M=q;u.V=q;u.ca=s;
u.xa=function(a,b,c){var d="IDB"+this;this.M=a;this.V=b;this.ca=!!c;a=this.z;if(b!=q)if(this.z!=q){a=ue.cmp(b,this.z.lower);if(this.reverse&&1==a){R(this.Fa,d+" not opened, index key in reverse out of range "+b+">"+this.z.lower);this.A(l,l,l);return}if(!this.reverse&&-1==a){R(this.Fa,d+" not opened, index key out of range "+b+"<"+this.z.lower);this.A(l,l,l);return}a=va.bound(b,this.z.upper,s,this.z.upperOpen)}else a=va.lowerBound(b);b=this.b.objectStore(this.mb);c=this.t?b.index(this.t):q;R(this.Fa,
d+" opening ");b=this.ab?c?this.ea!=q?c.openKeyCursor(a,this.ea):a!=q?c.openKeyCursor(a):c.openKeyCursor():this.ea!=q?b.openCursor(a,this.ea):a!=q?b.openCursor(a):b.openCursor():c?this.ea!=q?c.openCursor(a,this.ea):a!=q?c.openCursor(a):c.openCursor():this.ea!=q?b.openCursor(a,this.ea):a!=q?b.openCursor(a):b.openCursor();Q(this.Fa,d+" opened, request "+b.readyState);b.onsuccess=na(this.Fc,this);b.onerror=na(this.aa,this)};u.X=function(){return!!this.q};u.W=function(){return this.q.key};u.l=function(){return this.q.primaryKey};
u.fa=function(){return this.q.value};u.Nb=function(a){if(this.q){var b=new L;a=this.q.update(a);a.onsuccess=function(a){M(b,a.target.result)};a.onerror=function(a){b.o(a)};return b}k(new Uc("cursor gone"))};u.clear=function(){if(this.q){var a=new L,b=this.q["delete"]();b.onsuccess=function(){M(a,1)};b.onerror=function(b){a.o(b)};return a}k(new Uc("cursor gone"))};u.gb=function(a,b){R(this.Fa,this+" restarting.");this.xa(b,a,p)};
u.advance=function(a){this.q||k(new Pc(this+" cursor gone."));this.M=this.V=q;this.ca=s;if(1==a)this.q["continue"]();else this.q.advance(a)};u.Ua=function(a){this.q||k(new Pc(this+" cursor gone."));this.t?(this.V=q,this.M=a,this.ca=s,this.q["continue"]()):(this.M=this.V=q,this.ca=s,this.q["continue"](a))};u.H=function(a){this.q||k(new Pc(this+" cursor gone."));this.M=this.V=q;this.ca=s;if(a!=q)this.q["continue"](a);else this.q["continue"]()};u.wa=function(){Me.L.wa.call(this);this.q=q};function Ne(a,b,c){ad.call(this,a,b,c)}F(Ne,id);Ne.prototype.c=T("ydn.db.index.req.IndexedDb");Ne.prototype.e=function(a,b,c,d,e,f){var g=[],h="keysByIterator:"+d,j=this;R(this.c,h);var m=Nc(d,a,b,this);m.aa=function(a){O(j.c,"error:"+h);Mc(d);m.I();c(a,p)};var n=0,r=s;m.A=function(a,b){x(b)?!r&&0<f?(m.advance(f),r=p):(n++,g.push(b),!x(e)||n<e?m.H():(Mc(d),m.I(),R(j.c,"success:"+h),c(g))):(Mc(d),m.I(),R(j.c,"success:"+h),c(g))}};
Ne.prototype.d=function(a,b,c,d,e,f){var g=[],h="listByIterator"+d+":tx"+b,j=this;R(this.c,h);var m=Nc(d,a,b,this);m.aa=function(a){O(j.c,"error:"+h);Mc(d);m.I();c(a,s)};var n=0,r=s;m.A=function(a,b,D){x(b)?!r&&0<f?(m.advance(f),r=p):(n++,g.push(d.N?a:D),!x(e)||n<e?m.H():(Mc(d),R(j.c,"success:"+h),m.I(),c(g))):(Mc(d),R(j.c,"success:"+h),m.I(),c(g))}};Ne.prototype.b=function(a,b,c,d,e,f,g){return new Me(a,b,c,d,e,f,g)};function Oe(a,b,c,d,e,f,g,h,j){Ke.call(this,a,b,d,e,g,h,j);this.Yb=f;this.a=c;this.Q=q;this.v=NaN}F(Oe,Ke);u=Oe.prototype;u.sa=T("ydn.db.index.req.WebsqlCursor");u.Q=q;u.v=NaN;
u.xa=function(a,b,c){var d=this.z;if(this.t&&b!=q)if(this.z!=q){d=ue.cmp(b,this.z.upper);if(1==d||0==d&&!this.z.upperOpen){this.A(l,l,l);return}d=va.bound(b,this.z.upper,s,this.z.upperOpen)}else d=va.lowerBound(b);var e=this,f=["SELECT"];b=[];var g=Td(this.a),h=this.t?Sd(this.a,this.t):q,j=h?h.type:this.a.type,m=h?h.r():this.a.r()||g,n=J(g),g=" ORDER BY ";if(this.ab)if(y(j)){for(var r=[],v=[],z=0;z<m.length;z++){var D=J(m[z]);r.push(D);D=this.reverse?D+" DESC":D+" ASC";v.push(D)}h&&(r.push(n),v.push(n+
this.reverse?" DESC":" ASC"));f.push(r.join(", "));g+=v.join(", ")}else h?(f.push(J(m)+", "+n),g+=this.reverse?J(m)+" DESC, "+n+" DESC ":J(m)+" ASC, "+n+" ASC "):(f.push(n),g=g+n+(this.reverse?" DESC":" ASC"));else f.push("*"),h?g+=this.reverse?J(m)+" DESC, "+n+" DESC ":J(m)+" ASC, "+n+" ASC ":(g+=n,g+=this.reverse?" DESC":" ASC");f.push("FROM "+J(this.mb));d=Ya(m,j,d);d.sql&&(f.push("WHERE "+d.sql),b=b.concat(d.params));f.push(g);this.Y=p;d=f.join(" ");R(e.sa,this+": opened: "+d+" : "+H(b));this.b.executeSql(d,
b,function(b,d){e.Y=s;e.Q=d;e.v=0;if(e.t&&a!=q)for(var f=Oc(e.l(),a);-1==f||0==f&&c;)e.v++,f=Oc(e.l(),a);e.u(e.l(),e.W(),e.fa())},function(a,b){e.Y=s;O(e.sa,"get error: "+b.message);e.aa(b);return p})};u.X=function(){return!!this.Q&&this.v<this.Q.rows.length};u.W=function(){if(this.t&&this.v<this.Q.rows.length){var a=this.Q.rows.item(this.v),b;b=Sd(this.a,this.t).type;if(y(b)){for(var c=this.Yb,d=[],e=0;e<c.length;e++)d[e]=Pd(a[c[e]],b[e]);return d}return Pd(a[this.t],b)}};
u.l=function(){if(this.v<this.Q.rows.length){var a=Td(this.a),b=this.Q.rows.item(this.v);return Pd(b[a],this.a.type)}};u.fa=function(){this.t||Td(this.a);if(this.v<this.Q.rows.length&&!this.ab){var a=this.Q.rows.item(this.v);return Od(a,this.a)}};
u.clear=function(a){this.X()||k(new Uc);a&&k(new dd);var b=new L,c=this;this.Y=p;a=Td(this.a);a="DELETE FROM "+Ud(this.a)+" WHERE "+a+" = ?";var d=[this.l()];R(c.sa,this+': clear "'+a+'" : '+H(d));this.b.executeSql(a,d,function(a,d){c.Y=s;M(b,d.rowsAffected)},function(a,d){c.Y=s;O(c.sa,"get error: "+d.message);b.o(d);return p});return b};
u.Nb=function(a,b){this.X()||k(new Uc);b&&k(new dd);var c=new L,d=this;this.Y=p;var e=this.l(),f=Yd(d.a,a,e),g="REPLACE INTO "+Ud(this.a)+" ("+f.Sb.join(", ")+") VALUES ("+f.jc.join(", ")+") ON CONFLICT FAIL";R(d.sa,this+': clear "'+g+'" : '+H(f.F));this.b.executeSql(g,f.F,function(){d.Y=s;M(c,e)},function(a,b){d.Y=s;O(d.sa,"get error: "+b.message);c.o(b);return p});return c};u.gb=function(a,b){R(this.sa,this+" restarting.");this.xa(b,a,p)};
u.advance=function(a){this.X()||k(new Pc(this+" cursor gone."));this.v+=a;this.u(this.l(),this.W(),this.fa())};
u.Ua=function(a){this.X()||k(new Pc(this+" cursor gone."));var b=Oc(a,this.l());(0==b||1==b&&this.reverse||-1==b&&!this.reverse)&&k(new Pc(this+" wrong direction."));for(var c=this.W(),d=this.Q.rows.length,e=0;e<d;e++){if(0==b||1==b&&this.reverse||-1==b&&!this.reverse){this.u(this.l(),this.W(),this.fa());return}this.v++;if(c&&c!=this.W()){this.u(this.l(),this.W(),this.fa());return}b=this.l();b=b!=q?Oc(a,b):1}this.u(l,l,l)};
u.H=function(a){this.X()||k(new Pc(this+" cursor gone."));var b=Oc(a,this.Mb());(0==b||1==b&&this.reverse||-1==b&&!this.reverse)&&k(new Pc(this+" wrong direction."));for(var c=this.Q.rows.length,d=0;d<c;d++){if(0==b||1==b&&this.reverse||-1==b&&!this.reverse){this.u(this.l(),this.W(),this.fa());return}this.v++;b=this.Mb();b=b!=q?Oc(a,b):1}this.u(l,l,l)};function Pe(a,b,c){ad.call(this,a,b,c)}F(Pe,Nd);Pe.prototype.c=T("ydn.db.index.req.WebSql");Pe.prototype.e=function(a,b,c,d,e,f){Qe(this,a,c,d,p,e,f)};Pe.prototype.d=function(a,b,c,d,e,f){Qe(this,a,c,d,s,e,f)};
function Qe(a,b,c,d,e,f,g){R(a.c,"fetchIterator:"+d);var h=X(a.a,d.P),j=d.va(),m=x(j)?Sd(h,j):q,j=m?m.r():h.keyPath!=q?h.keyPath:"_ROWID_",n=J(j),r=m?m.type:h.type,m="*";e?m=n:d.N&&(m=Zd(h));var m=m+" FROM "+Ud(h),v="",z=[],D=Ya(j,r,d.lc());D.sql&&(v="WHERE "+D.sql,z=D.params);D="ASC";d.mc()&&(D="DESC");n="ORDER BY "+n;if(y(j))for(var n="ORDER BY ",U="",P=0;P<j.length;P++)n+=U+'"'+J(j[P])+'"',U=", ";j="";x(f)&&(j=" LIMIT "+f);x(g)&&(j+=" OFFSET "+g);var V=["SELECT",m,v,"",n,D,j].join(" "),S;S=e||
d.N?function(a){return Pd(Re(a),r)}:function(a){return Od(a,h)};R(a.c,"SQL: "+V+" PARAMS: "+z);b.executeSql(V,z,function(b,d){for(var e=[],f=d.rows.length,g=0;g<f;g++){var h=d.rows.item(g);e.push(S(h))}R(a.c,"success "+V);c(e)},function(b,d){O(a.c,"error: "+V+" "+d.message);c(d,p);return s})}Pe.prototype.b=function(a,b,c,d,e,f,g){var h=X(this.a,c),j=d;d&&(j=Sd(h,d).r());return new Oe(a,b,h,c,d,j,e,f,g)};function Se(a,b,c){ad.call(this,a,b,c)}F(Se,Jd);function Te(a,b,c,d){ye.call(this,a,b,c,d)}F(Te,ze);u=Te.prototype;u.h=T("ydn.db.index.DbOperator");u.Da=function(a,b){var c=this;if(a instanceof W){var d=zb(),e=a.P,f=X(this.b,e);f||k(new I('store "'+e+'" not found.'));var g=a.va();x(g)&&!me(f,g)&&k(new I('index "'+g+'" not found in store "'+e+'".'));f=new L;f.G(function(a){M(d,a[0])},function(a){d.o(a)});Q(this.h,"listByIterator:"+a);this.a.i(f,function(b,d,e){Y(c).d(b,d,e,a,1,0)},[e],N,"getByIterator");return d}return Te.L.Da.call(this,a,b)};
u.keys=function(a,b,c,d,e){var f=this;if(a instanceof W){d=zb();var g=100;B(b)?(g=b,1>g&&k(new I("limit must be a positive value, but "+b))):x(b)&&k(new I("limit must be a number,  but "+b));var h=0;B(c)?h=c:x(c)&&k(new I("offset must be a number,  but "+c));Q(this.h,"keysByIterator:"+a);this.a.i(d,function(b,c,d){Y(f).e(b,c,d,a,g,h)},a.stores(),N,"listByIterator");return d}return Te.L.keys.call(this,a,b,c,d,e)};
u.Ca=function(a,b,c){var d=this;return a instanceof W?((x(b)||x(c))&&k(new I("too many arguments.")),b=zb(),Q(this.h,"countKeyRange:"+a),this.a.i(b,function(b,c,g){Y(d).ta(b,c,g,a.P,a.O,a.va())},a.stores(),N,"countByIterator"),b):Te.L.Ca.call(this,a,b,c)};
u.F=function(a,b,c,d,e){var f=this;if(a instanceof W){d=zb();var g;B(b)?(g=b,1>g&&k(new I("limit must be a positive value, but "+g))):x(b)&&k(new I("limit must be a number, but "+b));var h;B(c)?h=c:x(c)&&k(new I("offset must be a number, but "+c));Q(this.h,"listByIterator:"+a);this.a.i(d,function(b,c,d){Y(f).d(b,c,d,a,g,h)},a.stores(),N,"listByIterator");return d}return Te.L.F.call(this,a,b,c,d,e)};
u.sc=function(a,b,c){var d=zb();y(a)||k(new TypeError("First argument must be array."));for(var e=0;e<a.length;e++){var f=a[e]instanceof He;!(a[e]instanceof W)&&!f&&k(new TypeError("Iterator at "+e+" must be cursor range iterator or streamer."))}f=[];for(e=0;e<a.length;e++)for(var g=a[e].stores(),h=0;h<g.length;h++)0<=xa(f,g[h])||f.push(g[h]);R(this.h,this+": scan for "+a.length+" iterators on "+f);for(var j=c||[],e=0;e<j.length;e++)c=j[e].a,0<=xa(f,c)||f.push(c);var m=this;this.a.i(d,function(c,
d,e){function f(){for(var b=0,e=0;e<a.length;e++){var j=a[e],v=Nc(j,c,d,Y(m));v.aa=g;v.A=oa(h,b);jb[e]=v;wb[b]=e;b++;for(var v=0,z=j.fb.length+1-1;v<z;v++){var Vd;Y(m);Vd=new He(c,j.fb[v],j.xc[v]);Vd.ic(oa(P,b));Sb.push(Vd);Sa[b]=Sb.length;b++}}ga=a.length+Sb.length}function g(b){for(var c=0;c<a.length;c++)Mc(a[c]);for(c=0;c<jb.length;c++)jb[c].I();gb(jb);gb(Sb);Q(m.h,m+":tx"+d+": scanning error.");e(b,p)}function h(b,c,d,e){S&&k(new ed);Tb++;var f=a[wb[b]];Ob[b]=A(f.index)?d:c;nc[b]=f.N?c:e;b=Sa[b];
c=0;for(f=f.fb.length+1-1;c<f;c++){var g=Sb[b+c],j=d,m=e;x(g.b)?g.push(m):g.push(j)}Tb===ga&&V()}function P(a,b,c){S&&k(new ed);Ob[a]=b;nc[a]=c;Tb++;Tb===ga&&V();return s}function V(){var c;c=b instanceof Le?b.d(Ob,nc):b(Ob,nc);var f=[],g=[],h=[],j=[];if(y(c))for(var n=0;n<c.length;n++)c[n]===p?h[n]=1:c[n]===s?j[n]=p:g[n]=c[n];else if(c===q)f=[];else if(x(c))C(c)?(f=c.continuePrimary||[],g=c["continue"]||[],h=c.advance||[],j=c.restart||[]):k(new gd("scan callback output"));else{f=[];for(n=0;n<a.length;n++)x(wb[n])&&
(h[n]=1)}for(n=Tb=c=0;n<a.length;n++)f[n]==q&&(g[n]==q&&j[n]==q&&h[n]==q)&&Tb++;for(n=0;n<a.length;n++)if(f[n]!=q||g[n]!=q||j[n]!=q||h[n]!=q){var z=wb[n];x(z)||k(new gd(n+" is not an iterator."));var z=a[z],D=jb[n];Ob[n]==q&&(h[n]===p||g[n]!=q||f[n]!=q)&&k(new Pc(z+" at "+n+" must not advance."));Ob[n]=l;nc[n]=l;j[n]!=q?D.gb():g[n]!=q?D.H(g[n]):f[n]!=q?D.Ua(f[n]):h[n]!=q?D.advance(1):k(new ed(z+": has no action"));c++}if(0==c){for(f=0;f<a.length;f++)Mc(a[f]);for(f=0;f<jb.length;f++)jb[f].I();S=p;
gb(jb);gb(Sb);Q(m.h,m+":tx"+d+": scanning success.");e(l)}}R(m.h,m+":tx"+d+": scanning started.");for(var S=s,ga,Sa=[],wb=[],Ob=[],nc=[],jb=[],Sb=[],Tb=0,Wd=0;Wd<j.length;Wd++)Ie(j[Wd],c);b instanceof Le?b.b(a,function(){f()})||f():f()},f,N,"join");return d};
u.rc=function(a,b,c){a instanceof W||k(new I("First argument must be cursor range iterator."));X(this.b,a.P)||k(new I('Store "'+a.P+'" not found.'));c=c||N;var d=this,e=zb();Q(this.h,"open:"+c+" "+a);this.a.i(e,function(c,e,h){var j=Nc(a,c,e,Y(d));j.aa=function(b){Mc(a);j.I();h(b,p)};j.A=function(c){c!=q?(c=b(j),c===p?j.gb(q,q):C(c)?c.restart===p?j.gb(c["continue"],c.continuePrimary):c["continue"]!=q?j.H(c["continue"]):c.continuePrimary!=q?j.Ua(c.continuePrimary):(Mc(a),j.I(),h(l)):j.advance(1)):
(Mc(a),j.I(),h(l))}},a.stores(),c,"open");return e};u.map=function(a,b){for(var c=this,d=a.stores(),e,f=0;e=d[f];f++)e||k(new I('Store "'+e+'" not found.'));e=zb();R(this.h,"map:"+a);this.a.i(e,function(d,e,f){var m=Nc(a,d,e,Y(c));m.aa=function(a){f(a,s)};m.A=function(c,d,e){c!=q?(c=b(a.N?A(a.index)?d:c:A(a.index)?c:e),x(c)?(fa(c)&&k(new TypeError),c===q?f(l):m.H(c)):m.advance(1)):f(l)}},d,N,"map");return e};
u.reduce=function(a,b,c){for(var d=this,e=a.stores(),f,g=0;f=e[g];g++)f||k(new I('Store "'+f+'" not found.'));f=zb();var h=C(c)?ta(H(c)):c;Q(this.h,"reduce:"+a);this.a.i(f,function(c,e,f){var g=Nc(a,c,e,Y(d));g.aa=function(a){f(a,p)};var v=0;g.A=function(c,d,e){c!=q?(h=b(h,a.N?A(a.index)?d:c:A(a.index)?c:e,v++),g.advance(1)):f(h)}},e,N,"map");return f};function je(a,b){var c;c=c||{};if(a==q||b==q)return s;if(y(a)&&y(b)){if(a.length!=b.length)return s;for(var d=0;d<a.length;d++)if(-1==eb(b,function(b){return je(b,a[d])}))return s;return p}if(y(a))return 1==a.length&&je(a[0],b);if(y(b))return 1==b.length&&je(b[0],a);if(C(a)&&C(a)){for(var e in a)if(a.hasOwnProperty(e)&&!c[e]){var f=je(a[e],b[e]);if(!f)return s}for(e in b)if(b.hasOwnProperty(e)&&!c[e]&&(f=je(a[e],b[e]),!f))return s;return p}return a===b}
function Re(a){for(var b in a)if(a.hasOwnProperty(b))return a[b]};function Ue(a){this.a=a}Ue.prototype.a=[];
Ue.prototype.b=function(a,b){for(var c=[],d=0;d<this.a.length;d++){var e=this.a[d],f="'"===e[0]&&"'"===e[e.length-1];if('"'===e[0]&&'"'===e[e.length-1])e=Gb(a,Ia(e,'"').split(".")),c.push(e);else if(f)c.push(Ia(e,"'"));else if(A(e))if("true"===e)c.push(p);else if("false"===e)c.push(s);else if("Date"===e)c.push(new Date(parseInt(c.pop(),10)));else if("now"===e)c.push(new Date);else if("!"===e)c[c.length-1]=!c[c.length-1];else if("=="===e)c.push(c.pop()==c.pop());else if("==="===e)c.push(c.pop()===
c.pop());else if("!="===e)c.push(c.pop()!=c.pop());else if("!=="===e)c.push(c.pop()!==c.pop());else if("<="===e)c.push(c.pop()<=c.pop());else if("<"===e)c.push(c.pop()<c.pop());else if(">="===e)c.push(c.pop()>=c.pop());else if(">"===e)c.push(c.pop()>c.pop());else if("&"===e)c.push(c.pop()&c.pop());else if("|"===e)c.push(c.pop()|c.pop());else if("?"===e){var e=!!c.pop(),f=c.pop(),g=c.pop(),e=e?f:g;c.push(e)}else"+"===e?c.push(c.pop()+c.pop()):"-"===e?c.push(c.pop()-c.pop()):"*"===e?c.push(c.pop()*
c.pop()):"/"===e?c.push(c.pop()/c.pop()):"%"===e?c.push(c.pop()%c.pop()):"at"===e?(f=c.pop(),e=c.pop(),c.push(e[f])):"of"===e?(f=c.pop(),e=c.pop(),e=y(e)?e.indexOf(f):-1,c.push(e)):"in"===e?(f=c.pop(),e=c.pop(),e=y(e)?0<=e.indexOf(f):s,c.push(e)):"abs"===e?c[c.length-1]=Math.abs(c[c.length-1]):"$"==e[0]&&/^\$\d$/.test(e)?(e=parseInt(e.match(/^\$(\d)$/)[1],10),c.push(arguments[e])):c.push(parseFloat(e));else c.push(e)}return c[0]};
Ue.prototype.d=function(){return function(){var a=2<arguments.length?Array.prototype.slice(arguments,2):l;return Ue.prototype.b.apply(q,a)}};Ue.prototype.toJSON=function(){return{Tokens:ta(H(this.a))}};function Ve(a){A(a)||k(new bd);this.U=a;We(this,a);this.Oa=""}u=Ve.prototype;u.U="";u.Pa=N;u.bc=NaN;u.ec=NaN;u.Gb=s;u.Oa="";
function We(a,b){var c=b.split(/\sFROM\s/i);2!=c.length&&k(new Zc("FROM required."));var d=c[1],c=c[0].match(/\s*?(SELECT|INSERT|UPDATE|DELETE)\s+(.*)/i);3!=c.length&&k(new Zc("Unable to parse: "+b));a.d=c[1].toUpperCase();"SELECT"==a.d?a.Pa=N:"INSERT"==a.d?a.Pa=Cb:"UPDATE"==a.d?a.Pa=Cb:"DELETE"==a.d?a.Pa=Cb:k(new Zc("Unknown SQL verb: "+a.d));var c=c[2].trim(),e=c.match(/^(MIN|MAX|COUNT|AVG|SUM)/i);e?(a.e=e[0].toUpperCase(),c=c.replace(/^(MIN|MAX|COUNT|AVG|SUM)/i,"").trim()):a.e=l;"("==c.charAt(0)&&
(")"==c.charAt(c.length-1)?c=c.substring(1,c.length-1):new Zc("missing closing parentheses"));a.w=c;c=d.search(/(ORDER BY|LIMIT|OFFSET)/i);0<c?(a.a=d.substring(c),d=d.substring(0,c)):a.a="";c=d.search(/WHERE/i);0<c?(a.f=d.substring(c+6).trim(),d=d.substring(0,c)):a.f="";a.b=d.trim().split(",").map(function(a){a=Ia(a,'"');a=Ia(a,"'");return a.trim()})}
u.parse=function(a){if(a){for(var b=0;b<a.length;b++)this.U=this.U.replace("?",a[b]);We(this,this.U)}this.j=Xe(this);if(!this.j)return this.Oa;a=this.a.length;if(b=/OFFSET\s+(\d+)/i.exec(this.a))this.ec=parseInt(b[1],10),a=this.a.search(/OFFSET/i);if(b=/LIMIT\s+(\d+)/i.exec(this.a))this.bc=parseInt(b[1],10),b=this.a.search(/LIMIT/i),b<a&&(a=b);(a=/ORDER BY\s+(.+)/i.exec(this.a.substr(0,a)))?(a=a[1].trim(),(b=a.match(/(ASC|DESC)/i))?(this.Gb="DESC"==b[0].toUpperCase(),a=a.replace(/\s+(ASC|DESC)/i,
"")):this.Gb=s,this.m=Ia(Ia(a,'"'),"'")):this.m=l;return""};function Ye(a){if("*"==a.w)return q;a=a.w.split(",");return a=a.map(function(a){return Ia(a.trim(),'"')})}u.toJSON=function(){return{sql:this.U}};
function Xe(a){function b(a){return fb(c,function(b){return b.da==a})}var c=[],d=/(.+?)(<=|>=|=|>|<)(.+)/i;if(0<a.f.length)for(var e=a.f.split("AND"),f=0;f<e.length;f++){var g=e[f],h=d.exec(g);if(h){var j=h[1].trim(),j=Ia(j,'"'),j=Ia(j,"'");if(0<j.length){var m=h[3].trim(),m=0==m.lastIndexOf('"',0)?Ia(m,'"'):0==m.lastIndexOf("'",0)?Ia(m,"'"):parseFloat(m),h=new Xa(j,h[2],m),j=b(j);if(0<=j){if(c[j]=c[j].sb(h),!c[j])return a.Oa='where clause "'+g+'" conflict',q}else c.push(h)}else return a.Oa='Invalid clause "'+
g+'"',q}else return a.Oa='Invalid clause "'+g+'"',q}return c}u.toString=function(){return"query:"+this.U};function Ze(a,b){this.sql=b;this.a=a}Ze.prototype.toJSON=function(){return{sql:this.sql}};Ze.prototype.toString=ba("idb.Node:");
Ze.prototype.uc=function(a,b,c,d){var e=ib(this.sql.b)[0],f=this.sql.j,g=this.sql.bc,g=isNaN(g)?100:g,h=this.sql.ec,h=isNaN(h)?0:h,j=this.sql.m,m=Ye(this.sql),n=q,r=this.sql.Gb;0==f.length?n=q:1==f.length?n=ua(f[0].a):k(new cd("too many conditions."));var v=c;m===q||(v=function(a,b){if(b)c(a,p);else{var d=a.map(function(a){var b=m.length;if(1==b)return La(a,m[0]);for(var c={},d=0;d<b;d++)c[m[d]]=La(a,m[d]);return c});c(d)}});j&&j!=this.a.r()?d.La(a,b,v,e,j,n,r,g,h,s):0<f.length&&f[0].da!=this.a.r()?
d.La(a,b,v,e,f[0].da,n,r,g,h,s):d.Ma(a,b,v,e,n,r,g,h)};function $e(a,b){Ze.call(this,a,b)}F($e,Ze);
$e.prototype.uc=function(a,b,c,d){var e,f=ib(this.sql.b)[0],g=this.sql.j,h=q;0==g.length?h=q:1==g.length?h=ua(g[0].a):k(new cd("too many conditions."));var j=this.sql.e;if("COUNT"==j)h?d.ta(a,b,c,f,h,g[0].da):d.ta(a,b,c,f,q);else{var m,n=Ye(this.sql);(!n||0==n.length)&&k(new Pc("field name require for reduce operation: "+j));var r=n[0];"MIN"==j?m=function(a,b){var c=a[r];return!x(b)?c:b<c?b:c}:"MAX"==j?m=function(a,b){var c=a[r];return!x(b)?c:b>c?b:c}:"AVG"==j?(e=0,m=function(a,b,c){x(b)||(b=0);return(b*
c+a[r])/(c+1)}):"SUM"==j?(e=0,m=function(a,b){return b+a[r]}):k(new cd(j));var v=Nc(h?new Kc(f,g[0].da,h):new Jc(f),a,b,d);v.aa=function(a){c(a,p)};var z=0;v.A=function(a,b,d){x(b)?(e=m(d,e,z),v.advance(1),z++):c(e)}}};function af(a,b,c){ad.call(this,a,b,c)}F(af,Ne);af.prototype.c=T("ydn.db.sql.req.IndexedDb");af.prototype.executeSql=function(a,b,c,d,e){(e=d.parse(e))&&k(new Zc(e));e=ib(d.b);if(1==e.length){var f=X(this.a,e[0]);f||k(new Vc(e[0]));var g=Ye(d);if(g)for(var h=0;h<g.length;h++)me(f,g[h])||k(new Vc('Index "'+g[h]+'" not found in '+e[0]));(d.e?new $e(f,d):new Ze(f,d)).uc(a,b,c,this)}else k(new cd(d.U))};function bf(a,b){this.sql=b;this.d=a;this.a=Ye(b)}bf.prototype.b=T("ydn.db.sql.req.websql.Node");bf.prototype.toJSON=function(){return{sql:this.sql.U}};bf.prototype.toString=ba("websql.Node:");function cf(a,b){if(a.a){if(1==a.a.length){if(C(b))return Gb(b,a.a[0]);return}for(var c={},d=0;d<a.a.length;d++)c[a.a[d]]=Gb(b,a.a[d]);return c}return Od(b,a.d)}
bf.prototype.vc=function(a,b,c){var d=this,e=[];b.executeSql(this.sql.U,c,function(b,c){for(var h=c.rows.length,j=0;j<h;j++){var m=c.rows.item(j);if(C(m))var n=cf(d,m);e.push(n)}a(e)},function(b,c){O(d.b,"Sqlite error: "+c.message);a(c,p);return p})};function df(a,b){bf.call(this,a,b)}F(df,bf);df.prototype.vc=function(a,b,c){var d=this;b.executeSql(this.sql.U,c,function(b,c){var d=c.rows.length;1==d?(d=Re(c.rows.item(0)),a(d)):0==d?a(l):k(new Sc)},function(b,c){O(d.b,"Sqlite error: "+c.message);a(c,p);return p})};function ef(a,b,c){ad.call(this,a,b,c)}F(ef,Pe);ef.prototype.c=T("ydn.db.sql.req.WebSql");ef.prototype.executeSql=function(a,b,c,d,e){b=ib(d.b);if(1==b.length){var f=X(this.a,b[0]);f||k(new Vc(b[0]));var g=Ye(d);if(g)for(var h=0;h<g.length;h++)me(f,g[h])||k(new Vc('Index "'+g[h]+'" not found in '+b[0]));(d.e?new df(f,d):new bf(f,d)).vc(c,a,e)}else k(new cd(d.U))};function ff(a,b,c){ad.call(this,a,b,c)}F(ff,Se);function gf(a,b,c,d){ye.call(this,a,b,c,d)}F(gf,Te);gf.prototype.executeSql=function(a,b){for(var c=zb(),d=new Ve(a),e=ib(d.b),f=0;f<e.length;f++){var g=X(this.b,e[f]);g||k(new I("store: "+g+" not exists."))}var h=this;Q(this.h,"executeSql: "+a+" params: "+b);this.a.i(c,function(a,c){Y(h).executeSql(c,a,d,b||[])},ib(d.b),d.Pa,"executeSql");return c};function hf(){this.clear()}u=hf.prototype;u.setItem=function(a,b){x(this.a[a])||(this.keys.push(a.toString()),this.length=this.keys.length);this.a[a]=b};u.getItem=function(a){return this.a[a]||q};u.removeItem=function(a){delete this.a[a];hb(this.keys,a.toString());this.length=this.keys.length};u.length=0;u.key=function(a){a=this.keys[a];return x(a)?this.a[a]:q};u.clear=function(){this.a={};this.keys=[];this.length=0};function jf(a){this.g=a||new hf}u=jf.prototype;u.oc=T("ydn.db.con.SimpleStorage");u.Kb=ba(1);u.Aa=function(a,b){this.ua=a;this.d=b;this.a={};for(var c=0;c<b.stores.length;c++){var d=b.b(c);this.a[d.getName()]=d.toJSON()}this.indexes={};d=kf(this);if(c=ta(this.g.getItem(d)))for(var e in c)c.hasOwnProperty(e)&&!qe(b,e)&&(d=c[e],b.a()?(Q(this.oc,"Adding existing store: "+e),this.a[e]=d):(Q(this.oc,"Deleting old store: "+e),Md(this,e)));else this.g.setItem(d,H(this.a));return xb(1)};u.jb=function(){return!!this.ua};
u.Jb=function(){return this.g||q};u.Ba=ba("memory");u.ib=aa();u.Wa=function(a,b,c,d){a(this);d("complete",{})};u.$=function(a){Id(function(){for(var b=[],c=this.g.getItem(kf(this)).stores,d=0;d<c.length;d++){var e=this.g.getItem(kf(this,c[d]));b[d]=new ke(c[d],e.keyPath,e.autoIncrement)}b=new oe(this.ua,b);a(b)},0,this)};function kf(a,b,c){a=["ydn.db",a.ua];x(b)&&(a.push(b),x(c)&&a.push(Na(c)));return a.join("^|")}
function Ld(a,b,c){b=kf(a,b instanceof ke?b.name:b,c);a=a.g.getItem(b);return a=a===q?l:ta(a)}function Kd(a,b,c,d){var e;e=X(a.d,c);d=x(d)?d:e.keyPath!=q?Gb(b,e.a):l;x(d)||(e.autoIncrement?(kf(a,e.name),d=a.a[e.name],x(d.autoIncrementNo)||(d.autoIncrementNo=a.Za(e.name,q).length),d.autoIncrementNo++,d=d.autoIncrementNo):k(new Rc));e=d;d=kf(a,c,e);b=H(b);a.g.setItem(d,b);if(a=a.a[c].Keys){c=0;for(b=a.length;c<b&&e!=a[c];c++)if(e>a[c]){kb(a,c,0,e);break}}return e}
function Md(a,b,c){if(x(c))a.g.removeItem(kf(a,b,c)),a=a.a[b].Keys,x(a)&&hb(a,c);else if(x(b)){a.a[b]&&(a.a[b].Keys=q);c=kf(a,b)+"^|";for(b=a.g.length-1;0<=b;b--){var d=a.g.key(b);0==d.lastIndexOf(c,0)&&a.g.removeItem(d)}}else{c=kf(a)+"^|";for(b=a.g.length-1;0<=b;b--)d=a.g.key(b),0==d.lastIndexOf(c,0)&&a.g.removeItem(d)}}
u.index=function(a){var b=this.a[a],c=b.Keys;if(c==q){c=[];a=kf(this,a);a+="^|";for(var d=0,e=this.g.length;d<e;d++){var f=this.g.key(d);if(0==f.lastIndexOf(a,0)){c.push(f);for(var f=0,g=b.indexes.length;f<g;f++);}}ab.sort.call(c,ob);b.Keys=c;b.indexes={}}return c};
u.Za=function(a,b,c,d,e,f){function g(){return e?function(a){return a>c}:function(a){return a>=c}}function h(){return f?function(a){return a<=d}:function(a){return a<d}}b!=q&&k(new dd);a=this.index(a);if(!x(c)&&!x(d))return a;if(x(c)){if(x(d)){b=fb(a,h());var j=fb(a,g());return a.slice(b,j)}b=fb(a,g());return a.slice(b)}b=fb(a,h());return a.slice(0,b)};function lf(){jf.call(this,window.localStorage)}F(lf,jf);lf.prototype.Ba=ba("localstorage");function mf(){jf.call(this,window.sessionStorage)}F(mf,jf);mf.prototype.Ba=ba("sessionstorage");var Ce="created",Fe="deleted",Ee="updated";function nf(a,b){pd.call(this,a,b)}F(nf,pd);nf.prototype.j=t("e");function of(a,b,c,d,e){pd.call(this,a,b);this.version=c;this.qc=d;this.pc=e}F(of,nf);u=of.prototype;u.name="StorageEvent";u.version=NaN;u.qc=NaN;u.pc=q;u.Uc=t("version");u.Cc=t("qc");u.Tc=t("pc");function De(a,b,c,d,e){pd.call(this,a,b);this.e=c;this.key=d;this.value=e}F(De,nf);De.prototype.name="RecordEvent";De.prototype.f=t("key");De.prototype.m=t("value");
function Be(a,b,c,d,e){pd.call(this,a,b);this.e=c;this.keys=d;this.F=e}F(Be,nf);Be.prototype.name="StoreEvent";Be.prototype.Za=t("keys");Be.prototype.f=t("F");function xe(a,b){oe.call(this,a,b)}F(xe,oe);xe.prototype.a=ba(p);/*
 Copyright 2012 YDN Authors, Yathit. All Rights Reserved.
 Licensed under the Apache License, Version 2.0 (the "License");
*/
function Z(a,b,c){kd.call(this);c=c||{};var d=["autoSchema","connectionTimeout","size","mechanisms","thread"],e;for(e in c)c.hasOwnProperty(e)&&-1==xa(d,e)&&k(new I('Unknown attribute "'+e+'" in options.'));this.Dc=c.mechanisms||pf;this.cc=c.size;this.kc=x(c.kc)?c.kc:s;this.a=this.w=q;this.j=[];this.$a=s;if(b instanceof oe)e=b;else if(C(b)){e=c.autoSchema||!x(b.stores)?new xe(b):new oe(b);c=0;for(d=b.stores?b.stores.length:0;c<d;c++){var f=X(e,b.stores[c].name);b.stores[c].Sync&&O(this.f,"Synchronization option for "+
f.getName()+" ignored.")}}else e=new xe;this.b=e;x(a)&&this.Z(a)}F(Z,Gd);Z.prototype.f=T("ydn.db.con.Storage");Z.prototype.Ec=function(a){if(x(a)){var b=function(b){a(b.toJSON())};if(this.a)this.a.$(b);else{var c=this;this.transaction(function(a){c.a.$(b,a)},q,N)}}return this.b?this.b.toJSON():q};
function Ae(a,b){var c=b instanceof ke?b:le(b),d=b.name,e=X(a.b,d);0==ne(c,e).length?xb(s):(e=e?"update":"add",a.b instanceof xe?(a.b.stores.push(c),a.a?(a.a.ib(),a.a=q,qf(a)):xb(s)):k(new fd("Cannot "+e+" store: "+d+". Not auto schema generation mode.")))}Z.prototype.Z=function(a){this.a&&k(Error("Already defined with "+this.e));this.e=a;qf(this)};E("ydn.db.con.Storage.prototype.setName",Z.prototype.Z);Z.prototype.getName=t("e");var pf=["indexeddb","websql","localstorage","sessionstorage","memory"];
function rf(a,b){return"indexeddb"==b?new se(a.cc):"websql"==b?new ve(a.cc):"localstorage"==b?new lf:"sessionstorage"==b?new mf:"memory"==b?new jf:q}
function qf(a){for(var b=q,c=a.Dc,d=0;d<c.length;d++){var e=c[d].toLowerCase();if("indexeddb"==e&&ue){b=rf(a,e);break}else if("websql"==e&&ha(w.openDatabase)){b=rf(a,e);break}else if("localstorage"==e&&window.localStorage){b=rf(a,e);break}else if("sessionstorage"==e&&window.sessionStorage){b=rf(a,e);break}else if("memory"==e){b=rf(a,e);break}}b===q&&k(new fd("No storage mechanism found."));b.Aa(a.e,a.b).G(function(c){a.a=b;R(a.f,a+": ready.");a.Sc=NaN;var d=new of("ready",a,parseFloat(b.Kb()),parseFloat(c),
q);Id(function(){if(a.onReady)a.onReady(d);Hd(a,d);sf(a)});b.b=function(){R(a.f,a+": disconnected.")}},function(b){O(a.f,a+": opening fail: "+b.message);(new L).o(b);var c=new of("ready",a,NaN,NaN,b);c.message=b.message;Id(function(){a.w&&a.w(c);Hd(a,c);if(a.j){a.f.log(tc,"Purging "+a.j.length+" transactions request.",l);for(var d=a.j.shift();d;)d.S("error",b),d=a.j.shift()}})})}Z.prototype.m=function(){if(this.a)return this.a.Ba()};E("ydn.db.con.Storage.prototype.getType",Z.prototype.m);
Z.prototype.w=q;Z.prototype.eb=function(){this.a&&(this.a.ib(),this.a=q,R(this.f,this+" closed"))};E("ydn.db.con.Storage.prototype.close",Z.prototype.eb);u=Z.prototype;u.Rc=function(){return this.a?this.a.Jb():q};u.Sc=NaN;function sf(a){var b=a.j.shift();b&&(R(a.f,"pop tx queue "+b.oa.name),Z.prototype.transaction.call(a,b.oa,b.Ic,b.mode,b.S));pa()}u.$a=s;
u.transaction=function(a,b,c,d){var e=b;if(A(b))e=[b];else if(b!=q)if(ea(b)){0==b.length&&k(new I("number of store names must more than 0"));for(var f=0;f<b.length;f++)A(b[f])||k(new I("store name at "+f+" must be string but found "+typeof b[f]))}else k(new I("store names must be an array"));else e=q;if(!this.a||!this.a.jb()||this.$a)b=a,f=d,R(this.f,"push tx queue "+b.name),this.j.push({oa:b,Ic:e,mode:c,S:f}),pa(),100<this.j.length&&0==this.j.length%100&&O(this.f,"Transaction queue stack size is "+
this.j.length+". It is too large, possibility due to incorrect usage.");else{var g=this,h=x(c)?c:N;h==Db&&(this.$a=p);this.a.Wa(function(b){a(b);a=q},e,h,function(a,b){ha(d)&&(d(a,b),d=l);h==Db&&(g.$a=s);sf(g)})}};u.addEventListener=function(a,b,c,d){function e(a){0<=xa(["created","ready","deleted","updated"],a)||k(new I('Invalid event type "'+a+'"'))}if(ea(a))for(var f=0;f<a.length;f++)e(a[f]);else e(a);Z.L.addEventListener.call(this,a,b,c,d)};u.toString=function(){return"ydn.db.con.Storage:"+this.a};function de(a){this.e=a;this.a=q;this.b=0}u=de.prototype;u.Xc=T("ydn.db.tr.Mutex");u.nb="";u.K=q;function tf(a,b,c){if(!a.K||!a.mode||c!=a.mode||a.K.length!=b.length)return s;for(c=0;c<b.length;c++)if(-1==a.K.indexOf(b[c]))return s;return p}u.S=q;u.toString=function(){var a;return a="Mutex:"+this.e+":"+this.b+(this.nb?"["+this.nb+"]":"")};function uf(a,b,c,d){this.a=a;this.f=b;this.b=ib(c);this.d=d;this.e=[]}uf.prototype.a=q;uf.prototype.abort=function(){this.a?this.a.abort():k(new Tc("transaction completed"))};uf.prototype.s=t("f");function vf(a,b,c){a.a?(b(a.a),c&&a.e.push(c)):k(new Wa("tx committed on ParallelTxExecutor"))}uf.prototype.toString=function(){return"ParallelTxExecutor: txNo:"+this.f+" mode:"+this.d+" scopes:"+H(this.b)};function wf(a,b,c){this.g=a;this.e=b;this.b=0;this.Ga=this.T=q;this.d=c||""}u=wf.prototype;u.T=q;u.Ga=q;u.ob=T("ydn.db.tr.Parallel");u.s=t("b");u.type=function(){return this.g.m()};u.abort=function(){Q(this.ob,this+": aborting");be(this.Ga)};u.pb=ba(s);
u.ya=function(a,b,c,d){function e(c){h.b++;j=new uf(c,h.b,b,g);R(h.ob,h+":tx"+j.s()+H(b)+g+" begin");h.T=j;vf(h.T,a,d)}function f(a,b){R(h.ob,h+":tx"+j.s()+" committed");for(var c=j,d;d=c.e.shift();)d(a,b);c.a=q;c.b=q;c.e=q}var g=x(c)?c:N,h=this,j;this.T&&this.T.a&&this.pb(b,g)?vf(this.T,a,d):this.g.transaction(e,b,g,f)};u.i=function(a,b,c,d,e,f){var g=this;this.ya(function(c){function d(b,e){g.Ga=c;e?a.o(b):M(a,b);d=g.Ga=q}b(c,g.s(),d)},c,d,f)};
u.toString=function(){var a;a="Parallel:"+this.g.getName();var b=this.d;return a+":"+this.e+":"+this.s()+(b?" :"+b:"")};function xf(a,b,c){wf.call(this,a,b,c)}F(xf,wf);xf.prototype.pb=ba(s);xf.prototype.i=function(a,b,c,d,e,f){var g,h=s,j=new L;j.G(function(a){g=a},function(a){h=p;g=a});xf.L.i.call(this,j,b,c,d,e,function(b,c){h?a.o(g):M(a,g);f&&(f(b,c),f=l)})};function yf(a,b){ce.call(this,a,b)}F(yf,ce);yf.prototype.d=T("ydn.db.tr.StrictOverflowSerial");yf.prototype.Ob=function(a,b){return tf(this.a,a,b)};yf.prototype.Zb=function(){var a=this.a;return!!a&&tf(a,0<this.b.length?this.b[0].K:q,0<this.b.length?this.b[0].mode:q)};function zf(a,b,c){wf.call(this,a,b,c)}F(zf,wf);zf.prototype.pb=function(a,b){var c;a:if(c=this.T,!c.K||!c.d||b!=c.d||c.b.length!=a.length)c=s;else{for(var d=0;d<a.length;d++)if(-1==c.b.indexOf(a[d])){c=s;break a}c=p}return c};function Af(a,b){ce.call(this,a,b)}F(Af,ce);Af.prototype.Ob=function(a,b){var c;a:if(c=this.a,!c.K||!c.mode||b!=c.mode&&(c.mode!=Cb||b!=N)||a.length>c.K.length)c=s;else{for(var d=0;d<a.length;d++)if(-1==c.K.indexOf(a[d])){c=s;break a}c=p}return c};function Bf(a,b,c){wf.call(this,a,b,c)}F(Bf,wf);Bf.prototype.pb=function(a,b){var c;a:if(c=this.T,!c.b||!c.d||b!=c.d&&(c.d!=Cb||b!=N)||a.length>c.b.length)c=s;else{for(var d=0;d<a.length;d++)if(-1==c.b.indexOf(a[d])){c=s;break a}c=p}return c};function Cf(a,b,c){wf.call(this,a,b,c);this.a=s}F(Cf,wf);Cf.prototype.a=s;Cf.prototype.i=function(a,b,c,d,e,f){function g(c){function d(b,e){h.Ga=c;e?a.o(b):M(a,b);d=h.Ga=q}b(c,h.s(),d);b=q}var h=this;this.T&&this.T.a?vf(this.T,g,f):(this.a&&(Bc(this.ob,"single thread has already committed the transaction"),k(new Tc)),this.a=p,this.ya(g,c,d,f))};function Df(a,b,c){Z.call(this,a,b,c);this.B=0;a="samescope-multirequest-serial";c&&c.thread&&(a=ae.indexOf(c.thread),-1==a&&k(new bd("thread: "+c.thread)),a=ae[a]);this.bb=a;this.d=this.Pb(this.bb,"base")}F(Df,Z);u=Df.prototype;u.B=0;u.Pb=function(a,b){this.B++;b=b||"branch"+this.B;var c=Ef(this,a,b);return this.Na(c,q,b)};u.s=function(){return this.d?this.d.s():NaN};u.Na=function(a,b,c){return new ye(this,this.b,c||"",a)};
function Ef(a,b,c){b=b||a.bb;if("serial"==b)return new ce(a,a.B++);if("parallel"==b)return new wf(a,a.B++,c);if("atomic-parallel"==b)return new xf(a,a.B++,c);if("atomic-serial"==b)return new ee(a,a.B++);if("samescope-multirequest-parallel"==b)return new zf(a,a.B++,c);if("samescope-multirequest-serial"==b)return new yf(a,a.B++);if("multirequest-parallel"==b)return new Bf(a,a.B++,c);if("multirequest-serial"==b)return new Af(a,a.B++);if("single"==b)return new Cf(a,a.B++,c);k(new I('invalid transaction policy thread type "'+
b+'"'))}u.abort=function(){return this.d.abort()};
u.Hc=function(a,b,c,d,e){var f=this;this.B++;var g=A(a.name)&&0<a.name.length?a.name:"run"+this.B,h=Ef(this,"single",g),j=this.Na(h,q,g),m=c||N;-1==[N,Cb].indexOf(m)&&k(new I("invalid mode"));b!=q||(b=pe(this.b));if(ea(b)){0==b.length&&k(new I("number of store names must more than 0"));for(var n=0;n<b.length;n++)A(b[n])||k(new I("store name at "+n+" must be string but found "+typeof b[n]))}else k(new I("store names must be an array"));var r=a;if(4<arguments.length)var v=Array.prototype.slice.call(arguments,
4),r=function(){var b=Array.prototype.slice.call(arguments),b=b.concat(v);return a.apply(this,b)};R(this.f,"scheduling run in transaction "+g+" with "+h);h.ya(function(){R(f.f,"executing run in transaction "+g);r(j);r=q},b,m,d)};function $(a,b,c){Df.call(this,a,b,c)}F($,Df);u=$.prototype;u.Na=function(a,b,c){return new ze(this,this.b,c||"",a)};u.Bb=function(a){var b=this.m();if("indexeddb"==b)return new id(this.e,this.b,a);if("websql"==b)return new Nd(this.e,this.b,a);if("memory"==b||"localstorage"==b||"sessionstorage"==b)return new Jd(this.e,this.b,a);k(new Sc("No executor for "+b))};u.kb=function(a,b,c){return this.d.kb(a,b,c)};u.Ca=function(a,b,c){return this.d.Ca(a,b,c)};u.Da=function(a,b){return this.d.Da(a,b)};
u.keys=function(a,b,c,d,e,f){return this.d.keys(a,b,c,d,e,f)};u.F=function(a,b,c,d,e,f){return this.d.F(a,b,c,d,e,f)};u.Ea=function(a,b,c){return this.d.Ea(a,b,c)};u.clear=function(a,b,c){return this.d.clear(a,b,c)};u.lb=function(a,b,c){return this.d.lb(a,b,c)};u.toString=function(){return"Storage:"+this.getName()+":"+this.s()};function Ff(a,b,c){Df.call(this,a,b,c)}F(Ff,$);u=Ff.prototype;u.Bb=function(a){var b=this.m();if("indexeddb"==b)return new Ne(this.e,this.b,a);if("websql"==b)return new Pe(this.e,this.b,a);if("memory"==b||"localstorage"==b||"sessionstorage"==b)return new Se(this.e,this.b,a);k(new Sc("No executor for "+b))};u.Na=function(a,b,c){return new Te(this,this.b,c||"",a)};u.Vc=function(a,b,c){return this.d.rc(a,b,c)};u.Wc=function(a,b,c){return this.d.sc(a,b,c)};u.map=function(a,b){return this.d.map(a,b)};
u.reduce=function(a,b,c){return this.d.reduce(a,b,c)};function Gf(a,b,c){Df.call(this,a,b,c)}F(Gf,Ff);Gf.prototype.Bb=function(a){var b=this.m();if("indexeddb"==b)return new af(this.e,this.b,a);if("websql"==b)return new ef(this.e,this.b,a);if("memory"==b||"localstorage"==b||"sessionstorage"==b)return new ff(this.e,this.b,a);k(new Sc("No executor for "+b))};Gf.prototype.Na=function(a,b,c){return new gf(this,this.b,c||"",a)};Gf.prototype.executeSql=function(a,b){return this.d.executeSql(a,b)};function Hf(a,b,c){Df.call(this,a,b,c)}F(Hf,Gf);function If(a,b){Le.call(this,a,b)}F(If,Le);If.prototype.b=ba(s);If.prototype.d=function(a,b){function c(b){x(a[b])?(e=s,d[b]=p):(d[b]=s,0<=b-1&&c(b-1))}var d=[],e=p;c(a.length-1);e&&(d=[]);var f;a:{f=d;var g,h=g!=q;if(!x(g)){g=b[0];for(var h=g!=q,j=1;h&&j<b.length;j++)if(b[j]==q||0!=Oc(b[j],g))h=s}if(h&&(this.f++,this.a&&this.a.push(g),x(this.j)&&this.f>=this.j)){f=[];break a}}return f};function Jf(a,b){Le.call(this,a,b);this.e=a instanceof He&&!!a.za}F(Jf,Le);Jf.prototype.m=T("ydn.db.algo.ZigzagMerge");Jf.prototype.e=s;Jf.prototype.b=function(a,b){var c=Jf.L.b.call(this,a,b);if(this.e){var d=a[0].va().split(", ");1<d.length?d[d.length-1]!=this.a.za&&k(new Pc("Output streamer projection field must be same as postfix field in the iterator")):O(this.m,"Unable to check correctness of output streamer.")}return c};
Jf.prototype.d=function(a,b){function c(a,b){var c=a.slice(0,a.length-1);c.push(b);return c}var d=[];if(0==a.length||a[0]==q||a[0]==q)return[];for(var e=p,f=0,g=a[f][a[f].length-1],h=[],j=1;j<a.length;j++)if(a[j]!=q){var m=a[j][a[j].length-1],n=Oc(g,m);h[j]=n;1===n?e=s:-1===n&&(e=s,g=m,f=1)}else return[];if(e){for(e=0;e<a.length;e++)a[e]!=q&&(d[e]=p);this.a&&(this.e?this.a.push(b[0],g):this.a.push(b[0]));return d}if(0==f)for(e=1;e<a.length;e++)1===h[e]&&(d[e]=c(a[e],g));else for(e=0;e<a.length;e++)e!=
f&&a[e]!=q&&1===Oc(g,a[e][a[e].length-1])&&(d[e]=c(a[e],g));return{"continue":d}};function Kf(a,b){Le.call(this,a,b)}F(Kf,Le);Kf.prototype.b=ba(s);Kf.prototype.d=function(a,b){var c=[],d=b[0];if(d==q)return[];for(var e=p,f=s,g=d,h=[],j=1;j<a.length;j++)if(b[j]!=q){var m=Oc(d,b[j]);h[j]=m;1===m?e=s:-1===m&&(e=s,f=p,1===Oc(b[j],g)&&(g=b[j]))}else e=s,f=p;if(e)for(f=0;f<a.length;f++)b[f]!=q&&(c[f]=p);else if(f)for(f=0;f<a.length;f++)b[f]!=q&&1===Oc(g,b[f])&&(c[f]=g);else for(f=1;f<a.length;f++)1===h[f]&&(c[f]=d);return e?(this.f++,this.a&&this.a.push(g),c):{continuePrimary:c}};E("ydn.db.Storage",Hf);E("ydn.db.algo.NestedLoop",If);E("ydn.db.algo.ZigzagMerge",Jf);E("ydn.db.algo.SortedMerge",Kf);L.prototype.done=L.prototype.ga;L.prototype.fail=L.prototype.Qb;L.prototype.then=L.prototype.G;L.prototype.always=L.prototype.wc;Gd.prototype.addEventListener=Gd.prototype.addEventListener;E("ydn.db.con.Storage",Z);Z.prototype.onReady=Z.prototype.w;Z.prototype.getType=Z.prototype.m;Z.prototype.setName=Z.prototype.Z;Z.prototype.getName=Z.prototype.getName;Z.prototype.getSchema=Z.prototype.Ec;Z.prototype.transaction=Z.prototype.transaction;Z.prototype.close=Z.prototype.eb;E("ydn.db.version","0.4.2");
E("ydn.db.deleteDatabase",function(a,b){ue&&((!b||"indexeddb"==b)&&ue&&"deleteDatabase"in ue)&&ue.deleteDatabase(a);if(ha(w.openDatabase)&&(!b||"websql"==b)){var c=new ve,d=new xe;Q(c.p,"deleting websql database: "+a);var d=c.Aa(a,d),e=function(){c.p.log(tc,"all tables in "+a+" deleted.",l)};d.ga(function(){c.Wa(function(b){c.$(function(d){var e=d.stores.length;if(0<e)for(var f=0;f<e;f++){var n=d.b(f);R(c.p,"deleting table: "+n.getName());b.executeSql("DROP TABLE "+Ud(n))}else c.p.log(tc,"no table to delete in "+
a,l)},b)},[],Cb,e)});d.Qb(function(){O(c.p,"Connecting "+a+" failed.")})}if(!b||"localstorage"==b){var d=new lf,f=new xe;d.Aa(a,f);Md(d)}if(!b||"sessionstorage"==b)d=new mf,f=new xe,d.Aa(a,f),Md(d)});of.prototype.name=of.prototype.name;of.prototype.getVersion=of.prototype.Uc;of.prototype.getOldVersion=of.prototype.Cc;of.prototype.getError=of.prototype.Tc;Df.prototype.branch=Df.prototype.Pb;Df.prototype.run=Df.prototype.Hc;ye.prototype.abort=ye.prototype.abort;Df.prototype.abort=Df.prototype.abort;E("ydn.db.core.Storage",$);$.prototype.branch=$.prototype.Pb;$.prototype.add=$.prototype.kb;$.prototype.get=$.prototype.Da;$.prototype.values=$.prototype.F;$.prototype.put=$.prototype.Ea;$.prototype.clear=$.prototype.clear;$.prototype.remove=$.prototype.lb;$.prototype.count=$.prototype.Ca;ze.prototype.add=ze.prototype.kb;ze.prototype.get=ze.prototype.Da;ze.prototype.values=ze.prototype.F;ze.prototype.put=ze.prototype.Ea;ze.prototype.clear=ze.prototype.clear;ze.prototype.remove=ze.prototype.lb;
ze.prototype.count=ze.prototype.Ca;E("ydn.db.cmp",Oc);E("ydn.db.Key",$c);$c.prototype.id=$c.prototype.Bc;$c.prototype.parent=$c.prototype.Pc;$c.prototype.storeName=$c.prototype.Qc;E("ydn.db.KeyRange",G);G.upperBound=function(a,b){return new G(l,a,l,b)};G.lowerBound=function(a,b){return new G(a,l,b,l)};G.bound=ra;G.only=function(a){return new G(a,a,s,s)};G.starts=sa;nf.prototype.store_name=nf.prototype.e;nf.prototype.getStoreName=nf.prototype.j;De.prototype.name=De.prototype.name;
De.prototype.getKey=De.prototype.f;De.prototype.getValue=De.prototype.m;Be.prototype.name=Be.prototype.name;Be.prototype.getKeys=Be.prototype.Za;Be.prototype.getValues=Be.prototype.f;Ff.prototype.scan=Ff.prototype.Wc;Ff.prototype.map=Ff.prototype.map;Ff.prototype.reduce=Ff.prototype.reduce;Ff.prototype.open=Ff.prototype.Vc;Te.prototype.scan=Te.prototype.sc;Te.prototype.map=Te.prototype.map;Te.prototype.reduce=Te.prototype.reduce;Te.prototype.open=Te.prototype.rc;Ke.prototype.key=Ke.prototype.Mb;Me.prototype.primaryKey=Me.prototype.l;Me.prototype.value=Me.prototype.fa;Me.prototype.update=Me.prototype.Nb;Me.prototype.clear=Me.prototype.clear;Oe.prototype.primaryKey=Oe.prototype.l;
Oe.prototype.value=Oe.prototype.fa;Oe.prototype.update=Oe.prototype.Nb;Oe.prototype.clear=Oe.prototype.clear;E("ydn.math.Expression",Ue);Ue.prototype.evaluate=Ue.prototype.b;Ue.prototype.compile=Ue.prototype.d;Ue.parseRpn=function(a){return new Ue(a.match(/[^\s"']+|"[^"]*"|'[^']*'/g))};Ue.parseInfix=function(){k(new dd("Too lazy to learn Dutch in Shunting Yard station, we speak Polish here."))};E("ydn.db.Iterator",W);E("ydn.db.KeyCursors",Hc);E("ydn.db.ValueCursors",Jc);E("ydn.db.Cursors",Ic);
E("ydn.db.IndexValueCursors",Kc);W.prototype.count=W.prototype.Jc;W.prototype.done=W.prototype.Ac;W.prototype.getKeyRange=W.prototype.lc;W.prototype.getIndexName=W.prototype.va;W.prototype.getStoreName=W.prototype.Lc;W.prototype.isReversed=W.prototype.mc;W.prototype.isUnique=W.prototype.Nc;W.prototype.isKeyOnly=W.prototype.Mc;W.prototype.primaryKey=W.prototype.l;W.prototype.key=W.prototype.Kc;W.prototype.resume=W.prototype.Gc;W.prototype.reset=W.prototype.Oc;
Hc.where=function(a,b,c,d,e){return new Hc(a,ya(b,c,d,e))};Jc.where=function(a,b,c,d,e){return new Jc(a,ya(b,c,d,e))};Ic.where=function(a,b,c,d,e,f){return new Ic(a,b,ya(c,d,e,f))};Kc.where=function(a,b,c,d,e,f){return new Kc(a,b,ya(c,d,e,f))};E("ydn.db.Streamer",He);He.prototype.push=He.prototype.push;He.prototype.collect=He.prototype.zc;He.prototype.setSink=He.prototype.ic;var Lf=new function(){this.a=pa()};function Mf(a){this.e=a||"";this.f=Lf}Mf.prototype.a=p;Mf.prototype.b=s;function Nf(a){a=new Date(a.j);return Of(a.getFullYear()-2E3)+Of(a.getMonth()+1)+Of(a.getDate())+" "+Of(a.getHours())+":"+Of(a.getMinutes())+":"+Of(a.getSeconds())+"."+Of(Math.floor(a.getMilliseconds()/10))}function Of(a){return 10>a?"0"+a:String(a)}function Pf(a,b){var c=(a.j-b)/1E3,d=c.toFixed(3),e=0;if(1>c)e=2;else for(;100>c;)e++,c*=10;for(;0<e--;)d=" "+d;return d}function Qf(a){Mf.call(this,a)}F(Qf,Mf);Qf.prototype.b=p;
Qf.prototype.d=function(a){var b;switch(a.f.value){case qc.value:b="dbg-sh";break;case rc.value:b="dbg-sev";break;case sc.value:b="dbg-w";break;case tc.value:b="dbg-i";break;default:b="dbg-f"}var c=[];c.push(this.e," ");this.a&&c.push("[",Nf(a),"] ");c.push("[",Ha(Pf(a,this.f.a)),"s] ");c.push("[",Ba(a.d),"] ");c.push('<span class="',b,'">',Aa(Ha(Ba(a.e))));this.b&&a.b&&c.push("<br>",Aa(Ha(a.a||"")));c.push("</span><br>");return c.join("")};function Rf(a){Mf.call(this,a)}F(Rf,Mf);
Rf.prototype.d=function(a){var b=[];b.push(this.e," ");this.a&&b.push("[",Nf(a),"] ");b.push("[",Pf(a,this.f.a),"s] ");b.push("[",a.d,"] ");b.push(a.e,"\n");this.b&&a.b&&b.push(a.a,"\n");return b.join("")};function Sf(){this.f=na(this.j,this);this.a=new Rf;this.a.a=s;this.b=this.a.b=s;this.d="";this.e={}}Sf.prototype.j=function(a){if(!this.e[a.d]){var b=this.a.d(a),c=Tf;if(c)switch(a.f){case qc:Uf(c,"info",b);break;case rc:Uf(c,"error",b);break;case sc:Uf(c,"warn",b);break;default:Uf(c,"debug",b)}else window.opera?window.opera.postError(b):this.d+=b}};var Tf=window.console;function Uf(a,b,c){if(a[b])a[b](c);else a.log(c)};var Vf,Wf=!Ub||Ub&&9<=gc;!Vb&&!Ub||Ub&&Ub&&9<=gc||Vb&&ec("1.9.1");Ub&&ec("9");function Xf(a,b){var c;c=a.className;c=A(c)&&c.match(/\S+/g)||[];for(var d=lb(arguments,1),e=c.length+d.length,f=c,g=0;g<d.length;g++)0<=xa(f,d[g])||f.push(d[g]);a.className=c.join(" ");return c.length==e};var Yf={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function Zf(a){this.a=a||w.document||document}function $f(a,b){var c;c=a.a;var d=b&&"*"!=b?b.toUpperCase():"";c.querySelectorAll&&c.querySelector&&d?c=c.querySelectorAll(d+""):c=c.getElementsByTagName(d||"*");return c}
Zf.prototype.b=function(a,b,c){var d=this.a,e=arguments,f=e[0],g=e[1];if(!Wf&&g&&(g.name||g.type)){f=["<",f];g.name&&f.push(' name="',Ba(g.name),'"');if(g.type){f.push(' type="',Ba(g.type),'"');var h={};Ib(h,g);delete h.type;g=h}f.push(">");f=f.join("")}f=d.createElement(f);if(g)if(A(g))f.className=g;else if(y(g))Xf.apply(q,[f].concat(g));else{var j=f;Fb(g,function(a,b){"style"==b?j.style.cssText=a:"class"==b?j.className=a:"for"==b?j.htmlFor=a:b in Yf?j.setAttribute(Yf[b],a):0==b.lastIndexOf("aria-",
0)||0==b.lastIndexOf("data-",0)?j.setAttribute(b,a):j[b]=a})}if(2<e.length)for(var m=d,n=f,d=e,e=function(a){a&&n.appendChild(A(a)?m.createTextNode(a):a)},g=2;g<d.length;g++)if(h=d[g],ea(h)&&!(C(h)&&0<h.nodeType)){var r=bb,v;a:{if((v=h)&&"number"==typeof v.length){if(C(v)){v="function"==typeof v.item||"string"==typeof v.item;break a}if(ha(v)){v="function"==typeof v.item;break a}}v=s}r(v?ib(h):h,e)}else e(h);return f};
Zf.prototype.contains=function(a,b){if(a.contains&&1==b.nodeType)return a==b||a.contains(b);if("undefined"!=typeof a.compareDocumentPosition)return a==b||Boolean(a.compareDocumentPosition(b)&16);for(;b&&a!=b;)b=b.parentNode;return b==a};function ag(a){this.f=na(this.j,this);this.b=new Qf;this.d=this.b.a=s;this.a=a;this.e=this.a.ownerDocument||this.a.document;var b=(a=this.a)?new Zf(9==a.nodeType?a:a.ownerDocument||a.document):Vf||(Vf=new Zf),c=q;Ub?(a=c=b.a.createStyleSheet(),Ub?a.cssText=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}":
a.innerHTML=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}"):(a=$f(b,"head")[0],a||(c=$f(b,"body")[0],a=b.b("head"),c.parentNode.insertBefore(a,c)),b=c=b.b("style"),Ub?b.cssText=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}":
b.innerHTML=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}",a.appendChild(c));this.a.className+=" logdiv"}
ag.prototype.j=function(a){var b=100>=this.a.scrollHeight-this.a.scrollTop-this.a.clientHeight,c=this.e.createElement("div");c.className="logmsg";c.innerHTML=this.b.d(a);this.a.appendChild(c);b&&(this.a.scrollTop=this.a.scrollHeight)};ag.prototype.clear=function(){this.a.innerHTML=""};var bg=q,cg=q;E("ydn.debug.log",function(a,b,c){if(B(b))b=new pc("log",b);else if(A(b)){b=b.toUpperCase();if(!zc){zc={};for(var d=0,e;e=yc[d];d++)zc[e.value]=e,zc[e.name]=e}b=zc[b]||q}else b=vc;T(a||"ydn").b=b;x(c)?cg||(a=cg=new ag(c),p!=a.d&&(c=Gc(),b=a.f,c.a||(c.a=[]),c.a.push(b),a.d=p),Gc().b=sc):!bg&&!cg&&(a=bg=new Sf,p!=a.b&&(c=Gc(),b=a.f,c.a||(c.a=[]),c.a.push(b),a.b=p),Gc().b=sc)});Z.prototype.db=Z.prototype.Rc;})();

            //@ sourceMappingURL=zvx-ydn.db-dev.js.map
        