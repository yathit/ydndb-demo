(function (name, definition, context) {if (typeof context['module'] !== 'undefined' && context['module']['exports']) {context['module']['exports'] = definition.apply(context);}else if (typeof context['define'] !== 'undefined' && context['define'] === 'function' && context['define']['amd']) {define(name, [], definition);}else {context[name] = definition();}})('ydn', function () {var l,r=this;function t(a){return void 0!==a}function aa(a){a=a.split(".");for(var b=r,c;c=a.shift();)if(null!=b[c])b=b[c];else return null;return b}
function ba(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function v(a){return"array"==ba(a)}function w(a){var b=ba(a);return"array"==b||"object"==b&&"number"==typeof a.length}function x(a){return"string"==typeof a}function da(a){return"boolean"==typeof a}function y(a){return"number"==typeof a}function ea(a){return"function"==ba(a)}function z(a){var b=typeof a;return"object"==b&&null!=a||"function"==b}var fa="closure_uid_"+(1E9*Math.random()>>>0),ga=0;
function ha(a,b,c){return a.call.apply(a.bind,arguments)}function ia(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function ka(a,b,c){ka=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ha:ia;return ka.apply(null,arguments)}
function la(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=c.slice();b.push.apply(b,arguments);return a.apply(this,b)}}var ma=Date.now||function(){return+new Date};function na(a,b){var c=a.split("."),d=r;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&t(b)?d[e]=b:d[e]?d=d[e]:d=d[e]={}}
function C(a,b){function c(){}c.prototype=b.prototype;a.D=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.Vc=function(a,c,f){for(var g=Array(arguments.length-2),h=2;h<arguments.length;h++)g[h-2]=arguments[h];return b.prototype[c].apply(a,g)}};function oa(a){a.prototype.then=a.prototype.then;a.prototype.$goog_Thenable=!0}function pa(a){if(!a)return!1;try{return!!a.$goog_Thenable}catch(b){return!1}};function qa(a){if(Error.captureStackTrace)Error.captureStackTrace(this,qa);else{var b=Error().stack;b&&(this.stack=b)}a&&(this.message=String(a))}C(qa,Error);qa.prototype.name="CustomError";var ra;function sa(a,b){for(var c=a.split("%s"),d="",e=Array.prototype.slice.call(arguments,1);e.length&&1<c.length;)d+=c.shift()+e.shift();return d+c.join("%s")}function ta(a){return/^[\s\xa0]*$/.test(a)}var va=String.prototype.trim?function(a){return a.trim()}:function(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")};
function wa(a){if(!xa.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(ya,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(za,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(Aa,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(Ba,"&quot;"));-1!=a.indexOf("'")&&(a=a.replace(Ca,"&#39;"));-1!=a.indexOf("\x00")&&(a=a.replace(Da,"&#0;"));return a}var ya=/&/g,za=/</g,Aa=/>/g,Ba=/"/g,Ca=/'/g,Da=/\x00/g,xa=/[\x00&<>"']/;
function Ea(a,b){for(var c=b.length,d=0;d<c;d++){var e=1==c?b:b.charAt(d);if(a.charAt(0)==e&&a.charAt(a.length-1)==e)return a.substring(1,a.length-1)}return a}var Fa={"\x00":"\\0","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\x0B",'"':'\\"',"\\":"\\\\"},Ga={"'":"\\'"};
function Ha(a){a=String(a);if(a.quote)return a.quote();for(var b=['"'],c=0;c<a.length;c++){var d=a.charAt(c),e=d.charCodeAt(0),f=c+1,g;if(!(g=Fa[d])){if(!(31<e&&127>e))if(d in Ga)d=Ga[d];else if(d in Fa)d=Ga[d]=Fa[d];else{e=d;g=d.charCodeAt(0);if(31<g&&127>g)e=d;else{if(256>g){if(e="\\x",16>g||256<g)e+="0"}else e="\\u",4096>g&&(e+="0");e+=g.toString(16).toUpperCase()}d=Ga[d]=e}g=d}b[f]=g}b.push('"');return b.join("")}function Ia(a,b){return a<b?-1:a>b?1:0};function Ja(a,b){b.unshift(a);qa.call(this,sa.apply(null,b));b.shift()}C(Ja,qa);Ja.prototype.name="AssertionError";function Ka(a,b){throw new Ja("Failure"+(a?": "+a:""),Array.prototype.slice.call(arguments,1));};var La=Array.prototype,Ma=La.indexOf?function(a,b,c){return La.indexOf.call(a,b,c)}:function(a,b,c){c=null==c?0:0>c?Math.max(0,a.length+c):c;if(x(a))return x(b)&&1==b.length?a.indexOf(b,c):-1;for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},Na=La.forEach?function(a,b,c){La.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=x(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},Oa=La.map?function(a,b,c){return La.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=
x(a)?a.split(""):a,g=0;g<d;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e},Pa=La.some?function(a,b,c){return La.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=x(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return!0;return!1},Qa=La.every?function(a,b,c){return La.every.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=x(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&!b.call(c,e[f],f,a))return!1;return!0};function Ra(a,b){var c=Sa(a,b,void 0);return 0>c?null:x(a)?a.charAt(c):a[c]}
function Sa(a,b,c){for(var d=a.length,e=x(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return f;return-1}function Ta(a){if(!v(a))for(var b=a.length-1;0<=b;b--)delete a[b];a.length=0}function Ua(a,b){var c=Ma(a,b),d;(d=0<=c)&&La.splice.call(a,c,1);return d}function Va(a){var b=a.length;if(0<b){for(var c=Array(b),d=0;d<b;d++)c[d]=a[d];return c}return[]}
function Wa(a,b){for(var c=1;c<arguments.length;c++){var d=arguments[c];if(w(d)){var e=a.length||0,f=d.length||0;a.length=e+f;for(var g=0;g<f;g++)a[e+g]=d[g]}else a.push(d)}}function Xa(a,b,c,d){La.splice.apply(a,Ya(arguments,1))}function Ya(a,b,c){return 2>=arguments.length?La.slice.call(a,b):La.slice.call(a,b,c)}function Za(a,b){if(!w(a)||!w(b)||a.length!=b.length)return!1;for(var c=a.length,d=$a,e=0;e<c;e++)if(!d(a[e],b[e]))return!1;return!0}function ab(a,b){return a>b?1:a<b?-1:0}
function $a(a,b){return a===b}function bb(a,b){var c;c=cb||ab;for(var d=0,e=a.length,f;d<e;){var g=d+e>>1,h;h=c(b,a[g]);0<h?d=g+1:(e=g,f=!h)}c=f?d:~d;0>c&&Xa(a,-(c+1),0,b)};var db;a:{var eb=r.navigator;if(eb){var fb=eb.userAgent;if(fb){db=fb;break a}}db=""}function gb(a){return-1!=db.indexOf(a)};function hb(a,b){for(var c in a)b.call(void 0,a[c],c,a)}function ib(a,b){for(var c=w(b),d=c?b:arguments,c=c?0:1;c<d.length&&(a=a[d[c]],t(a));c++);return a}var jb="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function kb(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<jb.length;f++)c=jb[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}}
function lb(a){var b=arguments.length;if(1==b&&v(arguments[0]))return lb.apply(null,arguments[0]);for(var c={},d=0;d<b;d++)c[arguments[d]]=!0;return c};function mb(a){r.setTimeout(function(){throw a;},0)}var nb;
function ob(){var a=r.MessageChannel;"undefined"===typeof a&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&(a=function(){var a=document.createElement("iframe");a.style.display="none";a.src="";document.documentElement.appendChild(a);var b=a.contentWindow,a=b.document;a.open();a.write("");a.close();var c="callImmediate"+Math.random(),d="file:"==b.location.protocol?"*":b.location.protocol+"//"+b.location.host,a=ka(function(a){if(("*"==d||a.origin==d)&&a.data==c)this.port1.onmessage()},
this);b.addEventListener("message",a,!1);this.port1={};this.port2={postMessage:function(){b.postMessage(c,d)}}});if("undefined"!==typeof a&&!gb("Trident")&&!gb("MSIE")){var b=new a,c={},d=c;b.port1.onmessage=function(){if(t(c.next)){c=c.next;var a=c.bc;c.bc=null;a()}};return function(a){d.next={bc:a};d=d.next;b.port2.postMessage(0)}}return"undefined"!==typeof document&&"onreadystatechange"in document.createElement("script")?function(a){var b=document.createElement("script");b.onreadystatechange=function(){b.onreadystatechange=
null;b.parentNode.removeChild(b);b=null;a();a=null};document.documentElement.appendChild(b)}:function(a){r.setTimeout(a,0)}};function pb(a,b){qb||rb();sb||(qb(),sb=!0);tb.push(new ub(a,b))}var qb;function rb(){if(r.Promise&&r.Promise.resolve){var a=r.Promise.resolve();qb=function(){a.then(wb)}}else qb=function(){var a=wb;!ea(r.setImmediate)||r.Window&&r.Window.prototype.setImmediate==r.setImmediate?(nb||(nb=ob()),nb(a)):r.setImmediate(a)}}var sb=!1,tb=[];[].push(function(){sb=!1;tb=[]});function wb(){for(;tb.length;){var a=tb;tb=[];for(var b=0;b<a.length;b++){var c=a[b];try{c.a.call(c.b)}catch(d){mb(d)}}}sb=!1}
function ub(a,b){this.a=a;this.b=b};function xb(a,b){this.b=yb;this.h=void 0;this.a=this.c=null;this.f=this.g=!1;try{var c=this;a.call(b,function(a){zb(c,Ab,a)},function(a){if(!(a instanceof Bb))try{if(a instanceof Error)throw a;throw Error("Promise rejected.");}catch(b){}zb(c,Cb,a)})}catch(d){zb(this,Cb,d)}}var yb=0,Ab=2,Cb=3;xb.prototype.then=function(a,b,c){return Eb(this,ea(a)?a:null,ea(b)?b:null,c)};oa(xb);function Fb(a){a.b==yb&&pb(function(){var a=new Bb(void 0);Gb(this,a)},a)}
function Gb(a,b){if(a.b==yb)if(a.c){var c=a.c;if(c.a){for(var d=0,e=-1,f=0,g;g=c.a[f];f++)if(g=g.Ha)if(d++,g==a&&(e=f),0<=e&&1<d)break;0<=e&&(c.b==yb&&1==d?Gb(c,b):(d=c.a.splice(e,1)[0],Hb(c,d,Cb,b)))}}else zb(a,Cb,b)}function Ib(a,b){a.a&&a.a.length||a.b!=Ab&&a.b!=Cb||Jb(a);a.a||(a.a=[]);a.a.push(b)}
function Eb(a,b,c,d){var e={Ha:null,kc:null,lc:null};e.Ha=new xb(function(a,g){e.kc=b?function(c){try{var e=b.call(d,c);a(e)}catch(m){g(m)}}:a;e.lc=c?function(b){try{var e=c.call(d,b);!t(e)&&b instanceof Bb?g(b):a(e)}catch(m){g(m)}}:g});e.Ha.c=a;Ib(a,e);return e.Ha}xb.prototype.i=function(a){this.b=yb;zb(this,Ab,a)};xb.prototype.l=function(a){this.b=yb;zb(this,Cb,a)};
function zb(a,b,c){if(a.b==yb){if(a==c)b=Cb,c=new TypeError("Promise cannot resolve to itself");else{if(pa(c)){a.b=1;c.then(a.i,a.l,a);return}if(z(c))try{var d=c.then;if(ea(d)){Kb(a,c,d);return}}catch(e){b=Cb,c=e}}a.h=c;a.b=b;Jb(a);b!=Cb||c instanceof Bb||Lb(a,c)}}function Kb(a,b,c){function d(b){f||(f=!0,a.l(b))}function e(b){f||(f=!0,a.i(b))}a.b=1;var f=!1;try{c.call(b,e,d)}catch(g){d(g)}}function Jb(a){a.g||(a.g=!0,pb(a.o,a))}
xb.prototype.o=function(){for(;this.a&&this.a.length;){var a=this.a;this.a=[];for(var b=0;b<a.length;b++)Hb(this,a[b],this.b,this.h)}this.g=!1};function Hb(a,b,c,d){if(c==Ab)b.kc(d);else{if(b.Ha)for(;a&&a.f;a=a.c)a.f=!1;b.lc(d)}}function Lb(a,b){a.f=!0;pb(function(){a.f&&Mb.call(null,b)})}var Mb=mb;function Bb(a){qa.call(this,a)}C(Bb,qa);Bb.prototype.name="cancel";/*
 Portions of this code are from MochiKit, received by
 The Closure Authors under the MIT license. All other code is Copyright
 2005-2009 The Closure Authors. All Rights Reserved.
*/
function D(a,b){this.l=[];this.R=b||null;this.b=this.c=!1;this.g=void 0;this.na=this.P=this.u=!1;this.i=0;this.f=null;this.K=0}l=D.prototype;l.cb=function(a,b){this.u=!1;Nb(this,a,b)};function Nb(a,b,c){a.c=!0;a.g=c;a.b=!b;a.Hb()}function Ob(a){if(a.c){if(!a.na)throw new Pb;a.na=!1}}l.callback=function(a){Ob(this);Nb(this,!0,a)};l.s=function(a){Ob(this);Nb(this,!1,a)};l.L=function(a,b){return Qb(this,a,null,b)};l.Yb=function(a,b){return Qb(this,null,a,b)};l.ya=function(a,b){return Qb(this,a,a,b)};
function Qb(a,b,c,d){a.l.push([b,c,d]);a.c&&a.Hb();return a}l.then=function(a,b,c){var d,e,f=new xb(function(a,b){d=a;e=b});Qb(this,d,function(a){e(a)});return f.then(a,b,c)};oa(D);D.prototype.Db=function(a){Qb(this,a.callback,a.s,a);return this};function Rb(a,b){b instanceof D?a.L(ka(b.ma,b)):a.L(function(){return b})}D.prototype.ma=function(a){var b=new D;this.Db(b);a&&(b.f=this,this.K++);return b};function Sb(a){return Pa(a.l,function(a){return ea(a[1])})}
D.prototype.Hb=function(){this.i&&this.c&&Sb(this)&&(Tb(this.i),this.i=0);this.f&&(this.f.K--,delete this.f);for(var a=this.g,b=!1,c=!1;this.l.length&&!this.u;){var d=this.l.shift(),e=d[0],f=d[1],d=d[2];if(e=this.b?f:e)try{var g=e.call(d||this.R,a);t(g)&&(this.b=this.b&&(g==a||g instanceof Error),this.g=a=g);pa(a)&&(this.u=c=!0)}catch(h){a=h,this.b=!0,Sb(this)||(b=!0)}}this.g=a;c&&(c=ka(this.cb,this,!0),g=ka(this.cb,this,!1),a instanceof D?(Qb(a,c,g),a.P=!0):a.then(c,g));b&&(a=new Wb(a),Xb[a.mb]=
a,this.i=a.mb)};function Yb(a){var b=new D;b.callback(a);return b}function Pb(){qa.call(this)}C(Pb,qa);Pb.prototype.message="Deferred has already fired";Pb.prototype.name="AlreadyCalledError";function Wb(a){this.mb=r.setTimeout(ka(this.b,this),0);this.a=a}Wb.prototype.b=function(){delete Xb[this.mb];window.console.error(this.a.stack);throw this.a;};var Xb={};function Tb(a){var b=Xb[a];b&&(r.clearTimeout(b.mb),delete Xb[a])};var Zb=lb("area base br col command embed hr img input keygen link meta param source track wbr".split(" "));function $b(){this.a="";this.b=ac}$b.prototype.sa=!0;$b.prototype.la=function(){return this.a};$b.prototype.toString=function(){return"Const{"+this.a+"}"};function bc(a){if(a instanceof $b&&a.constructor===$b&&a.b===ac)return a.a;Ka("expected object of type Const, got '"+a+"'");return"type_error:Const"}var ac={};function cc(a){var b=new $b;b.a=a;return b};function dc(){this.a="";this.b=ec}dc.prototype.sa=!0;var ec={};dc.prototype.la=function(){return this.a};dc.prototype.toString=function(){return"SafeStyle{"+this.a+"}"};function fc(a){var b=new dc;b.a=a;return b}var gc=fc(""),hc=/^[-.%_!# a-zA-Z0-9]+$/;function ic(){this.a="";this.b=jc}l=ic.prototype;l.sa=!0;l.la=function(){return this.a};l.Mb=!0;l.za=function(){return 1};l.toString=function(){return"SafeUrl{"+this.a+"}"};function kc(a){if(a instanceof ic&&a.constructor===ic&&a.b===jc)return a.a;Ka("expected object of type SafeUrl, got '"+a+"'");return"type_error:SafeUrl"}var lc=/^(?:(?:https?|mailto):|[^&:/?#]*(?:[/?#]|$))/i;
function mc(a){try{var b=encodeURI(a)}catch(c){return"about:invalid#zClosurez"}return b.replace(nc,function(a){return oc[a]})}var nc=/[()']|%5B|%5D|%25/g,oc={"'":"%27","(":"%28",")":"%29","%5B":"[","%5D":"]","%25":"%"},jc={};function pc(a){var b=new ic;b.a=a;return b};function qc(){this.a=rc}l=qc.prototype;l.sa=!0;l.la=function(){return""};l.Mb=!0;l.za=function(){return 1};l.toString=function(){return"TrustedResourceUrl{}"};var rc={};function sc(){this.a="";this.c=tc;this.b=null}l=sc.prototype;l.Mb=!0;l.za=function(){return this.b};l.sa=!0;l.la=function(){return this.a};l.toString=function(){return"SafeHtml{"+this.a+"}"};function uc(a){if(a instanceof sc&&a.constructor===sc&&a.c===tc)return a.a;Ka("expected object of type SafeHtml, got '"+a+"'");return"type_error:SafeHtml"}function vc(a){if(a instanceof sc)return a;var b=null;a.Mb&&(b=a.za());return wc(wa(a.sa?a.la():String(a)),b)}
function xc(a){if(a instanceof sc)return a;a=vc(a);var b;b=uc(a).replace(/  /g," &#160;").replace(/(\r\n|\r|\n)/g,"<br>");return wc(b,a.za())}var yc=/^[a-zA-Z0-9-]+$/,zc={action:!0,cite:!0,data:!0,formaction:!0,href:!0,manifest:!0,poster:!0,src:!0},Ac={embed:!0,iframe:!0,link:!0,object:!0,script:!0,style:!0,template:!0};
function Bc(a,b,c){if(!yc.test(a))throw Error("Invalid tag name <"+a+">.");if(a.toLowerCase()in Ac)throw Error("Tag name <"+a+"> is not allowed for SafeHtml.");var d=null,e="<"+a;if(b)for(var f in b){if(!yc.test(f))throw Error('Invalid attribute name "'+f+'".');var g=b[f];if(null!=g){var h,k=a;h=f;if(g instanceof $b)g=bc(g);else if("style"==h.toLowerCase()){if(!z(g))throw Error('The "style" attribute requires goog.html.SafeStyle or map of style properties, '+typeof g+" given: "+g);if(!(g instanceof
dc)){var k="",m=void 0;for(m in g){if(!/^[-_a-zA-Z0-9]+$/.test(m))throw Error("Name allows only [-_a-zA-Z0-9], got: "+m);var n=g[m];null!=n&&(n instanceof $b?n=bc(n):hc.test(n)||(Ka("String value allows only [-.%_!# a-zA-Z0-9], got: "+n),n="zClosurez"),k+=m+":"+n+";")}g=k?fc(k):gc}k=void 0;g instanceof dc&&g.constructor===dc&&g.b===ec?k=g.a:(Ka("expected object of type SafeStyle, got '"+g+"'"),k="type_error:SafeStyle");g=k}else{if(/^on/i.test(h))throw Error('Attribute "'+h+'" requires goog.string.Const value, "'+
g+'" given.');if(h.toLowerCase()in zc)if(g instanceof qc)g instanceof qc&&g.constructor===qc&&g.a===rc?g="":(Ka("expected object of type TrustedResourceUrl, got '"+g+"'"),g="type_error:TrustedResourceUrl");else if(g instanceof ic)g=kc(g);else throw Error('Attribute "'+h+'" on tag "'+k+'" requires goog.html.SafeUrl or goog.string.Const value, "'+g+'" given.');}g.sa&&(g=g.la());h=h+'="'+wa(String(g))+'"';e=e+(" "+h)}}t(c)?v(c)||(c=[c]):c=[];!0===Zb[a.toLowerCase()]?e+=">":(d=Cc(c),e+=">"+uc(d)+"</"+
a+">",d=d.za());(a=b&&b.dir)&&(/^(ltr|rtl|auto)$/i.test(a)?d=0:d=null);return wc(e,d)}function Cc(a){function b(a){v(a)?Na(a,b):(a=vc(a),d+=uc(a),a=a.za(),0==c?c=a:0!=a&&c!=a&&(c=null))}var c=0,d="";Na(arguments,b);return wc(d,c)}var tc={};function wc(a,b){var c=new sc;c.a=a;c.b=b;return c}var Dc=wc("",0);var Ec="StopIteration"in r?r.StopIteration:Error("StopIteration");function Fc(){}Fc.prototype.next=function(){throw Ec;};Fc.prototype.Cb=function(){return this};function Gc(a){if(a instanceof Fc)return a;if("function"==typeof a.Cb)return a.Cb(!1);if(w(a)){var b=0,c=new Fc;c.next=function(){for(;;){if(b>=a.length)throw Ec;if(b in a)return a[b++];b++}};return c}throw Error("Not implemented");}
function Hc(a,b){if(w(a))try{Na(a,b,void 0)}catch(c){if(c!==Ec)throw c;}else{a=Gc(a);try{for(;;)b.call(void 0,a.next(),void 0,a)}catch(d){if(d!==Ec)throw d;}}};function Ic(a,b){this.b={};this.a=[];this.f=this.c=0;var c=arguments.length;if(1<c){if(c%2)throw Error("Uneven number of arguments");for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else if(a){var e;if(a instanceof Ic)e=a.ra(),d=a.jb();else{var c=[],f=0;for(e in a)c[f++]=e;e=c;c=[];f=0;for(d in a)c[f++]=a[d];d=c}for(c=0;c<e.length;c++)this.set(e[c],d[c])}}l=Ic.prototype;l.Ib=function(){return this.c};
l.jb=function(){Jc(this);for(var a=[],b=0;b<this.a.length;b++)a.push(this.b[this.a[b]]);return a};l.ra=function(){Jc(this);return this.a.concat()};l.clear=function(){this.b={};this.f=this.c=this.a.length=0};
function Jc(a){if(a.c!=a.a.length){for(var b=0,c=0;b<a.a.length;){var d=a.a[b];Object.prototype.hasOwnProperty.call(a.b,d)&&(a.a[c++]=d);b++}a.a.length=c}if(a.c!=a.a.length){for(var e={},c=b=0;b<a.a.length;)d=a.a[b],Object.prototype.hasOwnProperty.call(e,d)||(a.a[c++]=d,e[d]=1),b++;a.a.length=c}}l.get=function(a,b){return Object.prototype.hasOwnProperty.call(this.b,a)?this.b[a]:b};l.set=function(a,b){Object.prototype.hasOwnProperty.call(this.b,a)||(this.c++,this.a.push(a),this.f++);this.b[a]=b};
l.forEach=function(a,b){for(var c=this.ra(),d=0;d<c.length;d++){var e=c[d],f=this.get(e);a.call(b,f,e,this)}};l.clone=function(){return new Ic(this)};l.Cb=function(a){Jc(this);var b=0,c=this.a,d=this.b,e=this.f,f=this,g=new Fc;g.next=function(){for(;;){if(e!=f.f)throw Error("The map has changed since the iterator was created");if(b>=c.length)throw Ec;var g=c[b++];return a?g:d[g]}};return g};var Kc=gb("Opera")||gb("OPR"),Lc=gb("Trident")||gb("MSIE"),Mc=gb("Gecko")&&-1==db.toLowerCase().indexOf("webkit")&&!(gb("Trident")||gb("MSIE")),Nc=-1!=db.toLowerCase().indexOf("webkit");Nc&&gb("Mobile");gb("Macintosh");gb("Windows");gb("Linux")||gb("CrOS");var Oc=r.navigator||null;Oc&&(Oc.appVersion||"").indexOf("X11");gb("Android");!gb("iPhone")||gb("iPod")||gb("iPad");gb("iPad");function Pc(){var a=r.document;return a?a.documentMode:void 0}
var Qc=function(){var a="",b;if(Kc&&r.opera)return a=r.opera.version,ea(a)?a():a;Mc?b=/rv\:([^\);]+)(\)|;)/:Lc?b=/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/:Nc&&(b=/WebKit\/(\S+)/);b&&(a=(a=b.exec(db))?a[1]:"");return Lc&&(b=Pc(),b>parseFloat(a))?String(b):a}(),Rc={};
function Sc(a){var b;if(!(b=Rc[a])){b=0;for(var c=va(String(Qc)).split("."),d=va(String(a)).split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",h=d[f]||"",k=RegExp("(\\d*)(\\D*)","g"),m=RegExp("(\\d*)(\\D*)","g");do{var n=k.exec(g)||["","",""],p=m.exec(h)||["","",""];if(0==n[0].length&&0==p[0].length)break;b=Ia(0==n[1].length?0:parseInt(n[1],10),0==p[1].length?0:parseInt(p[1],10))||Ia(0==n[2].length,0==p[2].length)||Ia(n[2],p[2])}while(0==b)}b=Rc[a]=0<=b}return b}
var Tc=r.document,Uc=Tc&&Lc?Pc()||("CSS1Compat"==Tc.compatMode?parseInt(Qc,10):5):void 0;function Vc(a){var b;b||(b=Wc(a||arguments.callee.caller,[]));return b}
function Wc(a,b){var c=[];if(0<=Ma(b,a))c.push("[...circular reference...]");else if(a&&50>b.length){c.push(Xc(a)+"(");for(var d=a.arguments,e=0;d&&e<d.length;e++){0<e&&c.push(", ");var f;f=d[e];switch(typeof f){case "object":f=f?"object":"null";break;case "string":break;case "number":f=String(f);break;case "boolean":f=f?"true":"false";break;case "function":f=(f=Xc(f))?f:"[fn]";break;default:f=typeof f}40<f.length&&(f=f.substr(0,40)+"...");c.push(f)}b.push(a);c.push(")\n");try{c.push(Wc(a.caller,
b))}catch(g){c.push("[exception trying to get caller]\n")}}else a?c.push("[...long stack...]"):c.push("[end]");return c.join("")}function Xc(a){if(Yc[a])return Yc[a];a=String(a);if(!Yc[a]){var b=/function ([^\(]+)/.exec(a);Yc[a]=b?b[1]:"[Anonymous]"}return Yc[a]}var Yc={};function Zc(a,b,c,d,e){"number"==typeof e||$c++;this.g=d||ma();this.f=a;this.c=b;this.b=c;delete this.a}Zc.prototype.a=null;var $c=0;function ad(a){this.g=a;this.a=this.f=this.b=this.c=null}function bd(a,b){this.name=a;this.value=b}bd.prototype.toString=function(){return this.name};var cd=new bd("SHOUT",1200),dd=new bd("SEVERE",1E3),ed=new bd("WARNING",900),fd=new bd("INFO",800),gd=new bd("CONFIG",700),hd=new bd("FINE",500),id=new bd("FINER",400),jd=new bd("FINEST",300),kd=[new bd("OFF",Infinity),cd,dd,ed,fd,gd,hd,id,jd,new bd("ALL",0)],ld=null;ad.prototype.getName=function(){return this.g};
function md(a){if(a.b)return a.b;if(a.c)return md(a.c);Ka("Root logger has no level set.");return null}ad.prototype.log=function(a,b,c){if(a.value>=md(this).value)for(ea(b)&&(b=b()),a=new Zc(a,String(b),this.g),c&&(a.a=c),c="log:"+a.c,r.console&&(r.console.timeStamp?r.console.timeStamp(c):r.console.markTimeline&&r.console.markTimeline(c)),r.msWriteProfilerMark&&r.msWriteProfilerMark(c),c=this;c;){b=c;var d=a;if(b.a)for(var e=0,f=void 0;f=b.a[e];e++)f(d);c=c.c}};var nd={},od=null;
function pd(){od||(od=new ad(""),nd[""]=od,od.b=gd)}function qd(){pd();return od}function E(a){pd();var b;if(!(b=nd[a])){b=new ad(a);var c=a.lastIndexOf("."),d=a.substr(c+1),c=E(a.substr(0,c));c.f||(c.f={});c.f[d]=b;b.c=c;nd[a]=b}return b};function rd(a,b,c){a&&a.log(b,c,void 0)}function sd(a,b){a&&a.log(dd,b,void 0)}function F(a,b){a&&a.log(ed,b,void 0)}function td(a,b){a&&a.log(hd,b,void 0)};function I(a,b){a&&a.log(jd,b,void 0)}function J(a,b){a&&a.log(id,b,void 0)};function K(a){qa.call(this,a);this.name="ydn.error.ArgumentException"}C(K,qa);function ud(a){qa.call(this,a);this.name="ydn.error.TypeError"}C(ud,qa);function vd(a){qa.call(this,a);this.name="ydn.error.NotSupportedException"}C(vd,qa);function wd(a){qa.call(this,a);this.name="ydn.error.NotImplementedException"}C(wd,qa);function xd(a){qa.call(this,a);this.name="ydn.error.InvalidOperationException"}C(xd,qa);
function yd(a){Error.captureStackTrace?Error.captureStackTrace(this,yd):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InternalError"}C(yd,Error);yd.prototype.name="ydn.error.InternalError";function zd(a,b){D.call(this,0,b);this.h=[]}C(zd,D);l=zd.prototype;l.$b=function(a,b){this.h.push([a,b]);return this};function Ad(a,b){for(var c=0;c<a.h.length;c++)a.h[c][0].call(a.h[c][1],b)}l.callback=function(a){this.h.length=0;zd.D.callback.call(this,a)};l.s=function(a){this.h.length=0;zd.D.s.call(this,a)};l.Db=function(a){zd.D.Db.call(this,a);a instanceof zd&&a.$b(function(a){Ad(this,a)},this);return this};l.Hc=function(){return this};var Bd={READ_ONLY:"readonly",READ_WRITE:"readwrite",VERSION_CHANGE:"versionchange"},Cd=Bd.READ_ONLY,L=Bd.READ_WRITE,Dd=Bd.VERSION_CHANGE,Ed=r.indexedDB||r.mozIndexedDB||r.webkitIndexedDB||r.moz_indexedDB||r.msIndexedDB;D.prototype.done=D.prototype.L;D.prototype.fail=D.prototype.Yb;D.prototype.always=D.prototype.ya;zd.prototype.then=zd.prototype.then;function Fd(a,b){var c,d;2==arguments.length&&x(arguments[1])?(c=!0,d=arguments[1].split(".")):d=(c=w(b))?b:arguments;for(c=c?0:1;c<d.length&&(a=a[d[c]],t(a));c++);return a}function Gd(a,b,c){if(a)if(-1==b.indexOf("."))a[b]=c;else{b=b.split(".");for(var d=b.pop(),e;e=b.shift();)z(a[e])||(a[e]={}),a=a[e];a[d]=c}}var Hd={};
function Id(a){a=[a];for(var b=new Jd,c=0,d,e;void 0!==(e=a.pop());){0===c%4&&12<c+4&&(b.write(c),c=0);d=typeof e;if(e instanceof Array)if(c+=4,0<e.length){a.push(Hd);for(d=e.length;d--;)a.push(e[d]);continue}else b.write(c);else if("number"===d)c+=1,b.write(c),Kd(b,e);else if(e instanceof Date)c+=2,b.write(c),Kd(b,e.valueOf());else if("string"===d){c+=3;b.write(c);c=b;for(d=0;d<e.length;d++){var f=e.charCodeAt(d);126>=f?c.write(f+1):16510>=f?(f-=127,c.write(128|f>>8,f&255)):c.write(192|f>>10,f>>
2|255,(f|3)<<6)}c.write(0)}else if(e===Hd)b.write(0);else return"";c=0}return b.trim().toString()}function Ld(a){for(var b=[],c=b,d=[],e,f,g=new Md(a);null!=Nd(g);)if(0===g.a)c=d.pop();else{if(null===g.a)break;do{e=g.a/4|0;a=g.a%4;for(var h=0;h<e;h++)f=[],c.push(f),d.push(c),c=f;if(0===a&&12<g.a+4)Nd(g);else break}while(1);1===a?c.push(Od(g)):2===a?c.push(new Date(Od(g))):3===a?c.push(Pd(g)):0===a&&(c=d.pop())}return b[0]}
function Kd(a,b){var c,d,e;c=b;var f=e=d=0;if(0!==c)if(isFinite(c)){0>c&&(d=1,c=-c);f=0;if(2.2250738585072014E-308<=c){for(e=c;1>e;)f--,e*=2;for(;2<=e;)f++,e/=2;e=f+1023}f=e?Math.floor(4503599627370496*(c/Math.pow(2,f)-1)):Math.floor(c/4.9E-324)}else e=2047,isNaN(c)?f=0x8000000000000:-Infinity===c&&(d=1);c=d;d=e;e=f;c&&(e=0xfffffffffffff-e,d=2047-d);a.write((c?0:128)|d>>4);a.write((d&15)<<4|0|e/281474976710656);e%=281474976710656;c=0|e/4294967296;a.write(c>>8,c&255);e%=4294967296;c=0|e/65536;a.write(c>>
8,c&255);c=e%65536;a.write(c>>8,c&255)}function Od(a){var b=Nd(a)|0,c=b>>7?!1:!0,d=c?-1:1,e=(b&127)<<4,b=Nd(a)|0,e=e+(b>>4);c&&(e=2047-e);for(var b=[c?15-(b&15):b&15],f=6;f--;)b.push(c?255-(Nd(a)|0):Nd(a)|0);a=0;for(f=7;f--;)a=a/256+b[f];a/=16;return 0===a&&0===e?0:(a+1)*Math.pow(2,e-1023)*d}
function Pd(a){for(var b=[],c=0,d=0,e=0,f,g;;){f=Nd(a);if(0===f||null==f)break;0===c?(g=f>>6,2>g&&!isNaN(f)?b.push(String.fromCharCode(f-1)):(c=g,d=f<<10,e++)):2===c?(b.push(String.fromCharCode(d+f+127)),c=d=e=0):2===e?(d+=f<<2,e++):(b.push(String.fromCharCode(d|f>>6)),c=d=e=0)}return b.join("")}function Md(a){this.a=null;this.b=a;this.c=this.b.length-1;this.index=-1}function Nd(a){return a.a=a.index<a.c?parseInt(a.b.charAt(++a.index)+a.b.charAt(++a.index),16):null}
function Jd(){this.a=[];this.b=void 0}Jd.prototype.write=function(a){for(var b=0;b<arguments.length;b++)this.b=arguments[b].toString(16),this.a.push(2===this.b.length?this.b:this.b="0"+this.b)};Jd.prototype.trim=function(){for(var a=this.a.length;"00"===this.a[--a];);this.a.length=++a;return this};Jd.prototype.toString=function(){return this.a.length?this.a.join(""):""};function Qd(a,b){var c=Id(a),d=Id(b);return c>d?1:c==d?0:-1};function Rd(a,b,c){zd.call(this,0,c);this.o=a;this.h=[];this.F=[];this.xa=[];this.a=null;this.Da="";this.V=0}C(Rd,zd);l=Rd.prototype;l.Da="";l.logger=E("ydn.db.Request");function Sd(a,b,c){a.a=b;a.Da=c;J(a.logger,a+" BEGIN");if(b){for(c=0;c<a.F.length;c++)a.F[c][0].call(a.F[c][1],b);a.F.length=0}}function Td(a){var b=new Rd(a.o);a.V++;Sd(b,a.a,a.Da+"C"+a.V);return b}function Ud(a){J(a.logger,a+" END");a.a=null}l.uc=function(){return!!this.a};
l.abort=function(){J(this.logger,this+" aborting "+this.a);if(this.a)if(ea(this.a.abort))this.a.abort();else if(ea(this.a.executeSql))this.a.executeSql("ABORT",[],function(){},function(){return!0});else throw new vd;else throw new Vd(this+" No active transaction");};function M(a,b,c){var d=a.xa.shift();c=!!c;d?d[0].call(d[1],b,c,function(b,c){M(a,b,c)}):c?a.s(b):a.callback(b)}function Wd(a,b,c){a.xa.push([b,c])}function N(a,b,c){a.a?b.call(c,a.a):a.F.push([b,c])}
l.callback=function(a){J(this.logger,this+" SUCCESS");Rd.D.callback.call(this,a)};l.s=function(a){J(this.logger,this+" ERROR");Rd.D.s.call(this,a)};l.state=function(){return this.c?this.b?"rejected":"resolved":"pending"};function O(a){var b="";a.Da&&(b=a.a?"*":"",b="["+a.Da+b+"]");return a.o+b}function Xd(a,b){var c=new Rd(a);M(c,b);return c}l.toString=function(){return"Request:"+O(this)};
l.Hb=function(){this.i&&this.c&&Sb(this)&&(Tb(this.i),this.i=0);this.f&&(this.f.K--,delete this.f);for(var a=this.g,b=!1;this.l.length&&!this.u;){var c=this.l.shift(),d=c[0],e=c[1],c=c[2];if(d=this.b?e:d)d=d.call(c||this.R,a),t(d)&&(this.b=this.b&&(d==a||d instanceof Error),this.g=a=d),pa(a)&&(this.u=b=!0)}this.g=a;b&&(b=ka(this.cb,this,!0),d=ka(this.cb,this,!1),a instanceof D?(Qb(a,b,d),a.P=!0):a.then(b,d))};
l.toJSON=function(){var a=(this.Da||"").match(/B(\d+)T(\d+)(?:Q(\d+?))?(?:R(\d+))?/)||[];return{method:this.o?this.o.split(":"):[],branchNo:parseFloat(a[1]),transactionNo:parseFloat(a[2]),queueNo:parseFloat(a[3]),requestNo:parseFloat(a[4])}};var Q=Ed&&Ed.cmp?ka(Ed.cmp,Ed):Qd,Yd=[];var Zd;Zd=!1;var $d=db;$d&&(-1!=$d.indexOf("Firefox")||-1!=$d.indexOf("Camino")||-1!=$d.indexOf("iPad")||-1!=$d.indexOf("iPhone")||-1!=$d.indexOf("iPod")||-1!=$d.indexOf("Chrome")||-1!=$d.indexOf("Android")||-1!=$d.indexOf("Safari")&&(Zd=!0));var ae=Zd;function be(){0!=ce&&(de[this[fa]||(this[fa]=++ga)]=this);this.ma=this.ma;this.na=this.na}var ce=0,de={};be.prototype.ma=!1;be.prototype.dc=function(){if(!this.ma&&(this.ma=!0,this.ja(),0!=ce)){var a=this[fa]||(this[fa]=++ga);delete de[a]}};be.prototype.ja=function(){if(this.na)for(;this.na.length;)this.na.shift()()};function ee(a,b){this.type=a;this.b=this.target=b;this.mc=!0}ee.prototype.preventDefault=function(){this.mc=!1};function fe(a,b){ee.call(this,a,b)}C(fe,ee);fe.prototype.j=function(){return this.H};function ge(a,b,c,d,e){ee.call(this,a,b);this.version=c;this.rc=d;this.jc=e}C(ge,fe);l=ge.prototype;l.name="ReadyEvent";l.version=NaN;l.rc=NaN;l.jc=null;l.Sc=function(){return this.version};l.wc=function(){return this.rc};l.vc=function(){return this.jc};function he(a,b,c){ee.call(this,c||"error",a);this.error=b}C(he,fe);he.prototype.toString=function(){return this.name+":"+(this.error?this.error:"")};
he.prototype.name="ErrorEvent";he.prototype.error=null;he.prototype.a=function(){return this.error};function ie(a,b){he.call(this,a,b,"fail")}C(ie,he);ie.prototype.name="FailEvent";function ke(a,b,c,d,e){ee.call(this,a,b);this.H=c;this.key=d;this.value=e}C(ke,fe);ke.prototype.name="RecordEvent";ke.prototype.a=function(){return this.key};ke.prototype.O=function(){return this.value};function le(a,b,c,d,e){ee.call(this,a,b);this.H=c;this.keys=d;this.values=e}C(le,fe);le.prototype.name="StoreEvent";
le.prototype.ra=function(){return this.keys};le.prototype.jb=function(){return this.values};function me(a,b,c){var d;if(z(a))d=a.store,b=a.id,null!=a.parent&&(c=new me(a.parent));else if(t(b))d=a;else if(d=a.lastIndexOf("^|"),b=a,0<d&&(b=a.substr(d),c=new me(a.substring(0,d))),b=b.split("^:"),d=b[0],b=b[1],!t(b))throw Error("Invalid key value: "+a);this.H=d;this.id=b;this.parent=c||null}l=me.prototype;l.toJSON=function(){var a={store:this.H,id:this.id};this.parent&&(a.parent=this.parent.toJSON());return a};
l.valueOf=function(){return(this.parent?this.parent.valueOf()+"^|":"")+this.H+"^:"+this.id};l.toString=function(){return this.valueOf().replace("^|","|").replace("^:",":")};l.j=function(){return this.H};l.G=function(){return this.id};function ne(a){return v(a.id)?a.id.join("^|"):a.id instanceof Date?+a.id:a.id}l.Lc=function(){return this.parent};function oe(a){return null!=a?y(a)||x(a)||a instanceof Date||v(a)&&Qa(a,oe):!1}
function pe(a){if(w(a)){for(var b=[],c=0,d=a.length;c<d;c++)b[c]=a[c];return b}return a};function R(a,b,c,d){a>b&&(b=a=void 0);null===a&&(a=void 0);null===b&&(b=void 0);this.lower=a;this.upper=b;this.lowerOpen=!!c;this.upperOpen=!!d}R.prototype.lower=void 0;R.prototype.upper=void 0;R.prototype.toJSON=function(){return qe(this)};function re(a){return se(a)}function te(a){return new R(a,a,!1,!1)}function ue(a,b,c,d){return new R(a,b,c,d)}function ve(a,b){return new R(void 0,a,void 0,!!b)}function we(a,b){return new R(a,void 0,!!b,void 0)}
function xe(a){var b;if(v(a))b=Va(a),b.push("\uffff");else if(x(a))b=a+"\uffff";else if(y(a))b=a+2.220460492503131E-16,a-=2.220460492503131E-16;else return te(a);return ue(a,b,!1,!0)}function qe(a){a=a||{};return{lower:a.lower,upper:a.upper,lowerOpen:a.lowerOpen,upperOpen:a.upperOpen}}
function se(a){return null!=a?null!=a.upper&&null!=a.lower?ye.bound(a.lower,a.upper,!!a.lowerOpen,!!a.upperOpen):null!=a.upper?ye.upperBound(a.upper,a.upperOpen):null!=a.lower?ye.lowerBound(a.lower,a.lowerOpen):null:null}function ze(a){if(a instanceof R)return"";if(null!=a){if(z(a)){for(var b in a){var c;if(c=a.hasOwnProperty(b))c=!(0<=Ma(["lower","upper","lowerOpen","upperOpen"],b));if(c)return'invalid attribute "'+b+'" in key range object'}return""}return"key range must be an object"}return""}
R.prototype.oa=function(a){var b=this.lower,c=this.upper,d=this.lowerOpen,e=this.upperOpen;null!=a.lower&&(null==this.lower||a.lower>=this.lower)&&(b=a.lower,d=a.lowerOpen||this.lowerOpen);null!=a.upper&&(null==this.upper||a.upper<=this.upper)&&(c=a.upper,e=a.upperOpen||this.upperOpen);return ue(b,c,d,e)};function Ae(a){if(!a)return"";var b=a.lowerOpen?"(":"[";null!=a.lower&&(b+=a.lower+", ");null!=a.upper&&(b+=a.upper);return b+=a.upperOpen?")":"]"}
function Be(a,b,c,d,e){if(c)if(c.lowerOpen||c.upperOpen||null==c.lower||null==c.upper||0!==Q(c.lower,c.upper)){if(null!=c.lower){var f=c.lowerOpen?" > ":" >= ";d.push(a+f+"?");e.push(Ce(c.lower,b))}null!=c.upper&&(f=c.upperOpen?" < ":" <= ",d.push(a+f+"?"),e.push(Ce(c.upper,b)))}else d.push(a+" = ?"),e.push(Ce(c.lower,b))}
function De(a,b,c,d){var e,f,g,h;if("starts"==a||"^"==a)return xe(b);if("<"==a||"<="==a)e=b,g="<"==a;else if(">"==a||">="==a)f=b,h=">"==a;else if("="==a||"=="==a)e=f=b;else throw new K("invalid op: "+a);if("<"==c||"<="==c)e=d,g="<"==c;else if(">"==c||">="==c)f=d,h=">"==c;else if(t(c))throw new K("invalid op2: "+c);return ue(f,e,h,g)}var ye=r.IDBKeyRange||r.webkitIDBKeyRange||R;function Ee(a,b,c,d,e,f){t(e)||(e=v(a)?a.join(", "):a);if(null!=a&&!x(a)&&!w(a))throw new K("index keyPath for "+e+" must be a string or array, but "+a+" is "+typeof a);v(a)&&Object.freeze&&Object.freeze(a);!t(a)&&t(e)&&(a=e);this.keyPath=a;this.h=w(this.keyPath);this.b=e;this.type=Fe(b);if(t(b)){if(!t(this.type))throw new K("type invalid in index: "+this.b);if(v(this.keyPath))throw new K('composite key for store "'+this.b+'" must not specified type');}this.unique=!!c;this.multiEntry=!!d;this.i=x(this.type)?
this.type:Ge;this.f=x(e)?e:v(a)?this.keyPath.join(","):a;this.c=Ha(this.f);this.a=this.h?null:this.keyPath.split(".");this.g=f||null}function He(a,b){if(null!=b){if(w(a.keyPath)){for(var c=[],d=0,e=a.keyPath.length;d<e;d++){var f=Fd(b,a.keyPath[d]);c[d]=f}return c}return Fd(b,a.keyPath)}}function Ie(a,b,c){for(var d=0;d<a.a.length;d++)d==a.a.length-1?b[a.a[d]]=c:z(b[a.a[d]])||(b[a.a[d]]={})}var Ge="TEXT";function Ce(a,b){if("DATE"==b){if(a instanceof Date)return+a}else return null!=b?a:Id(a)}
function Je(a,b){return"DATE"==b?new Date(a):t(b)?a:Ld(a)}var Ke=["BLOB","DATE","INTEGER","NUMERIC",Ge];function Fe(a){if(x(a))return a=Ma(Ke,a),Ke[a]}l=Ee.prototype;l.getName=function(){return this.b};l.toJSON=function(){return{name:this.b,keyPath:this.keyPath,type:this.type,unique:this.unique,multiEntry:this.multiEntry}};l.clone=function(){var a=v(this.keyPath)?Va(this.keyPath):this.keyPath;return new Ee(a,this.type,this.unique,this.multiEntry,this.b,this.g)};
function Le(a,b){return null!=a||null!=b?null!=a?null!=b?w(a)&&w(b)?Za(a,b)?null:"expect: "+a+", but: "+b:Me(a,b)?null:"expect: "+a+", but: "+b:"keyPath: "+a+" no longer defined":"newly define "+b:null}l.hint=function(a){if(!a)return this;var b=v(this.keyPath)?Va(this.keyPath):this.keyPath,c=this.type;t(a.type)||"TEXT"!=c||(c=void 0);return new Ee(b,c,this.unique,this.multiEntry,a.b)};
l.toString=function(){var a=this.multiEntry?"MultiEntry":"";this.a&&1<this.a.length&&(a+="Compound");return a+"Index:"+this.b};function Ne(a,b,c,d,e,f,g,h){if(!x(a))throw new K("store name must be a string");this.c=a;this.keyPath=t(b)?b:null;this.l=w(this.keyPath);if(null!==this.keyPath&&!x(this.keyPath)&&!this.l)throw new K("keyPath must be a string or array");if(null!=c&&!da(c))throw new K('invalid autoIncrement value in store "'+a+'"');this.b=!!c;var k;if(null!=d){k=Fe(d);if(!t(k))throw new K('type "'+d+'" for primary key in store "'+this.c+'" is invalid.');if(this.l)throw new K('composite key for store "'+this.c+'" must not specified type');
}this.type=null!=k?k:this.b?"INTEGER":void 0;this.h=x(this.keyPath)?this.keyPath.split("."):[];this.a=e||[];a=[];for(b=0;b<this.a.length;b++){c=this.a[b].getName();if(0<=a.indexOf(c))throw new K('index "'+c+'" already defined in store: '+this.c);a.push(c)}this.ea=!!f;this.wa=!!g;this.u=x(this.type)?this.type:Ge;this.g=v(this.keyPath)?this.keyPath.join(","):x(this.keyPath)?this.keyPath:"_ROWID_";this.f=Ha(this.g);if(this.o=!!h){if(this.keyPath)throw new K('encrypted store "'+this.c+'" must not use inline key');
if(this.b)throw new K('encrypted store "'+this.c+'" must not use key generator');}this.i=[]}l=Ne.prototype;l.ea=!1;l.wa=!1;l.toJSON=function(){for(var a=[],b=0;b<this.a.length;b++)a.push(this.a[b].toJSON());return{name:this.c,keyPath:this.keyPath,autoIncrement:this.b,type:this.type,indexes:a}};
function Oe(a){var b="name keyPath autoIncrement type indexes dispatchEvents fixed Sync encrypted".split(" "),c;for(c in a)if(a.hasOwnProperty(c)&&-1==Ma(b,c))throw new K('Unknown attribute "'+c+'"');b=[];c=a.indexes||[];if(v(c))for(var d=0;d<c.length;d++){var e;e=c[d];var f="name unique type keyPath multiEntry generator".split(" "),g=void 0;for(g in e)if(e.hasOwnProperty(g)&&-1==Ma(f,g))throw new K("Unknown field: "+g+" in "+S(e));e=new Ee(e.keyPath,e.type,e.unique,e.multiEntry,e.name,e.generator);
t(e.keyPath)&&e.keyPath===a.keyPath||b.push(e)}return new Ne(a.name,a.keyPath,a.autoIncrement,"undefined"===a.type||"null"===a.type?void 0:a.type,b,a.dispatchEvents,a.fixed,a.encrypted)}function Pe(a,b,c,d,e,f,g){a=Qe(a,b,c,d,e,f,g);b="";0!=c&&(b+="SELECT "+a.select);b+=" FROM "+a.aa;a.w&&(b+=" WHERE "+a.w);a.group&&(b+=" GROUP BY "+a.group);a.ca&&(b+=" ORDER BY "+a.ca);return b}
function Qe(a,b,c,d,e,f,g){var h={select:"",aa:"",w:"",group:"",ca:""},k=a.g,m=a.f,n=null;d!==k&&x(d)&&(n=Re(a,d));var p=!!n,q=d||k,u=Ha(q),A=p?n.type:a.type,B=p&&n.multiEntry;h.aa=Se(a);6===c?h.select="COUNT("+m+")":3===c||1===c||2===c?(h.select=m,null!=d&&d!=k&&(h.select+=", "+u)):h.select="*";d=g?"DISTINCT ":"";k=[];B?(B=Ha("ydn.db.me:"+a.getName()+":"+n.getName()),h.select=6===c?"COUNT("+d+B+"."+u+")":3===c||1===c||2===c?"DISTINCT "+Se(a)+"."+m+", "+B+"."+u+" AS "+q:"DISTINCT "+Se(a)+".*, "+B+
"."+u+" AS "+q,h.aa=B+" INNER JOIN "+Se(a)+" USING ("+m+")",null!=e&&(Be(B+"."+u,A,e,k,b),0<k.length&&(h.w=h.w?h.w+(" AND "+k.join(" AND ")):k.join(" AND ")))):null!=e&&(Be(u,A,e,k,b),0<k.length&&(h.w=h.w?h.w+(" AND "+k.join(" AND ")):k.join(" AND ")));p&&!n.unique&&g&&(h.group=u);a=f?"DESC":"ASC";h.ca=u+" "+a;p&&(h.ca+=", "+m+" "+a);return h}
function Te(a,b,c,d,e,f,g,h,k){var m,n,p,q;null!=e?(m=e.lower,n=e.upper,p=e.lowerOpen,q=e.upperOpen,f?null!=n?(e=Q(h,n),-1==e?(n=h,q=k):0==e&&(q=k||q)):(n=h,q=k):null!=m?(e=Q(h,m),1==e?(m=h,p=k):0==e&&(p=k||p)):(m=h,p=k)):f?(n=h,q=k):(m=h,p=k);e=new R(m,n,!!p,!!q);d=d?Re(a,d):null;b=Qe(a,c,b,d?d.f:a.g,e,f,g);b="SELECT "+b.select+" FROM "+b.aa+(b.w?" WHERE "+b.w:"")+(b.group?" GROUP BY "+b.group:"")+" ORDER BY "+b.ca;d&&(b+=", "+a.f+(f?"DESC":"ASC"));return b}
function Ue(a,b,c,d,e,f,g,h,k,m){var n=Re(a,d),p=n.f;d=n.c;var q=a.f,u=k?" <":" >",u=g?u+" ":u+"= ";g=Ce(f,n.type);h=Ce(h,a.type);n="";e?(a=Qe(a,c,b,p,e,k,m),a.w+=" AND ",n=d+u+"?",c.push(g)):(e=k?ve(f,!0):we(f,!0),a=Qe(a,c,b,p,e,k,m),n=a.w,a.w="");a.w+="("+n+" OR ("+d+" = ? AND "+q+u+"?))";c.push(g);c.push(h);return"SELECT "+a.select+" FROM "+a.aa+" WHERE "+a.w+(a.group?" GROUP BY "+a.group:"")+" ORDER BY "+a.ca}l.clone=function(){return Oe(this.toJSON())};l.index=function(a){return this.a[a]||null};
function Re(a,b){return Ra(a.a,function(a){return a.getName()==b})}function Ve(a,b){for(var c=0;c<a.a.length;c++)if(!Le(a.a[c].keyPath,b))return a.a[c];return null}function We(a,b){return b===a.keyPath?!0:Pa(a.a,function(a){return a.getName()==b})}function Se(a){return Ha(a.c)}
function Xe(a,b){if(!b)return a;var c=a.b,d=v(a.keyPath)?Va(a.keyPath):a.keyPath,e=a.type,f=Oa(a.a,function(a){return a.clone()});t(b.type)||"TEXT"!=e||(e=void 0);v(b.keyPath)&&x(d)&&d==b.keyPath.join(",")&&(d=Va(b.keyPath));for(var g=0,h=b.a.length;g<h;g++)if(b.a[g].h)for(var k=b.a[g].getName(),m=f.length-1;0<=m;m--)if(0<=k.indexOf(f[m].getName())){f[m]=b.a[g].clone();break}for(g=0;g<f.length;g++)(h=Re(b,f[g].getName()))&&(f[g]=f[g].hint(h));return new Ne(b.c,d,c,e,f)}l.getName=function(){return this.c};
function Ye(a){return!!a.keyPath}function Ze(a,b,c){if(b){if(!a.keyPath&&null!=c)return c;if(a.l){c=[];for(var d=0;d<a.keyPath.length;d++)c.push(Fd(b,a.keyPath[d]));return c}if(a.keyPath)return ib(b,a.h)}}function $e(a,b,c){for(var d=0;d<a.h.length;d++){var e=a.h[d];if(d==a.h.length-1){b[e]=c;break}t(b[e])||(b[e]={});b=b[e]}}
function af(a,b,c){var d=[],e=[];c=t(c)?c:Ze(a,b);t(c)&&(e.push(a.f),d.push(Ce(c,a.type)));for(var f=0;f<a.a.length;f++){var g=a.a[f];if(!g.multiEntry&&g.getName()!==a.keyPath&&"_default_"!=g.getName()){var h=He(g,b);null!=h&&(d.push(Ce(h,g.type)),e.push(g.c))}}a.wa?a.wa&&!a.keyPath&&0==a.a.length&&(x(b)&&-1==b.indexOf(";base64,")?d.push(b):d.push(S(b)),e.push("_default_")):(d.push(S(b)),e.push("_default_"));a=[];for(f=d.length-1;0<=f;f--)a[f]="?";return{cc:e,oc:a,values:d,key:c}}
function bf(a,b){if(!b)return"missing store: "+a.c;if(a.c!=b.c)return"store name, expect: "+a.c+", but: "+b.c;var c=Le(a.keyPath,b.keyPath);if(c)return"keyPath, "+c;if(t(a.b)&&t(b.b)&&a.b!=b.b)return"autoIncrement, expect:  "+a.b+", but: "+b.b;if(a.a.length!=b.a.length)return"indexes length, expect:  "+a.a.length+", but: "+b.a.length;if(t(a.type)&&t(b.type)&&(w(a.type)?!Za(a.type,b.type):a.type!=b.type))return"data type, expect:  "+a.type+", but: "+b.type;for(c=0;c<a.a.length;c++){var d=Re(b,a.a[c].getName()),
e;e=a.a[c];if(d)if(e.b!=d.b)e="name, expect: "+e.b+", but: "+d.b;else{var f=Le(e.keyPath,d.keyPath);e=f?"keyPath, "+f:null!=e.unique&&null!=d.unique&&e.unique!=d.unique?"unique, expect: "+e.unique+", but: "+d.unique:null!=e.multiEntry&&null!=d.multiEntry&&e.multiEntry!=d.multiEntry?"multiEntry, expect: "+e.multiEntry+", but: "+d.multiEntry:t(e.type)&&t(d.type)&&(w(e.type)?!Za(e.type,d.type):e.type!=d.type)?"data type, expect: "+e.type+", but: "+d.type:""}else e="no index for "+e.b;if(0<e.length)return'index "'+
a.a[c].getName()+'" '+e}return""}function cf(a,b){if(b)for(var c=0;c<a.a.length;c++){var d=a.a[c],e=b;if(d.g){var f=d.g(e),g=typeof f;if("string"==g||"number"==g||f instanceof Date||v(f)){for(g=0;g<d.a.length-1;g++)z(e[d.a[g]])||(e[d.a[g]]={});e[d.a[d.a.length-1]]=f}}}}function df(a,b){a.i.push(b)}function ef(a,b,c,d,e){for(var f=0;f<a.i.length;f++)d!==f&&a.i[f].call(e,b,c)}l.toString=function(){return"Store:"+this.c+"["+this.a.length+"index]"};function ff(){}
function gf(a,b,c){switch(typeof b){case "string":hf(b,c);break;case "number":c.push(isFinite(b)&&!isNaN(b)?b:"null");break;case "boolean":c.push(b);break;case "undefined":c.push("null");break;case "object":if(null==b){c.push("null");break}if(v(b)){var d=b.length;c.push("[");for(var e="",f=0;f<d;f++)c.push(e),gf(a,b[f],c),e=",";c.push("]");break}c.push("{");d="";for(e in b)Object.prototype.hasOwnProperty.call(b,e)&&(f=b[e],"function"!=typeof f&&(c.push(d),hf(e,c),c.push(":"),gf(a,f,c),d=","));c.push("}");
break;case "function":break;default:throw Error("Unknown type: "+typeof b);}}var jf={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\u000b"},kf=/\uffff/.test("\uffff")?/[\\\"\x00-\x1f\x7f-\uffff]/g:/[\\\"\x00-\x1f\x7f-\xff]/g;function hf(a,b){b.push('"',a.replace(kf,function(a){if(a in jf)return jf[a];var b=a.charCodeAt(0),e="\\u";16>b?e+="000":256>b?e+="00":4096>b&&(e+="0");return jf[a]=e+b.toString(16)}),'"')};function lf(a){return!x(a)||ta(a)?{}:JSON.parse(a)}function mf(a){var b;try{b=S(a)}catch(c){b=""}return b?b.substr(0,70)+(70<b.length?"...":""):""}function S(a){return JSON.stringify(a,void 0,void 0)};function nf(a,b,c){if(!a||ta(a))throw new K("store_name must be provided for primary full text index");if(!b||ta(b))throw new K("index_name must be provided for primary full text index");this.H=a;this.a=b;this.b=c||1}nf.prototype.j=function(){return this.H};function of(a,b,c,d){this.name=a;this.b=b;this.c=c||"";if(-1==["","en","fr"].indexOf(this.c))throw new K('Unsupported lang "'+c+" for full text search index "+a);this.f=d||null;this.a=null}of.prototype.getName=function(){return this.name};of.prototype.count=function(){return this.b.length};of.prototype.index=function(a){return this.b[a]};function pf(a,b,c){return Ra(a.b,function(a){return a.j()==b&&a.a==c})}
function qf(a){var b=["name","sources","lang"],c;for(c in a)if(a.hasOwnProperty(c)&&-1==Ma(b,c))throw new K("Unknown field: "+c+" in "+S(a));if(!v(a.sources))throw new K("indexes require for full text search index "+a.name+", but "+a.sources+" of type "+typeof a.sources+" found.");b=a.sources.map(function(a){var b=["storeName","keyPath","weight"],c;for(c in a)if(a.hasOwnProperty(c)&&-1==Ma(b,c))throw new K("Unknown field: "+c+" in "+mf(a));return new nf(a.storeName,a.keyPath,a.weight)});return new of(a.name,
b,a.lang)};function rf(a,b){var c,d,e=b;if(z(a)){d=a;c=["version","stores","fullTextCatalogs"];for(var f in d)if(d.hasOwnProperty(f)&&-1==Ma(c,f))throw new K("Unknown field: "+f+" in schema.");c=d.version;var e=[],g=d.stores||[];if(!v(g))throw new K("stores must be array");for(f=0;f<g.length;f++){var h=Oe(g[f]);if(-1!=Sa(e,function(a){return a.name==h.getName()}))throw new K('duplicate store name "'+h.getName()+'".');e.push(h)}}else x(a)?c=0==a.length?void 0:parseFloat(a):y(a)&&(c=a);if(t(c)){if(!y(c)||0>c)throw new K("Invalid version: "+
c+" ("+a+")");isNaN(c)&&(c=void 0)}if(t(b)&&(!v(b)||0<b.length&&!(b[0]instanceof Ne)))throw new K("stores");this.version=c;this.b=!t(this.version);this.stores=e||[];c=[];if(d&&d.fullTextCatalogs)for(f=0;f<d.fullTextCatalogs.length;f++)e=qf(d.fullTextCatalogs[f]),c[f]=e,T(this,e.getName())||(g=[new Ee("k",Ge),new Ee("v",Ge)],e=new Ne(e.getName(),"id",!1,void 0,g,!1,!1,!1),this.stores.push(e));this.c=c}
rf.prototype.toJSON=function(){var a=Oa(this.stores,function(a){return a.toJSON()}),b={};b.stores=a;t(this.version)&&(b.version=this.version);return b};rf.prototype.b=!1;rf.prototype.a=function(){return!1};function sf(a){return Oa(a.stores,function(a){return a.getName()})}rf.prototype.count=function(){return this.stores.length};function T(a,b){return Ra(a.stores,function(a){return a.getName()==b})}function tf(a,b){return Pa(a.stores,function(a){return a.getName()==b})}
function uf(a,b,c,d){if(!b||a.stores.length!=b.stores.length)return"Number of store: "+a.stores.length+" vs "+b.stores.length;for(var e=0;e<a.stores.length;e++){var f=T(b,a.stores[e].getName());if(f){c&&(f=Xe(f,a.stores[e]));if(d)for(var g=f,h=a.stores[e],k=0;k<h.a.length;k++){var m=h.a[k];We(g,m.getName())||"BLOB"!=m.type||(m=new Ee(m.keyPath,m.type,m.unique,m.multiEntry,m.getName()),g.a.push(m))}f=bf(a.stores[e],f);if(0<f.length)return'store: "'+a.stores[e].getName()+'" '+f}else return'missing object store "'+
a.stores[e].getName()+'"'}return""}function vf(a,b){return Ra(a.c,function(a){return a.getName()==b})};function wf(a,b){rf.call(this,a,b)}C(wf,rf);wf.prototype.a=function(){return!0};function xf(a,b){a.stores.push(b)};function yf(a){Error.captureStackTrace?Error.captureStackTrace(this,yf):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.ArgumentException"}C(yf,Error);function zf(a){Error.captureStackTrace?Error.captureStackTrace(this,zf):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.NotSupportedException"}C(yf,Error);zf.prototype.name="ydn.error.NotSupportedException";
function Af(a){Error.captureStackTrace?Error.captureStackTrace(this,Af):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.NotImplementedException"}C(Af,Error);function Bf(a){Error.captureStackTrace?Error.captureStackTrace(this,Bf):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InternalError"}C(Bf,Error);Bf.prototype.name="ydn.InternalError";
function Cf(a){Error.captureStackTrace?Error.captureStackTrace(this,Cf):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.ConstraintError"}C(Cf,Error);Cf.prototype.name="ydn.error.ConstraintError";function Df(a){Error.captureStackTrace?Error.captureStackTrace(this,Df):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InvalidOperationException"}C(yf,Error);
function Ef(a){Error.captureStackTrace?Error.captureStackTrace(this,Ef):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InvalidOperationError"}C(Ef,Error);function Me(a,b){var c;c=c||{};if(null!=a&&null!=b){if(w(a)&&w(b)){if(a.length!=b.length)return!1;for(var d=0;d<a.length;d++)if(-1==Sa(b,function(b){return Me(b,a[d])}))return!1;return!0}if(w(a))return 1==a.length&&Me(a[0],b);if(w(b))return 1==b.length&&Me(b[0],a);if(z(a)&&z(a)){for(var e in a)if(a.hasOwnProperty(e)&&!c[e]){var f=Me(a[e],b[e]);if(!f)return!1}for(e in b)if(b.hasOwnProperty(e)&&!c[e]&&(f=Me(a[e],b[e]),!f))return!1;return!0}return a===b}return!1}
function Ff(a){if(a)for(var b in a)if(a.hasOwnProperty(b))return a[b]};/*
 Copyright 2012 YDN Authors, Yathit. All Rights Reserved.
 Licensed under the Apache License, Version 2.0 (the "License");.
*/
function Gf(a,b,c){c=c||{};var d="autoSchema connectionTimeout size mechanisms policy isSerial Encryption".split(" "),e;for(e in c)if(c.hasOwnProperty(e)&&-1==Ma(d,e))throw new K('Unknown attribute "'+e+'" in options.');if(c.mechanisms){if(!v(c.mechanisms))throw new K("mechanisms attribute must be an array but "+ba(c.mechanisms)+" found.");for(e=0;e<c.mechanisms.length;e++)if(!(0<=Ma(Hf,c.mechanisms[e])))throw new K('Invalid mechanism "'+c.mechanisms[e]+'"');}this.K=c.mechanisms||(ae?Ya(Hf,1):Hf);
this.o=c.size;this.P=t(c.connectionTimeout)?c.connectionTimeout:3E3;this.c=null;this.g=[];this.nb=!1;var f;if(b instanceof rf)f=b;else if(z(b))for(c.autoSchema||!t(b.stores)?f=new wf(b):f=new rf(b),d=b.stores?b.stores.length:0,e=0;e<d;e++){var g=T(f,b.stores[e].name);b.stores[e].Sync&&F(this.logger,"Synchronization option for "+g.getName()+" ignored.")}else f=new wf;b=this.nc(c.Encryption);this.b=f;for(e=0;e<this.b.count();e++)if((this.b.stores[e]||null).o){if(!b)throw Error("encryption option must be defined");
this.Xb(this.b.stores[e]||null)}t(a)&&this.F(a);this.i=null;this.h=new D}Gf.prototype.logger=E("ydn.db.con.Storage");Gf.prototype.V=function(a){if(t(a)){var b=function(b){a(b.toJSON());a=void 0};if(this.c)this.c.Y(b);else{var c=this;this.transaction(function(a){c.c.Y(b,a)},null,Cd)}}return this.b?this.b.toJSON():null};Gf.prototype.F=function(a){if(this.c)throw new xd("Already connected with "+this.l);this.l=a;If(this)};Gf.prototype.getName=function(){return this.l};var Hf="indexeddb sqlite websql localstorage sessionstorage userdata memory".split(" ");
l=Gf.prototype;l.Gb=function(){return null};
function If(a){function b(b,e){b?(I(a.logger,a+": ready."),a.gc=NaN,d.Wa=function(b){a.N(new he(a,b))},d.zb=function(b){a.N(new ie(a,b));a.c=null},d.rb=function(b){a.N(b)},setTimeout(function(){Jf(a,e);Mf(a)},10),c.callback(e)):(F(a.logger,a+": database connection fail "+e.name),setTimeout(function(){Jf(a,new ie(a,e));if(a.g){var b=a.logger;for(b&&b.log(fd,"Purging "+a.g.length+" transactions request.",void 0);b=a.g.shift();)b.T&&b.T("error",e)}},10),c.s(e))}for(var c=new D,d=null,e=a.K,f=0;f<e.length;f++){var g=
e[f].toLowerCase();if(d=a.Gb(g)){d=a.Gb(g);break}}null===d?(e=new Cf("No storage mechanism found."),b(!1,new ie(a,e))):Qb(d.connect(a.l,a.b),function(a){this.c=d;b(!0,new ge("ready",this,parseFloat(d.xb()),parseFloat(a),null))},function(a){F(this.logger,this+": opening fail");b(!1,a)},a)}l.Xa=function(){if(this.c)return this.c.Fa()};l.qb=function(a,b){this.h.ma().ya(a,b)};function Jf(a,b){setTimeout(function(){a.b.b&&a.h.c||(b instanceof he?a.h.s(b.error):a.h.callback(),a.N(b))},4)}
function Nf(a){return!!a.c&&a.c.yb()}l.close=function(){this.c&&(this.c.close(),this.c=null,I(this.logger,this+" closed"))};l.Pc=function(){return this.c?this.c.Sb():null};l.gc=NaN;function Mf(a){var b=a.g.shift();b&&(I(a.logger,"pop tx queue["+(a.g.length+1)+"]"),a.transaction(b.hb,b.Cc,b.mode,b.T));a.gc=ma()}
function Of(a,b,c,d,e){I(a.logger,"push tx queue["+a.g.length+"]");a.g.push({hb:b,Cc:c,mode:d,T:e});100<a.g.length&&0==a.g.length%100&&F(a.logger,"Transaction queue stack size is "+a.g.length+". It is too large, possibility due to incorrect usage.")}l.nb=!1;
l.transaction=function(a,b,c,d){var e=b;if(x(b))e=[b];else if(null!=b)if(w(b)){if(0==b.length)throw new K("number of store names must more than 0");for(var f=0;f<b.length;f++)if(!x(b[f]))throw new K("store name at "+f+" must be string but found "+typeof b[f]);}else throw new K("store names must be an array");else e=null;if(this.c&&this.c.yb()&&!this.nb){var g=this,h=t(c)?c:Cd;h==Dd&&(this.nb=!0);this.c.gb(function(b){a(b);a=null},e,h,function(a,b){ea(d)&&(d(a,b),d=void 0);h==Dd&&(g.nb=!1);Mf(g)})}else Of(this,
a,e,c,d)};l.Xb=function(a){F(this.logger,"Encryption option for "+a.getName()+" ignored.")};l.nc=function(){return!1};l.Zb=function(a){F(this.logger,"Full text indexer option for "+a.getName()+" ignored.")};l.N=function(){};l.toString=function(){return"Storage:"+this.c};Gf.prototype.close=Gf.prototype.close;Gf.prototype.getType=Gf.prototype.Xa;Gf.prototype.getName=Gf.prototype.getName;Gf.prototype.getSchema=Gf.prototype.V;Gf.prototype.onReady=Gf.prototype.qb;Gf.prototype.setName=Gf.prototype.F;Gf.prototype.transaction=Gf.prototype.transaction;Gf.prototype.db=Gf.prototype.Pc;na("ydn.db.version","1.3.2");na("ydn.db.cmp",Q);na("ydn.db.deleteDatabase",function(a,b){for(var c,d=0;d<Yd.length;d++){var e=Yd[d](a,b);e&&(c=e)}return c||Xd("IDBVersionChangeEvent ",null)});
ge.prototype.name=ge.prototype.name;ge.prototype.getVersion=ge.prototype.Sc;ge.prototype.getOldVersion=ge.prototype.wc;ge.prototype.getOldSchema=ge.prototype.vc;he.prototype.getError=he.prototype.a;Rd.prototype.abort=Rd.prototype.abort;Rd.prototype.canAbort=Rd.prototype.uc;zd.prototype.progress=zd.prototype.$b;zd.prototype.promise=zd.prototype.Hc;na("ydn.db.KeyRange",R);R.only=te;R.bound=ue;R.upperBound=ve;R.lowerBound=we;function Pf(a){Error.captureStackTrace?Error.captureStackTrace(this,Pf):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ConstraintError"}C(Pf,Error);Pf.prototype.name="ConstraintError";Pf.prototype.toString=function(){return this.name+": "+this.message};function Qf(a){Error.captureStackTrace?Error.captureStackTrace(this,Qf):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.VersionError"}C(Qf,Error);Qf.prototype.name="ydn.db.VersionError";
Qf.prototype.toString=function(){return this.name+": "+this.message};function Rf(a){Error.captureStackTrace?Error.captureStackTrace(this,Rf):this.stack=Error().stack||"";a&&(this.message=String(a))}C(Rf,Error);Rf.prototype.name="ydn.db.InternalError";function Vd(a){Error.captureStackTrace?Error.captureStackTrace(this,Vd):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="InvalidStateError"}C(Vd,Error);
function Sf(a){Error.captureStackTrace?Error.captureStackTrace(this,Sf):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="InvalidAccessError"}C(Sf,Error);function Tf(a){Error.captureStackTrace?Error.captureStackTrace(this,Tf):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="NotFoundError"}C(Tf,Error);Tf.prototype.name="NotFoundError";Tf.prototype.toString=function(){return this.name+": "+this.message};
function Uf(a,b){Error.captureStackTrace?Error.captureStackTrace(this,Uf):this.stack=Error().stack||"";b&&(this.message=String(b));this.message+=" :"+a.message+" ["+a.code+"]";this.name="SQLError"}C(Uf,Error);Uf.prototype.toString=function(){return this.name+": "+this.message};function Vf(a,b){Error.captureStackTrace?Error.captureStackTrace(this,Vf):this.stack=Error().stack||"";b&&(this.message=String(b));this.message+=" :"+a.message;this.name="SecurityError"}C(Vf,Error);
Vf.prototype.toString=function(){return this.name+": "+this.message};function Wf(a){Error.captureStackTrace?Error.captureStackTrace(this,Wf):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.SqlParseError"}C(Wf,Error);function Xf(a){Error.captureStackTrace?Error.captureStackTrace(this,Xf):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.TimeoutError"}C(Xf,Error);function Yf(a,b){this.a=b}Yf.prototype.logger=E("ydn.db.crud.req.RequestExecuto");Yf.prototype.toString=function(){return"RequestExecutor"};function Zf(a){this.c=a;this.a=null;this.b=0}Zf.prototype.logger=E("ydn.db.tr.Mutex");Zf.prototype.X=null;function $f(a){return!!a.a&&!a.f}Zf.prototype.T=null;Zf.prototype.toString=function(){return"Mutex:"+("B"+this.c+"T"+this.b)+(this.a?"*":"")};function ag(a,b,c,d,e,f){this.P=a;this.V=b;this.a=this.f=0;this.K=d;this.F=e;this.g=c||bg;this.l=f||0}ag.prototype.logger=E("ydn.db.tr.Thread");ag.prototype.type=function(){return this.P.Xa()};ag.prototype.m=function(){return this.P};ag.prototype.M=function(){return"B"+this.V+"T"+this.f};var bg="single";function cg(a){if(a)if(ea(a.abort))a.abort();else if(ea(a.executeSql))a.executeSql("ABORT",[],null,function(){return!0});else throw new vd;else throw new Vd("No active transaction");};function dg(a,b,c,d,e,f){ag.call(this,a,b,c,d,e,f);this.c=[];this.h=[];this.i=null;this.b=new Zf(b);this.o=f||0;this.u=!1}C(dg,ag);l=dg.prototype;l.logger=E("ydn.db.tr.Serial");
function eg(a,b,c){if("multi"==a.g)a:if(a=a.b,!a.X||!a.mode||c!=a.mode&&(a.mode!=L||c!=Cd)||b.length>a.X.length)b=!1;else{for(c=0;c<b.length;c++)if(-1==a.X.indexOf(b[c])){b=!1;break a}b=!0}else if("repeat"==a.g)a:if(a=a.b,a.X&&a.mode&&c==a.mode&&a.X.length==b.length){for(c=0;c<b.length;c++)if(-1==a.X.indexOf(b[c])){b=!1;break a}b=!0}else b=!1;else b="all"==a.g?!0:!1;return b}function fg(a){var b=0<a.c.length?a.c[0].X:null,c=0<a.c.length?a.c[0].mode:null;return null!=b&&null!=c?eg(a,b,c):!1}
function gg(a,b,c,d,e){I(a.logger,"push tx queue["+a.c.length+"]");a.c.push({hb:b,X:c,mode:d,T:e})}l.abort=function(){J(this.logger,this+": aborting");cg(this.i)};
l.ta=function(a,b,c,d){var e=x(b)?[b]:b;if(w(e)){if(0==e.length)throw new K("number of store names must more than 0");for(var f=0;f<e.length;f++){if(!x(e[f]))throw new K("store name at "+f+" must be string but found "+e[f]+" of type "+typeof e[f]);if(this.R&&!(0<=Ma(this.R,e[f])))throw new K('store name "'+f+e[f]+'" in scope of '+this);}}else throw new K("store names must be an array");var g=t(c)?c:Cd,h=this;if(this.b.a||!Nf(this.m())&&this.u)gg(this,a,b,g,d);else{var k=this.M();d&&this.h.push(d);
if(this.o&&this.f>=this.o)throw new xd("Exceed maximum number of transactions of "+this.o);this.u=!0;this.m().transaction(function(c){var d=h.b;d.a=c;d.f=!1;d.X=b;d.mode=g;d.b++;d.T=null;k=h.M();td(h.logger,k+" BEGIN "+S(b)+" "+g);a(h);for(a=null;fg(h);)c=h.c.shift(),c.T&&h.h.push(c.T),I(h.logger,"pop tx queue"+(h.c.length+1)+" reusing T"+h.f),c.hb()},e,g,function(a,b){td(h.logger,k+" "+a);var c=h.b;c.a?(c.a=null,c.X=null,c.mode=null,ea(c.T)&&c.T(a,b),c.T=null):F(c.logger,c+" has no TX to be unlocked for "+
a);for(c=0;c<h.h.length;c++)(0,h.h[c])(a,b);h.h.length=0;(c=h.c.shift())&&h.ta(c.hb,c.X,c.mode,c.T);h.a=0})}};l.M=function(){var a=this.b;return"B"+a.c+"T"+a.b};l.request=function(a,b,c,d){function e(a,b){Ud(f);d&&d(a,b)}var f=new Rd(a);a=c||Cd;var g=this;$f(this.b)&&eg(this,b,a)?(b=this.b.a,this.a++,Sd(f,b,this.M()+"R"+this.a),this.h.push(e)):g.ta(function(){var a=g.b.a;g.a++;Sd(f,a,g.M()+"R"+g.a)},b,a,e);return f};
l.Ga=function(a,b,c,d,e){d=d||Cd;var f=this,g;if($f(f.b)&&eg(this,c,d)){var h=f.b.a;f.a++;g=f.M()+"R"+f.a;J(f.logger,g+" BEGIN");b(h,g,function(b,c){f.i=h;c?(J(f.logger,g+" ERROR"),a.s(b)):(J(f.logger,g+" SUCCESS"),a.callback(b));f.i=null});J(f.logger,g+" END");b=null}else f.ta(function(){var c=f.b.a;f.a++;g=f.M()+"R"+f.a;J(f.logger,g+" BEGIN");b(c,g,function(b,d){f.i=c;d?(J(f.logger,g+" ERROR"),a.s(b)):(J(f.logger,g+" SUCCESS"),a.callback(b));f.i=null});J(f.logger,g+" END");b=null},c,d,e)};
l.getName=function(){return this.m().getName()};l.toString=function(){return"Serial:"+this.M()+(this.i?"*":"")};function hg(a,b){dg.call(this,a,b)}C(hg,dg);hg.prototype.logger=E("ydn.db.tr.AtomicSerial");hg.prototype.request=function(a,b,c){var d,e,f,g=hg.D.request.call(this,a,b,c,function(a,b){Ud(g);if(d)"complete"!=a&&(f=!0,e=b),d(e,f);else{var c=new Xf;M(g,c,!0)}});Wd(g,function(a,b,c){f=b;e=a;d=c});return g};
hg.prototype.Ga=function(a,b,c,d,e){var f,g,h=new D;Qb(h,function(a){g=!1;f=a},function(a){g=!0;f=a});hg.D.Ga.call(this,h,b,c,d,function(b,c){if("complete"!=b)a.s(c);else if(!0===g)a.s(f);else if(!1===g)a.callback(f);else{var d=new Xf;a.s(d)}e&&(e(b,c),e=void 0)})};hg.prototype.toString=function(){return"Atomic"+hg.D.toString.call(this)};function ig(a,b,c,d){this.g=a;this.b=b;this.a=c;this.c=d;this.f=null}l=ig.prototype;l.logger=E("ydn.db.tr.DbOperator");l.Tc=function(){return this.a.f};l.abort=function(){this.a.abort()};function U(a){if(!a.f){var b;b=a.g;var c=b.Xa();if("indexeddb"==c)b=new jg(0,b.b);else if("websql"==c||"sqlite"==c)b=new kg(0,b.b);else if("memory"==c||"localstorage"==c||"sessionstorage"==c)b=new lg(0,b.b);else throw new yd("No executor for "+c);a.f=b}return a.f}l.m=function(){return this.g};
function mg(a,b){var c=x(b)?b:z(b)?b.name:void 0;if(!x(c))throw new K("store name "+c+" must be a string, but "+typeof c);var d=T(a.b,c);if(!d){if(!a.b.a())throw new K('store name "'+c+'" not found.');d=Oe(z(b)?b:{name:c});J(a.logger,"Adding object store: "+c);var e=d;var f=a.m(),g=e instanceof Ne?e:Oe(e),e=e.name,h=T(f.b,e);if(0==bf(g,h).length)Yb(!1);else if(h=h?"update":"add",f.b instanceof wf)xf(f.b,g),f.c?(f.c.close(),f.c=null,If(f)):Yb(!1);else throw new Cf("Cannot "+h+" store: "+e+". Not auto schema generation mode.");
}else if(a.b.a()&&z(b)&&(f=Oe(b),f=bf(d,f)))throw new vd(f);if(!d)throw new Tf(c);return d}l.toString=function(){return"TxStorage:"+this.m().getName()};function V(a,b,c,d){ig.call(this,a,b,c,d)}C(V,ig);l=V.prototype;l.logger=E("ydn.db.crud.DbOperator");
l.count=function(a,b,c,d){var e,f,g,h;if(null!=a)if(v(a)){if(t(c)||t(b))throw new K("too many arguments.");f=a;for(var k=0;k<f.length;k++)if(!tf(this.b,f[k]))throw new K('store name "'+f[k]+'" at '+k+" not found.");J(this.logger,"countStores: "+S(f));e=this.a.request("count",f);N(e,function(){U(this).eb(e,f)},this)}else if(x(a)){k=T(this.b,a);if(!k)throw new K('store name "'+a+'" not found.');if(t(d)&&!da(d))throw new K('unique value "'+d+'" must be boolean, but found '+typeof d+".");f=[a];if(x(b))if(g=
b,z(c)){var m=ze(c);if(m)throw new K("invalid key range: "+mf(c)+" "+m);h=se(c)}else{if(null!=c)throw new K("invalid key range: "+mf(c)+" of type "+typeof c);h=null}else if(z(b)||null==b)if(z(b)){if(m=ze(b))throw new K("invalid key range: "+mf(b)+" "+m);h=se(b)}else{if(null!=b)throw new K("key range must be  an object but found "+mf(b)+" of type "+typeof b);h=null}else throw new K('invalid second argument for count "'+mf(c)+'" of type '+typeof b);J(this.logger,"countKeyRange: "+a+" "+(g?g:"")+S(h));
e=this.a.request("count",f);ef(k,e,arguments);N(e,function(){U(this).Ia(e,f[0],h,g,!!d)},this)}else throw new K("Invalid store name or store names.");else F(this.logger,"count method requires store name(s)"),k=sf(this.b),e=this.a.request("count",k),Wd(e,function(a,b,c){if(b)c(a,!0);else{for(var d=b=0;d<a.length;d++)b+=a[d];c(b,!1)}},this),N(e,function(){U(this).eb(e,f)},this);return e};
l.get=function(a,b){var c=this,d;if(a instanceof me){var e=a,f=e.j(),g=T(this.b,f);if(!g){if(this.b.a()){if(Nf(this.m()))return Xd("get",void 0);d=new Rd("get");this.m().qb(function(){Qb(c.get(a,b),function(a){d.callback(a)},function(a){d.s(a)})});return d}throw new K("Store: "+f+" not found.");}var h=e.G();J(this.logger,"getByKey: "+f+":"+h);d=this.a.request("get:key",[f]);ef(g,d,arguments,void 0,this);N(d,function(){U(this).ib(d,f,h)},this)}else if(x(a)&&t(b)){var k=a,g=T(this.b,k);if(!g){if(this.b.a()){if(Nf(this.m()))return Xd("get",
void 0);d=new Rd("get");this.m().qb(function(){Qb(c.get(a,b),function(a){d.callback(a)},function(a){d.s(a)})});return d}throw new K('Store name "'+k+'" not found.');}var m=b;J(this.logger,"getById: "+k+":"+m);d=this.a.request("get",[k]);ef(g,d,arguments,void 0,this);N(d,function(){U(this).ib(d,k,m)},this)}else throw new K("get require valid input arguments.");return d};
l.zc=function(a,b,c,d,e){var f=T(this.b,a),g,h,k,m=null;if(z(b)){var n=ze(b);if(n)throw new K("invalid key range: "+b+" "+n);m=se(b)}else if(null!=b)throw new K('expect key range object, but found "'+mf(b)+'" of type '+typeof b);if(t(c))if(y(c))g=c;else throw new K("limit must be a number, but "+c+" is "+typeof c);else g=100;if(t(d))if(y(d))h=d;else throw new K("offset must be a number, but "+d+" is "+typeof d);else h=0;if(t(e))if(da(e))k=e;else throw new K("reverse must be a boolean, but "+e+" is "+
typeof e);J(this.logger,"keysByKeyRange: "+a);var p=this.a.request("keys",[a]);ef(f,p,arguments);N(p,function(){U(this).Z(p,2,a,null,m,g,h,k,!1)},this);return p};
l.Ma=function(a,b,c,d,e,f,g){var h,k,m,n,p,q=ze(c);if(q)throw new K("invalid key range: "+c+" "+q);q=T(this.b,a);h=se(c);if(y(d))k=d;else{if(t(d))throw new K("limit must be a number");k=100}if(y(e))m=e;else{if(t(e))throw new K("offset must be a number");m=0}if(t(f))if(da(f))n=f;else throw new K("reverse must be a boolean");if(t(g))if(da(g))p=g;else throw new K("unique must be a boolean");J(this.logger,"keysByIndex: "+a);var u=this.a.request("keys:iter:index",[a]);ef(q,u,arguments);N(u,function(){U(this).Z(u,
2,a,b,h,k,m,n,p)},this);return u};l.keys=function(a,b,c,d,e,f,g){var h=T(this.b,a);if(!x(a))throw new K("store name must be a string, but "+a+" of type "+typeof a+" is not.");if(!this.b.a()){if(!h)throw new K('store name "'+a+'" not found.');if(x(b)&&!Re(h,b))throw new K('index "'+b+'" not found in store "'+a+'".');}return this.b.a()&&!h?Xd("keys",[]):x(b)?this.Ma(a,b,c,d,e,f,g):this.zc(a,b,c,d,e)};
l.values=function(a,b,c,d,e,f,g){var h=this,k;if(x(a)){var m=a,n=T(this.b,m);if(!n){if(this.b.a()){if(Nf(this.m()))return Xd("values",[]);k=new Rd("values");this.m().qb(function(){Qb(h.values(a,b,c,d,e,f),function(a){k.callback(a)},function(a){k.s(a)})});return k}throw new Tf(m);}if(v(b)){if(t(c)||t(d))throw new K("too many input arguments");var p=b;J(this.logger,"listByIds: "+m+" "+p.length+" ids");k=this.a.request("values:array",[m]);ef(n,k,arguments,void 0,this);N(k,function(){U(this).Nb(k,m,p)},
this)}else k=x(b)?this.Ra(m,b,c,d,e,f,g):this.Gc(m,b,c,d,e)}else if(v(a))if(a[0]instanceof me){for(var n=[],q=a,u=0;u<q.length;u++){var A=q[u].j();if(!tf(this.b,A)){if(this.b.a())return n=[],n[q.length-1]=void 0,Xd("get",n);throw new K("Store: "+A+" not found.");}0<=Ma(n,A)||n.push(A)}J(this.logger,"listByKeys: "+S(n)+" "+q.length+" keys");k=this.a.request("values:keys",n);N(k,function(){U(this).ob(k,q)},this)}else throw new K("first argumentmust be array of ydn.db.Key, but "+a[0]+" of "+typeof a[0]+
" found.");else throw new K("first argument "+a+" is invalid.");return k};
l.Gc=function(a,b,c,d,e){var f=T(this.b,a),g,h,k,m=null;if(z(b)){var n=ze(b);if(n)throw new K("invalid key range: "+b+" "+n);m=se(b)}else if(null!=b)throw new K('expect key range object, but found "'+mf(b)+'" of type '+typeof b);if(t(c))if(y(c))g=c;else throw new K("limit must be a number, but "+c+" is "+typeof c);else g=100;if(t(d))if(y(d))h=d;else throw new K("offset must be a number, but "+d+" is "+typeof d);else h=0;if(t(e))if(da(e))k=e;else throw new K("reverse must be a boolean, but "+e+" is "+
typeof e);J(this.logger,(m?"listByKeyRange: ":"listByStore: ")+a);var p=this.a.request("values",[a]);ef(f,p,arguments);N(p,function(){U(this).Z(p,4,a,null,m,g,h,k,!1)},this);return p};
l.Ra=function(a,b,c,d,e,f,g){var h=T(this.b,a),k,m,n,p;if(!We(h,b))throw new K('index "'+b+'" not found in store "'+a+'"');var q=ze(c);if(q)throw new K("invalid key range: "+c+" "+q);var u=se(c);if(t(d))if(y(d))k=d;else throw new K("limit must be a number.");else k=100;if(t(e))if(y(e))m=e;else throw new K("offset must be a number.");else m=0;if(da(f))n=f;else if(t(f))throw new K("reverse must be a boolean, but "+f);if(t(g))if(da(g))p=g;else throw new K("unique must be a boolean");J(this.logger,"listByIndexKeyRange: "+
a+":"+b);var A=this.a.request("values:iter:index",[a]);ef(h,A,arguments);N(A,function(){U(this).Z(A,4,a,b,u,k,m,n,p)},this);return A};
l.add=function(a,b,c){if(v(b))return this.Za(a,b,c);var d=mg(this,a),e=d.getName(),f;if(x(d.keyPath)&&t(c))throw new K("key must not be provided while the store uses in-line key.");if(!d.keyPath&&!d.b&&!t(c))throw new K("out-of-line key must be provided for store: "+e);if(v(b)){J(this.logger,"addObjects: "+e+" "+b.length+" objects");for(a=0;a<b.length;a++)cf(d,b[a]);f=this.a.request("add:array",[e],L);N(f,function(){U(this).S(f,!1,!1,e,b,c)},this);d.ea&&f.L(function(a){a=new le("created",this.m(),
e,a,b);this.m().N(a)},this)}else if(z(b))a="store: "+e+" key: "+Ze(d,b,c),J(this.logger,"addObject: "+a),cf(d,b),f=this.a.request("add",[e],L),N(f,function(){U(this).S(f,!1,!0,e,[b],[c])},this),d.ea&&f.L(function(a){a=new ke("created",this.m(),d.getName(),a,b);this.m().N(a)},this);else throw new K("record must be an object or array list of objects, but "+b+" of type "+typeof b+" found.");return f};
l.Za=function(a,b,c){var d=mg(this,a),e=d.getName(),f;if(x(d.keyPath)&&t(c))throw new K("key must not be provided while the store uses in-line key.");if(!d.keyPath&&!d.b&&!t(c))throw new K("out-of-line key must be provided for store: "+e);if(v(b)){J(this.logger,"addObjects: "+e+" "+b.length+" objects");for(a=0;a<b.length;a++)cf(d,b[a]);f=this.a.request("add:array",[e],L);N(f,function(){U(this).S(f,!1,!1,e,b,c)},this);d.ea&&f.L(function(a){a=new le("created",this.m(),d.getName(),a,b);this.m().N(a)},
this)}else throw new K("record must be an array list of objects, but "+b+" of type "+typeof b+" found.");return f};
l.put=function(a,b,c){var d,e=this;if(a instanceof me){var f=a,g=f.j(),h=T(this.b,g);if(!h)throw new K('store "'+g+'" not found.');if(h.keyPath){var k=Ze(h,b);if(null!=k){if(0!=Q(k,f.G()))throw new K("Inline key must be "+f+" but "+k+" found.");}else $e(h,b,f.G());return this.put(g,b)}return this.put(g,b,f.G())}if(v(a)){if(t(c))throw new K("too many arguments");var m=a;if(!t(b))throw new K("record values required");for(var n=b,f=[],g=0,h=m.length;g<h;g++){k=m[g].j();-1==Ma(f,k)&&f.push(k);var p=T(this.b,
k);if(!p)throw new K('store "'+k+'" not found.');p.keyPath&&$e(p,n[g],m[g].G())}J(this.logger,"putByKeys: to "+S(f)+" "+n.length+" objects");for(g=0;g<n.length;g++)cf(p,n[g]);d=this.a.request("put:keys",f,L);ef(p,d,arguments);N(d,function(){U(e).tb(d,n,m)},this)}else if(x(a)||z(a)){var p=mg(this,a),q=p.getName();if(p.keyPath&&t(c))throw new K("key must not be provided while the store uses in-line key.");if(!p.keyPath&&!p.b&&!t(c))throw new K("out-of-line key must be provided for store: "+q);if(v(b)){var u=
b,A=c;J(this.logger,"putObjects: "+q+" "+u.length+" objects");for(g=0;g<u.length;g++)cf(p,u[g]);d=this.a.request("put:array",[q],L);ef(p,d,arguments);N(d,function(){U(this).S(d,!0,!1,q,u,A)},this);p.ea&&d.L(function(a){a=new le("updated",this.m(),q,a,u);this.m().N(a)},this)}else if(z(b)){var B=b,H=c;J(this.logger,"putObject: "+q+" "+(t(H)?H:"(without-key)"));if(t(r.Blob)&&B instanceof Blob&&p.wa&&!p.keyPath&&0==p.a.length&&Nc)d=new Rd("put"),f=new FileReader,f.onload=function(a){var b=a.target.result,
c=e.a.request("put",[q],L);ef(p,c,[q,B,H]);N(c,function(){U(e).S(c,!0,!0,q,[b],[H])},this);Qb(c,function(a){d.callback(a)},function(a){d.s(a)})},f.onerror=function(a){d.s(a)},f.onabort=function(a){d.s(a)},f.readAsDataURL(B);else{cf(p,B);d=this.a.request("put",[q],L);var G=[q,B,H];ef(p,d,G);N(d,function(){var a=t(H)?[G[2]]:void 0;U(e).S(d,!0,!0,q,[G[1]],a)},this)}p.ea&&d.L(function(a){a=new ke("updated",this.m(),q,a,B);this.m().N(a)},this)}else throw new K("put record value must be Object or array of Objects");
}else throw new K("the first argument of put must be store name, store schema or array of keys.");return d};
l.sb=function(a,b,c){var d,e=mg(this,a),f=e.getName();if(e.keyPath&&t(c))throw new K("key must not be provided while the store uses in-line key.");if(!e.keyPath&&!e.b&&!t(c))throw new K("out-of-line key must be provided for store: "+f);var g=b,h=c;J(this.logger,"putObjects: "+f+" "+g.length+" objects");for(var k=0;k<g.length;k++)cf(e,g[k]);d=this.a.request("put:array",[f],L);ef(e,d,arguments);N(d,function(){U(this).S(d,!0,!1,f,g,h)},this);e.ea&&d.L(function(a){a=new le("updated",this.m(),f,a,g);this.m().N(a)},
this);return d};
function ng(a,b,c){var d=a.c,e,f;if(x(b)){var g=T(a.b,b);if(g){if(!g.keyPath&&!g.b)throw new K('key required for store "'+b+'"');}else throw new Tf(b);for(var h=0;h<c.length;h++)cf(g,c[h]);e=[b]}else{f=b;e=[];for(var h=0,k=f.length;h<k;h++){var m=f[h].j(),g=T(a.b,m);-1==Ma(e,m)&&e.push(m);if(!g)throw new Tf(m);cf(g,c[h])}}var n;x(b)?(g=T(a.b,b),n=d.request("put:array",e,L),N(n,function(){U(this).S(n,!0,!1,b,c,void 0)},a)):(n=d.request("put:keys",e,L),N(n,function(){U(this).tb(n,c,f)},a));return n}
function og(a,b){for(var c=[],d=0,e=b.length;d<e;d++){var f=b[d].j();-1==Ma(c,f)&&c.push(f);if(!tf(a.b,f))throw new Tf(f);}var g=a.c.request("rm:keys",c,L);N(g,function(){U(this).vb(g,b)},a)}function pg(a,b,c){var d=a.c.request("rm:iter",[b],L);N(d,function(){U(this).Oa(d,b,c||null)},a);return d}
function qg(a,b){var c=[],d=b.length;if(0==d)return Xd("keys",[]);for(var e=0;e<d;e++){var f=b[e].j();-1==Ma(c,f)&&c.push(f);if(!tf(a.b,f))throw new Tf(f);}var g=a.c.request("keys",c);N(g,function(){U(a).ob(g,b)},a);return g}
l.clear=function(a,b,c){if(t(c))throw new K("too many input arguments");var d;if(x(a)){c=T(this.b,a);if(!c)throw new K('store name "'+a+'" not found.');if(z(b)){var e=se(b);if(null===e)throw new K("clear method requires a valid non-null KeyRange object.");J(this.logger,"clearByKeyRange: "+a+":"+S(e));d=this.a.request("clear",[a],L);ef(c,d,[a,e]);N(d,function(){U(this).Eb(d,a,e)},this)}else{if(t(b))throw new K("clear method requires a valid KeyRange object as second argument, but found "+b+" of type "+
typeof b);J(this.logger,"clearByStore: "+a);d=this.a.request("clear",[a],L);N(d,function(){U(this).bb(d,[a])},this)}}else if(!t(a)||v(a)&&x(a[0])){var f=a||sf(this.b);J(this.logger,"clearByStores: "+S(f));d=this.a.request("clear",f,L);N(d,function(){U(this).bb(d,f)},this)}else throw new K('first argument "'+a+'" is invalid.');return d};
l.Bb=function(a,b,c){var d;if(x(a)){var e=T(this.b,a);if(!e)throw new K('store name "'+a+'" not found.');if(t(c))if(x(b)){var f=Re(e,b);if(!f)throw new K("index: "+b+" not found in "+a);if(z(c)||null===c){var g=se(c);J(this.logger,"removeByIndexKeyRange: "+a+":"+f.getName()+" "+a);d=this.a.request("rm:iter:index",[a],L);N(d,function(){U(this).Ob(d,a,f.getName(),g)},this)}else throw new K("key range "+c+' is invalid type "'+typeof c+'".');}else throw new K('index name "'+b+'" must be a string, but '+
typeof b+" found.");else if(x(b)||y(b)||w(b)||b instanceof Date){J(this.logger,"removeById: "+a+":"+b);d=this.a.request("rm",[a],L);var h=[a,b];ef(e,d,h);N(d,function(){U(this).ub(d,a,h[1])},this);e.ea&&d.L(function(c){c=1==c?b:void 0;c=new ke("deleted",this.m(),a,c,void 0);this.m().N(c)},this)}else if(z(b))g=se(b),J(this.logger,"removeByKeyRange: "+a+":"+S(g)),d=this.a.request("rm:iter",[a],L),ef(e,d,[a,g]),N(d,function(){U(this).Oa(d,a,g)},this),e.ea&&d.L(function(b){var c=[];c.length=b;b=new le("deleted",
this.m(),a,c,void 0);this.m().N(b)},this);else throw new K('Invalid key or key range "'+b+'" of type '+typeof b);}else if(a instanceof me){var k=a.j(),e=T(this.b,k);d=this.a.request("rm",[k],L);var m=[k,a.G()];ef(e,d,m);N(d,function(){U(this).ub(d,k,m[1])},this)}else if(v(a)){c=[];for(var e=0,n=a.length;e<n;e++){if(!(a[e]instanceof me))throw new K("key list element at "+e+" of "+n+' must be yn.db.Key, but "'+mf(a[e])+'" ('+ba(a[e])+") is not ydn.db.Key.");var p=a[e].j();-1==Ma(c,p)&&c.push(p)}if(1>
c.length)throw new K('at least one valid key required in key list "'+mf(a)+'"');d=this.a.request("rm:keys",c,L);N(d,function(){U(this).vb(d,a)},this)}else throw new K('first argument requires store name, key (ydn.db.Key) or list of keys (array) , but "'+mf(a)+'" ('+ba(a)+") found.");return d};l.toString=function(){return"DbOperator:"+this.m().getName()};function rg(a,b,c,d){this.f=a;this.g=b;this.a=Va(c);this.b=d;this.c=[]}rg.prototype.f=null;function sg(a,b,c){if(a.f)c&&a.c.push(c),b(a.f);else throw new yd("tx committed on ParallelTxExecutor");}rg.prototype.toString=function(){return"ParallelTxExecutor: txNo:"+this.g+" mode:"+this.b+" scopes:"+S(this.a)};function tg(a,b,c,d,e,f){ag.call(this,a,b,c,d,e,f);this.c=this.b=null}C(tg,ag);l=tg.prototype;l.logger=E("ydn.db.tr.Parallel");l.abort=function(){J(this.logger,this+": aborting");cg(this.c)};
l.sc=function(a,b){var c;if("multi"==this.g)a:if(c=this.b,!c.a||!c.b||b!=c.b&&(c.b!=L||b!=Cd)||a.length>c.a.length)c=!1;else{for(var d=0;d<a.length;d++)if(-1==c.a.indexOf(a[d])){c=!1;break a}c=!0}else if("repeat"==this.g)a:if(c=this.b,c.a&&c.b&&b==c.b&&c.a.length==a.length){for(d=0;d<a.length;d++)if(-1==c.a.indexOf(a[d])){c=!1;break a}c=!0}else c=!1;else c="all"==this.g?!0:!1;return c};
l.ta=function(a,b,c,d){function e(c){k.f++;m=new rg(c,k.f,b,h);g=k.M();td(k.logger,g+" BEGIN "+S(b)+" "+h);k.b=m;sg(k.b,a,d)}function f(a,b){td(k.logger,g+" "+a);if(m){for(var c=m,d=0;d<c.c.length;d++)c.c[d](a,b);c.c.length=0;c.f=null;c.a=null;c.c=null}k.a=0}var g;this.K&&(b=this.K);this.F&&(c=this.F);var h=t(c)?c:Cd,k=this,m;if(this.b&&this.b.f&&this.sc(b,h))sg(this.b,a,d);else{if(this.l&&this.f>=this.l)throw new xd("Exceed maximum number of transactions of "+this.l);this.m().transaction(e,b,h,f)}};
l.request=function(a,b,c,d){var e=new Rd(a),f=this;this.ta(function(a){f.a++;Sd(e,a,f.M()+"R"+f.a)},b,c||Cd,function(a,b){Ud(e);d&&d(a,b)});return e};l.Ga=function(a,b,c,d,e){var f=this,g;this.ta(function(c){f.a++;g=f.M()+"R"+f.a;J(f.logger,g+" BEGIN");b(c,g,function(b,d){f.c=c;g=f.M()+"R"+f.a;d?(J(f.logger,g+" ERROR"),a.s(b)):(J(f.logger,g+" SUCCESS"),a.callback(b));f.c=null});b=null;J(f.logger,g+" END")},c,d,e)};l.toString=function(){return"Parallel:"+this.g+":"+this.M()+(this.c?"*":"")};function ug(a,b){tg.call(this,a,b,bg)}C(ug,tg);l=ug.prototype;l.logger=E("ydn.db.tr.AtomicParallel");l.sc=function(){return!1};l.request=function(a,b,c){var d,e,f,g=this,h=ug.D.request.call(this,a,b,c,function(a,b){Ud(h);J(g.logger,"transaction "+a);if(d)"complete"!=a&&(f=!0,e=b),d(e,f);else{var c=new Xf;M(h,c,!0)}});Wd(h,function(a,b,c){f=b;e=a;d=c});return h};
l.Ga=function(a,b,c,d,e){var f,g,h=new D;Qb(h,function(a){g=!1;f=a},function(a){g=!0;f=a});ug.D.Ga.call(this,h,b,c,d,function(b,c){if("complete"!=b)a.s(c);else if(!0===g)a.s(f);else if(!1===g)a.callback(f);else{var d=new Xf;a.s(d)}e&&(e(b,c),e=void 0)})};l.toString=function(){return"Atomic"+ug.D.toString.call(this)};function vg(a,b,c){Gf.call(this,a,b,c);this.Ba=0;a=!0;b=bg;c&&(t(c.isSerial)&&(a=!!c.isSerial),c.policy&&(b=c.policy));c=wg(this,b,a);this.u=wg(this,"atomic",!1);this.a=this.Aa(c,this.u)}C(vg,Gf);l=vg.prototype;l.Ba=0;l.tc=function(a,b,c,d,e,f){a=a||bg;var g;"readonly"==d?g=Cd:"readwrite"==d&&(g=L);a=wg(this,a,b,c,g,e);return this.Aa(a,f?null:this.u)};l.Aa=function(a,b){return new ig(this,this.b,a,b)};
function wg(a,b,c,d,e,f){if(c){if("multi"==b||"repeat"==b||"all"==b||b==bg)return new dg(a,a.Ba++,b,d,e,f);if("atomic"==b)return new hg(a,a.Ba++);throw new K('Invalid requestType "'+b+'"');}if("multi"==b||"repeat"==b||"all"==b||b==bg)return new tg(a,a.Ba++,b,d,e,f);if("atomic"==b)return new ug(a,a.Ba++);throw new K('Invalid requestType "'+b+'"');}
l.Bc=function(a,b,c){if(3<arguments.length)throw new K("too many input arguments, run accept not more than 3 input arguments, but "+arguments.length+" found.");this.Ba++;var d=b||sf(this.b),e=Cd;if(c)if("readwrite"==c)e=L;else if("readonly"!=c)throw new K('Invalid transaction mode "'+c+'"');var f=wg(this,"all",!1,d,e,1),g=this.Aa(f,this.u),h=new Rd("run"),k=this;f.ta(function(b){I(k.logger,"executing run in transaction on "+f);Sd(h,b,f.M()+"R0");a(g)},d,e,function(a){Ud(h);M(h,f.f,"complete"!==a)});
return h};l.Uc=function(){return this.a?this.a.a.f:NaN};function W(a,b,c){vg.call(this,a,b,c);a=this.b;for(b=0;b<a.c.length;b++){c=a.c[b];var d=T(a,c.getName());if(d){if(!We(d,"k"))throw new K('full text index store "'+d.getName()+'" must have "keyword" index');if(!We(d,"v"))throw new K('full text index store "'+d.getName()+'" must have "keyword" index');if("id"!=d.keyPath)throw new K('full text index store "'+d.getName()+'" must use "id" as key path.');}else throw new K('full text index store "'+c.getName()+'" required.');for(d=0;d<c.count();d++){var e=
c.index(d),f=T(a,e.j());if(f)this.Zb(f,c);else throw new K('full text source store "'+e.j()+'" does not exist for full text index "'+c.getName()+'"');}}}C(W,vg);l=W.prototype;l.Aa=function(a,b){return new V(this,this.b,a,b)};l.add=function(a,b,c){return this.a.add(a,b,c)};l.Za=function(a,b,c){return this.a.Za(a,b,c)};l.count=function(a,b,c,d){return this.a.count(a,b,c,d)};l.get=function(a,b){return this.a.get(a,b)};l.keys=function(a,b,c,d,e,f,g){return this.a.keys(a,b,c,d,e,f,g)};
l.Ma=function(a,b,c,d,e,f,g){return this.a.Ma(a,b,c,d,e,f,g)};l.values=function(a,b,c,d,e,f){return this.a.values(a,b,c,d,e,f)};l.Ra=function(a,b,c,d,e,f){return this.a.Ra(a,b,c,d,e,f)};l.put=function(a,b,c){return this.a.put(a,b,c)};l.sb=function(a,b,c){return this.a.sb(a,b,c)};l.clear=function(a,b,c){return this.a.clear(a,b,c)};l.Bb=function(a,b,c){return this.a.Bb(a,b,c)};l.toString=function(){var a="Storage:"+this.getName();Nf(this)&&(a+=" ["+this.Xa()+"]");return a};vg.prototype.branch=vg.prototype.tc;vg.prototype.getTxNo=vg.prototype.Uc;ig.prototype.getTxNo=ig.prototype.Tc;vg.prototype.run=vg.prototype.Bc;W.prototype.branch=W.prototype.tc;W.prototype.add=W.prototype.add;W.prototype.addAll=W.prototype.Za;W.prototype.get=W.prototype.get;W.prototype.keys=W.prototype.keys;W.prototype.keysByIndex=W.prototype.Ma;W.prototype.values=W.prototype.values;W.prototype.valuesByIndex=W.prototype.Ra;W.prototype.put=W.prototype.put;W.prototype.putAll=W.prototype.sb;W.prototype.clear=W.prototype.clear;W.prototype.remove=W.prototype.Bb;W.prototype.count=W.prototype.count;V.prototype.add=V.prototype.add;
V.prototype.addAll=V.prototype.Za;V.prototype.get=V.prototype.get;V.prototype.keys=V.prototype.keys;V.prototype.keysByIndex=V.prototype.Ma;V.prototype.values=V.prototype.values;V.prototype.valuesByIndex=V.prototype.Ra;V.prototype.put=V.prototype.put;V.prototype.putAll=V.prototype.sb;V.prototype.clear=V.prototype.clear;V.prototype.remove=V.prototype.Bb;V.prototype.count=V.prototype.count;na("ydn.db.Key",me);me.prototype.id=me.prototype.G;me.prototype.parent=me.prototype.Lc;me.prototype.storeName=me.prototype.j;
na("ydn.db.KeyRange",R);R.upperBound=ve;R.lowerBound=we;R.bound=ue;R.only=te;R.starts=xe;fe.prototype.store_name=fe.prototype.H;fe.prototype.getStoreName=fe.prototype.j;ke.prototype.name=ke.prototype.name;ke.prototype.getKey=ke.prototype.a;ke.prototype.getValue=ke.prototype.O;le.prototype.name=le.prototype.name;le.prototype.getKeys=le.prototype.ra;le.prototype.getValues=le.prototype.jb;function xg(a,b,c,d,e){if(!(b instanceof R))if(x(b)&&t(c))b=De(b,c,d,e);else if(null!=b){if(!(b instanceof R))if(z(b))b=new R(b.lower,b.upper,b.lowerOpen,b.upperOpen);else throw new K("Invalid key range: "+b+" of type "+typeof b);}else b=null;this.a=b;this.qa=a}xg.prototype.qa="";xg.prototype.oa=function(a){if(this.qa!=a.qa)return null;a=null!=this.a&&null!=a.a?this.a.oa(a.a):this.a||a.a;return new xg(this.qa,a)};function yg(a,b,c,d){be.call(this);this.b=c;this.H=c.getName();this.W=void 0;this.g=!1;this.B=null;this.f=a;this.Wb=b;this.xa=0;this.V=this.F=!1;this.u=d||4;this.l=this.c=this.a=void 0;this.K=function(){throw new yd;};this.R=function(){throw new yd;};this.Vb=function(){}}C(yg,be);l=yg.prototype;
l.Ub=function(a,b,c,d,e){if(t(b)){a=this.b;var f,g=b;v(b)?(f=Ve(a,b),g=b.join(", ")):f=Re(a,b);if(!f)throw new K('require index "'+g+'" not found in store "'+a.getName()+'"');this.W=f.getName()}this.g=x(this.W);this.B=c||null;this.xa=0;this.V=this.F=!1;this.reverse="prev"==d||"prevunique"==d;this.unique="nextunique"==d||"prevunique"==d;this.da=d;this.La=e;this.l=this.c=this.a=void 0};l.da="";l.B=null;l.unique=!1;l.reverse=!1;l.La=!0;l.logger=E("ydn.db.core.req.AbstractCursor");
function zg(a,b){a.R(b);Ag(a);a.F=!0}l.ba=function(a,b,c){null==a&&(J(this.logger,this+" finished."),this.F=!0);this.a=a;this.c=b;this.l=c;this.xa++;this.F?(I(this.logger,this+" DONE."),this.K(),Ag(this)):(I(this.logger,this+" new cursor position {"+(this.g?this.a+", "+this.c:this.a)+"}"),this.K(this.a))};l.ja=function(){this.f=null};l.toString=function(){return"Cursor:"+this.H+(t(this.W)?":"+this.W:"")+"["+(this.f?"":"~")+this.Wb+"]"};
function Ag(a){null!=a.c?a.c=pe(a.c):a.c=void 0;null!=a.a?a.a=pe(a.a):a.a=void 0;a.Vb(a.V,a.a,a.c)}l.open=function(a,b,c,d){this.f=a;this.Wb=b;this.F=this.V=!1;this.a=c;this.c=d;this.openCursor(this.a,this.c)};function Bg(a){a.V=!0;I(a.logger,a+": exit");Ag(a)}l.Ib=function(){return this.xa};l.Rc=function(){return this.a};l.A=function(){return this.g?this.c:this.a};l.O=function(){return this.La?this.A():this.l};l.Ya=function(){};l.va=function(){};
function Cg(a,b,c){I(a.logger,a+" restarting");a.F=!1;a.V=!1;a.openCursor(c,b)};function Dg(){};function X(a,b,c,d,e,f,g){if(!x(a))throw new TypeError("store name must be a string, but "+a+" found.");this.g=a;this.b=b;this.h=g;this.u=!!this.b;if(t(d)&&!da(d))throw new K("reverse value must be a boolean, but "+typeof d+" found");if(t(e)&&!da(e))throw new K("unique value must be a boolean, but "+typeof e+" found");if(t(f)&&!da(f))throw new K("key_only value must be a boolean, but "+typeof f+" found");this.c=t(f)?f:!!x(this.b);a="next";d&&e?a="prevunique":d?a="prev":e&&(a="nextunique");this.l=
a;if(d=ze(c))throw new K("Invalid key range: "+d);this.a=se(c);this.f=Eg;this.F=NaN}C(X,Dg);X.prototype.c=!0;function Fg(a,b,c){if(3<arguments.length)throw new K("too many argument");X.call(this,a,void 0,b,c,void 0,!0)}C(Fg,X);function Gg(a,b,c,d,e){if(!x(b))throw new K("index name must be string");X.call(this,a,b,c,d,e,!0)}C(Gg,X);function Hg(a,b,c){if(3<arguments.length)throw new K("too many argument");X.call(this,a,void 0,b,c,void 0,!1)}C(Hg,X);
function Ig(a,b,c,d,e){if(!x(b))throw new K("index name must be string");X.call(this,a,b,c,d,e,!1)}C(Ig,X);var Eg="init";l=X.prototype;l.logger=E("ydn.db.Iterator");l.j=function(){return this.g};l.Ic=function(){return this.b};l.pc=function(){return this.a?this.a instanceof ye?this.a:ye.bound(this.a.lower,this.a.upper,this.a.lowerOpen,this.a.upperOpen):null};l.Kc=function(){return this.c};l.yc=function(){return this.u};
l.clone=function(){var a=new X(this.g,this.b,this.a,this.ha(),this.Ea(),this.c,this.h);a.F=this.F;return a};l.unique=function(a){return new X(this.g,this.b,this.a,this.ha(),a,this.c,this.h)};l.toJSON=function(){return{store:this.g,index:this.b,keyRange:this.a?qe(this.a):null,direction:this.l}};
l.toString=function(){var a=t(this.h)?":"+this.h.join(","):t(this.b)?":"+this.b:"",a=a+Ae(this.a);this.f!=Eg&&(a+=this.f+"{"+this.i,this.u&&(a+=", "+this.o),a+="}");var b=this.u?"Index":"",b=b+(this.c?"Key":"Value");return b+"Iterator:"+this.g+a};l.qc=function(a,b){var c=new X(this.g,this.b,this.a,this.ha(),this.Ea(),this.c,this.h);c.i=a;c.o=b;c.f="rest";return c};l.reverse=function(){return new X(this.g,this.b,this.a,!this.ha(),this.Ea(),this.c,this.h)};
l.ha=function(){return"prev"===this.l||"prevunique"===this.l};l.Ea=function(){return"nextunique"===this.l||"prevunique"===this.l};l.xc=function(){return this.f};l.load=function(a){a=a[0];a.Ub(this.g,this.h||this.b,this.a,this.l,this.c);this.f="busy";var b=this;a.Vb=function(a,d,e){b.i=d;b.o=e;b.f=a?"rest":"done"};a.openCursor(this.i,this.o);return a};l.Jc=function(){return this.i};l.A=function(){return this.o};
l.Pb=function(a,b,c){a=a||Eg;"busy"==this.f?F(this.logger,this+": resetting state to "+a+" ignore during iteration"):(this.i=b,this.o=c,this.f=a)};l.stores=function(){return[this.g]};function Jg(a,b,c,d){if("transaction"in a)this.i=a,this.c=this.h=null;else if("objectStore"in a){if(this.i=null,this.h=a.db,this.c=a,!this.c.db.objectStoreNames.contains(b))throw new yf('store "'+b+'" not in transaction.');}else throw new yf("storage instance require.");this.l=b;this.o=c;this.u=d;this.b=[];this.a=0;this.g=!1}Jg.prototype.logger=E("ydn.db.con.IdbCursorStream");Jg.prototype.g=!1;
function Kg(a,b){a.a++;b.onsuccess=function(b){if(b=b.target.result){if(ea(a.u)){var d=b.value;a.u(b.primaryKey,null!=a.o?d[a.o]:d)}else F(a.logger,"sink gone, dropping value for: "+b.primaryKey);if(b&&0<a.b.length)b["continue"](a.b.shift());else a.a--,0==a.a&&a.ia&&a.ia()}};b.onerror=function(){F(a.logger,"seeking fail. "+("error"in b?b.error.name+":"+b.error.message:""));a.a--;0==a.a&&a.ia&&a.ia()}}function Lg(a,b){0==a.b.length&&0==a.a?b():a.ia=b}
function Mg(a){if(!a.g){var b=function(b,c){a.c=null;"complete"!==b&&F(a.logger,c.name+":"+c.message);I(a.logger,a+" transaction "+b)},c=function(b){var c=a.b.shift();I(a.logger,a+" transaction started for "+c);b=b.objectStore(a.l);Kg(a,b.openCursor(c))};if(a.c)I(a.logger,a+" using existing tx."),c(a.c);else if(a.h)I(a.logger,a+" creating tx from IDBDatabase."),a.f=a.h.transaction([a.l],Cd),a.f.oncomplete=function(a){b("complete",a)},a.f.onerror=function(a){b("error",a)},a.f.onabort=function(a){b("abort",
a)};else if(a.i)I(a.logger,a+" creating tx from ydn.db.con.IStorage."),a.g=!0,a.i.transaction(function(b){a.g=!1;c(b)},[a.l],Cd,b);else throw new Bf("no way to create a transaction provided.");}};function Ng(a,b,c){a&&a instanceof Gf?this.Ua=a:a&&a.db&&(this.Ua=null,Og(this,a));if(!x(b))throw new K("a store name required.");this.c=b;if(t(c)&&!x(c))throw new K("projection index name must be a string.");this.Va=c;this.ua=null;this.b=[];this.a=[];this.Ka=!1}l=Ng.prototype;l.logger=E("ydn.db.Streamer");l.Ua=null;l.Rb=null;l.ua=null;l.Fc=function(a){this.Rb=a};function Og(a,b){if(b.db)a.ua=new Jg(b,a.c,a.Va,ka(a.ia,a));else throw new K("Invalid IndexedDB Transaction.");}
function Pg(a){var b=0<a.a.length;if(b&&!a.Ka&&ea(a.Rb)){var c=function(){Pg(a)},d=a.b.shift(),e=a.a.shift(),b=0<a.a.length,c=a.Rb(d,e,b?c:null);b&&!c&&Pg(a)}}l.Ka=!1;l.Oc=function(a){if(this.ua){this.Ka=!0;var b=this;Lg(this.ua,function(){a(b.b,b.a);b.b=[];b.a=[];b.Ka=!1})}else a(this.b,this.a),this.b=[],this.a=[]};l.ia=function(a,b){this.b.push(a);this.a.push(b);Pg(this)};
l.push=function(a,b){if(this.Ka)throw new Ef("push not allowed after a collection is started");if(2<=arguments.length)this.ia(a,b);else{if(!this.ua){if(!this.Ua)throw new Ef("Database connection is not setup.");var c=this.Ua.Xa();if(c)if("indexeddb"===c)this.ua=new Jg(this.Ua,this.c,this.Va,ka(this.ia,this));else throw new Af(c);else throw new Ef("Database is not connected.");}c=this.ua;c.b.push(a);Mg(c)}};l.j=function(){return this.c};l.toString=function(){return"Streamer:"+this.c+(this.Va||"")};function Qg(a,b){if(null!=a&&!("push"in a))throw new yf('output receiver object must have "push" method.');this.a=a||null;this.i=b;this.g=0;this.b=!1;this.f=a instanceof Ng&&!!a.Va}Qg.prototype.logger=E("ydn.db.algo.AbstractSolver");
Qg.prototype.h=function(a,b){this.b=b[0].ha();for(var c=0;c<b.length;c++){if(!(b[c]instanceof X))throw new ud("item at iterators "+c+" is not an iterator.");if(0<c&&this.b!=b[c].ha())throw new ud("iterator at "+c+" must "+(this.b?"be reverse":"not be reverse"));}this.a instanceof Ng&&Og(this.a,a);if(this.f&&(c=b[0].h)&&1<c.length&&c[c.length-1]!=this.a.Va)throw new Ef("Output streamer projection field must be same as postfix field in the iterator");for(var d="{",c=0;c<b.length;c++)0<c&&(d+=", "),
d+=b.toString();d+="}";this.b&&(d+=" reverse");td(this.logger,this+" begin "+d);return!1};function Rg(a,b,c){var d,e=null!=d;if(!t(d)){d=c[0];for(var e=null!=d,f=1;e&&f<c.length;f++)null!=c[f]&&0==Q(c[f],d)||(e=!1)}return e&&(a.g++,a.a&&(a.f?a.a.push(d,void 0):a.a.push(d)),t(a.i)&&a.g>=a.i)?[]:b}Qg.prototype.c=function(){return[]};function Sg(a,b,c,d){ig.call(this,a,b,c,d)}C(Sg,V);l=Sg.prototype;l.logger=E("ydn.db.core.DbOperator");l.get=function(a,b){if(a instanceof X){var c=a.j(),d=T(this.b,c);if(!d)throw new K('store "'+c+'" not found.');var e=a.b;if(t(e)&&!We(d,e))throw new K('index "'+e+'" not found in store "'+c+'".');J(this.logger,"getByIterator:"+a);var f=this.a.request("get:iter",[c]);N(f,function(){Tg(this,5,f,a,1)},this);return f}return Sg.D.get.call(this,a,b)};
l.Na=function(a,b){var c=100;if(y(b)){if(c=b,1>c)throw new K("limit must be a positive value, but "+b);}else if(t(b))throw new K("limit must be a number,  but "+b);J(this.logger,"keysOf:"+a);var d=this.a.request("keys:iter",[a.j()]);N(d,function(){a.u?Tg(this,1,d,a,c):Tg(this,2,d,a,c)},this);return d};l.keys=function(a,b,c,d,e,f,g){return a instanceof X?this.Na(a,b):Sg.D.keys.call(this,a,b,c,d,e,f,g)};
l.Ja=function(a){J(this.logger,"countIterator:"+a);var b=this.a.request("count",[a.j()]);N(b,function(){Tg(this,6,b,a)},this);return b};l.count=function(a,b,c,d){if(a instanceof X){if(t(b)||t(c))throw new K("too many arguments.");return this.Ja(a)}return Sg.D.count.call(this,a,b,c,d)};
l.Sa=function(a,b){var c;if(y(b)){if(c=b,1>c)throw new K("limit must be a positive value, but "+c);}else if(t(b))throw new K("limit must be a number, but "+b);J(this.logger,"listByIterator:"+a);var d=this.a.request("values:iter",[a.j()]);N(d,function(){a.c?Tg(this,2,d,a,c):Tg(this,4,d,a,c)},this);return d};l.values=function(a,b,c,d,e,f){return a instanceof X?this.Sa(a,b):Sg.D.values.call(this,a,b,c,d,e,f)};
l.Tb=function(a,b,c){if(!v(b))throw new K("iterators argument must be an array, but "+b+" of type "+typeof b+" found");for(var d=0;d<b.length;d++)if(!(b[d]instanceof X))throw new K("Iterator at "+d+" must be cursor range iterator.");c=c||Cd;for(var e=[],d=0;d<b.length;d++)for(var f=b[d].stores(),g=0;g<f.length;g++)0<=Ma(e,f[g])||e.push(f[g]);J(this.logger,this+": scan for "+b.length+" iterators on "+e);var h=this,d=this.a.request("scan",e);this.a.Ga(d,function(c,d,e){function f(){for(var a=0,e=0;e<
b.length;e++){var n=b[e],p=[U(h).b(c,d,n.j())],n=n.load(p);n.R=g;n.K=la(u,a);ua[e]=n;G[a]=e;a++}H=b.length}function g(a){for(var b=0;b<ua.length;b++)Bg(ua[b]);Ta(ua);J(h.logger,A+" error");e(a,!0)}function u(c,d){if(B)throw new Bf;ca++;var f=ca===H,g=G[c],k=b[g],m=ua[g],g=m.A(),m=m.O();P[c]=d;ja[c]=k.u?k.c?g:m:k.c?d:m;if(f){var p;a instanceof Qg?p=a.c(P,ja):p=a(P,ja);f=[];k=[];g=[];m=[];if(v(p))for(var q=0;q<p.length;q++)!0===p[q]?g[q]=1:!1===p[q]?m[q]=!0:k[q]=p[q];else if(null===p)f=[];else if(t(p))if(z(p)){f=
["advance","continue","continuePrimary","restart"];for(q in p)if(!(0<=Ma(f,q)))throw new xd('Unknown attribute "'+q+'" in cursor advancement object');f=p.continuePrimary||[];k=p["continue"]||[];g=p.advance||[];m=p.restart||[]}else throw new xd("scan callback output");else for(f=[],q=0;q<b.length;q++)t(G[q])&&(g[q]=1);for(q=ca=p=0;q<b.length;q++)null!=f[q]||t(k[q])||null!=m[q]||null!=g[q]||ca++;for(q=0;q<b.length;q++)if(null!=f[q]||t(k[q])||null!=m[q]||null!=g[q]){var u=G[q];if(!t(u))throw new Df(q+
" is not an iterator.");var u=b[u],Vb=ua[q];if(null==P[q]){var Lf=q+"/"+b.length;if(null!=g[q])throw new Ef(Vb+" "+Lf+" must not advance "+g[q]+" steps");if(t(k[q]))throw new Ef(Vb+" "+Lf+" must not continue to key "+k[q]);if(null!=f[q])throw new Ef(Vb+" "+Lf+" must not continue to primary key "+f[q]);}P[q]=void 0;ja[q]=void 0;if(null!=m[q])Cg(Vb);else if(t(k[q]))Vb.va(k[q]);else if(null!=f[q])Vb.Ya(f[q]);else if(null!=g[q])Vb.advance(1);else throw new Bf(u+": has no action");p++}if(0==p){for(p=0;p<
ua.length;p++)Bg(ua[p]);B=!0;Ta(ua);J(h.logger,"success "+A);e(void 0)}}}var A=d+" "+h+" scanning";I(h.logger,A);var B=!1,H,G=[],P=[],ja=[],ua=[],ca=0;a instanceof Qg?a.h(c,b,function(){f()})||f():f()},e,c);return d};
l.open=function(a,b,c,d){if(!(b instanceof X))throw new K("Second argument must be cursor range iterator.");for(var e=b.stores(),f=0;f<e.length;f++)if(!T(this.b,e[f]))throw new K('Store "'+e[f]+'" not found.');c=c||Cd;var g=this,h=this.a.request("open",b.stores(),c);J(this.logger,"open:"+c+" "+b);N(h,function(c){var e=O(h);J(g.logger,e+" iterating "+b);for(var f=b.stores(),p=[],q=0;q<f.length;q++)p[q]=U(g).b(c,e,f[q]);var u=b.load(p);u.R=function(a){M(h,a,!0)};u.K=function(b){null!=b?(b=a.call(d,
u),!0===b?Cg(u):z(b)?!0===b.restart?Cg(u,b["continue"],b.continuePrimary):null!=b["continue"]?u.va(b["continue"]):null!=b.continuePrimary?u.Ya(b.continuePrimary):(Bg(u),M(h,void 0)):null===b?(Bg(u),M(h,void 0)):null!=b?u.va(b):u.advance(1)):(Bg(u),M(h,void 0))}},this);return h};
function Ug(a,b,c,d){var e=c.j(),f=c.b||null,g=d||100;J(a.logger,"listIter:"+b+" "+c+(d?" limit="+g:"")+"");var h=a.a.request("values:iter:index",[e]),k="done"==c.f||c.f==Eg?[]:[c.i,c.A()];N(h,function(){U(this).Z(h,b,e,f,c.pc(),g,0,c.ha(),c.Ea(),k)},a);h.L(function(){null!=k[0]?c.Pb("rest",k[0],k[1]):c.Pb()});return h}
function Tg(a,b,c,d,e){var f=[],g=c.a,h=O(c),k=h+" "+b+"ByIterator "+d;0<e&&(k+=" limit "+e);J(a.logger,k);for(var m=U(a),n=[],p=d.stores(),q=0;q<p.length;q++)n[q]=m.b(g,h,p[q]);var u=d.load(n);u.R=function(a){Bg(u);M(c,a,!0)};var A=0,B=!1;u.K=function(d){B||(I(a.logger,k+" starting"),B=!0);null!=d?(u.A(),A++,1==b?f.push(d):2==b?f.push(u.A()):3==b?f.push([d,u.A()]):6!=b&&f.push(u.O()),5==b?(Bg(u),M(c,f[0])):6==b||!t(e)||A<e?u.va():(J(a.logger,"success:"+k+" yields "+f.length+" records"),Bg(u),M(c,
f))):(J(a.logger,"success:"+k+" yields "+f.length+" records"),Bg(u),M(c,5==b?f[0]:6==b?A:f))}};function Vg(a,b,c){W.call(this,a,b,c)}C(Vg,W);l=Vg.prototype;l.Aa=function(a,b){return new Sg(this,this.b,a,b)};l.open=function(a,b,c,d){return this.a.open(a,b,c,d)};l.Ja=function(a){return this.a.Ja(a)};l.Sa=function(a,b){return this.a.Sa(a,b)};l.Na=function(a,b){return this.a.Na(a,b)};l.Qc=function(a,b){return this.a.Tb(a,b)};function Wg(a){if(!x(a))throw new yf;this.U=a;this.f=L;this.a=[];Xg(this,a);this.Ta=""}l=Wg.prototype;l.U="";l.hc=NaN;l.ic=NaN;l.Qb=!1;l.Ta="";
function Xg(a,b){var c=b.split(/\sFROM\s/i);if(2==c.length){var d=c[1],c=c[0].match(/\s*?(SELECT|INSERT|UPDATE|DELETE)\s+(.*)/i);if(3==c.length){a.g=c[1].toUpperCase();if("SELECT"==a.g)a.f=Cd;else if("INSERT"==a.g)a.f=L;else if("UPDATE"==a.g)a.f=L;else if("DELETE"==a.g)a.f=L;else return;var c=c[2].trim(),e=c.match(/^(MIN|MAX|COUNT|AVG|SUM)/i);e?(a.c=e[0].toUpperCase(),c=c.replace(/^(MIN|MAX|COUNT|AVG|SUM)/i,"").trim()):a.c=void 0;"("==c.charAt(0)&&(")"==c.charAt(c.length-1)?c=c.substring(1,c.length-
1):new Wf("missing closing parentheses"));a.o=c;c=d.search(/(ORDER BY|LIMIT|OFFSET)/i);0<c?(a.b=d.substring(c),d=d.substring(0,c)):a.b="";c=d.search(/WHERE/i);0<c?(a.h=d.substring(c+6).trim(),d=d.substring(0,c)):a.h="";a.a=d.trim().split(",").map(function(a){a=Ea(a,'"');a=Ea(a,"'");return a.trim()})}}}
function Yg(a,b){if(b){for(var c=0;c<b.length;c++)a.U=a.U.replace("?",b[c]);Xg(a,a.U)}a.i=Zg(a);if(!a.i)return a.Ta;var c=a.b.length,d=/OFFSET\s+(\d+)/i.exec(a.b);d&&(a.ic=parseInt(d[1],10),c=a.b.search(/OFFSET/i));if(d=/LIMIT\s+(\d+)/i.exec(a.b))a.hc=parseInt(d[1],10),d=a.b.search(/LIMIT/i),d<c&&(c=d);(c=/ORDER BY\s+(.+)/i.exec(a.b.substr(0,c)))?(c=c[1].trim(),(d=c.match(/(ASC|DESC)/i))?(a.Qb="DESC"==d[0].toUpperCase(),c=c.replace(/\s+(ASC|DESC)/i,"")):a.Qb=!1,a.l=Ea(Ea(c,'"'),"'")):a.l=void 0;return""}
function $g(a){if("*"==a.o)return null;a=a.o.split(",");return a=a.map(function(a){return Ea(a.trim(),'"')})}l.toJSON=function(){return{sql:this.U}};
function Zg(a){function b(a){return Sa(c,function(b){return b.qa==a})}var c=[],d=/(.+?)(<=|>=|=|>|<)(.+)/i;if(0<a.h.length)for(var e=a.h.split("AND"),f=0;f<e.length;f++){var g=e[f],h=d.exec(g);if(h){var k=h[1].trim(),k=Ea(k,'"'),k=Ea(k,"'");if(0<k.length){var m=h[3].trim();0==m.lastIndexOf('"',0)?m=Ea(m,'"'):0==m.lastIndexOf("'",0)?m=Ea(m,"'"):m=parseFloat(m);h=new xg(k,h[2],m);k=b(k);if(0<=k){if(c[k]=c[k].oa(h),!c[k])return a.Ta='where clause "'+g+'" conflict',null}else c.push(h)}else return a.Ta=
'Invalid clause "'+g+'"',null}else return a.Ta='Invalid clause "'+g+'"',null}return c}l.toString=function(){return"query:"+this.U};function ah(a,b,c,d){yg.call(this,a,b,c,d);this.h=null}C(ah,yg);l=ah.prototype;l.logger=E("ydn.db.core.req.IDBCursor");l.fb=function(a){(a=a.target.result)?this.ba(a.key,a.primaryKey,a.value):this.ba()};
l.openCursor=function(a,b){function c(a,b,c){p.h=n;p.h.onsuccess=ka(p.fb,p);p.ba(a,p.g?b:void 0,c);n=null}var d=this+" opening ";null!=a&&(d+="{"+a,d=null!=b?d+(";"+b+"}"):d+"}");I(this.logger,d);var e=this.B,d=this.f.objectStore(this.H),f=x(this.W)?d.index(this.W):null;if(t(a))var g=f?!t(b):!0,h=e?e.lower:void 0,k=e?e.upper:void 0,m=e?!!e.lowerOpen:!1,e=e?!!e.upperOpen:!1,e=re(this.reverse?new R(h,a,m,g):new R(a,k,g,e));var n;this.La?f?n=null!=this.da?f.openKeyCursor(e,this.da):null!=e?f.openKeyCursor(e):
f.openKeyCursor():n=null!=this.da?d.openCursor(e,this.da):null!=e?d.openCursor(e):d.openCursor():f?n=null!=this.da?f.openCursor(e,this.da):null!=e?f.openCursor(e):f.openCursor():n=null!=this.da?d.openCursor(e,this.da):null!=e?d.openCursor(e):d.openCursor();var p=this;n.onerror=function(a){var b=n.error;a.preventDefault();zg(p,b)};null!=a?n.onsuccess=function(d){if(d=d.target.result){var e=Ed.cmp(d.key,a),f=p.reverse?-1:1;if(e==f)c(d.key,d.primaryKey,d.value);else if(e==-f)d["continue"](a);else if(null!=
b)if(Ed.cmp(d.primaryKey,b)==f)c(d.key,d.primaryKey,d.value);else d["continue"]();else d["continue"]()}else c()}:(p.h=n,p.h.onsuccess=ka(p.fb,p))};l.lb=function(){return!!this.h};l.update=function(a){var b=this.h.result;if(b){var c=new D;a=b.update(a);a.onsuccess=function(a){c.callback(a.target.result)};a.onerror=function(a){a.preventDefault();c.s(a)};return c}throw new Sf("cursor gone");};
l.clear=function(){var a=this.h.result;if(a){var b=new D,a=a["delete"]();a.onsuccess=function(){b.callback(1)};a.onerror=function(a){a.preventDefault();b.s(a)};return b}throw new Sf("cursor gone");};l.advance=function(a){var b=this.h.result;if(1==a)b["continue"]();else b.advance(a)};
l.Ya=function(a){var b=this.h.result,c=Ed.cmp(a,b.primaryKey);if(c!=(this.reverse?-1:1))throw new yd('continuing primary key "'+a+'" must '+(this.reverse?"lower":"higher")+' than current primary key "'+b.primaryKey+'"');var d=this;this.h.onsuccess=function(e){if(b=e.target.result)if(c=Ed.cmp(b.primaryKey,a),0==c||1==c&&!d.reverse||-1==c&&d.reverse)d.h.onsuccess=ka(d.fb,d),d.ba(b.key,d.g?b.primaryKey:void 0,b.value);else b["continue"]();else d.h.onsuccess=ka(d.fb,d),d.ba()};b["continue"]()};
l.va=function(a){var b=this.h.result;if(null!=a)b["continue"](a);else b["continue"]()};l.ja=function(){ah.D.ja.call(this);this.h=null};l.toString=function(){return"IDB"+ah.D.toString.call(this)};function bh(a,b){this.a=b}C(bh,Yf);l=bh.prototype;l.logger=E("ydn.db.crud.req.IndexedDb");l.eb=function(a,b){function c(e){var f=a.a.objectStore(b[e]).count();f.onsuccess=function(f){d[e]=f.target.result;e++;e==b.length?M(a,d):c(e)};f.onerror=function(b){b.preventDefault();M(a,f.error,!0)}}var d=[];0==b.length?M(a,[]):c(0)};
l.S=function(a,b,c,d,e,f){function g(u){if(null==e[u])if(I(n.logger,"empty object at "+u+" of "+e.length),k++,k==e.length)M(a,h,m);else{var B=u+10;B<e.length&&g(B)}var H,B=e[u];H=f&&null!=f[u]?b?q.put(B,f[u]):q.add(B,f[u]):b?q.put(B):q.add(B);H.onsuccess=function(b){k++;h[u]=b.target.result;k==e.length?M(a,c?h[0]:h,m):(b=u+10,b<e.length&&g(b))};H.onerror=function(b){k++;var f=H.error;I(n.logger,O(a)+p+' request to "'+d+'" cause '+f.name+' for object "'+mf(e[u])+'" at index '+u+" of "+e.length+" objects.");
h[u]=f;m=!0;b.preventDefault();k==e.length?M(a,c?h[0]:h,m):(b=u+10,b<e.length&&g(b))}}var h=[],k=0,m=!1,n=this,p=b?"put":"add",q=a.a.objectStore(d);I(this.logger,O(a)+" "+p+" "+e.length+' objects to store "'+d+'"');if(0<e.length)for(var u=0;10>u&&u<e.length;u++)g(u);else M(a,[])};
l.tb=function(a,b,c){function d(k){var n=c[k],p=n.j(),q=a.a.objectStore(p),u;u=null===q.keyPath?q.put(b[k],n.G()):q.put(b[k]);u.onsuccess=function(c){f++;e[k]=c.target.result;f==b.length?M(a,e,g):(c=k+10,c<b.length&&d(c))};u.onerror=function(c){f++;F(h.logger,"request result "+c.name+' error when put keys to "'+p+'" for object "'+mf(b[k])+'" at index '+k+" of "+b.length+" objects.");e[k]=u.error;g=!0;c.preventDefault();f==b.length?M(a,e,g):(c=k+10,c<b.length&&d(c))}}var e=[],f=0,g=!1,h=this;I(this.logger,
O(a)+" putByKeys: of "+b.length+" objects");if(0<b.length)for(var k=0;10>k&&k<b.length;k++)d(k);else M(a,e,g)};l.ub=function(a,b,c){var d=a.a.objectStore(b);I(this.logger,O(a)+" clearById: "+b+" "+c);var e=d.openCursor(ye.only(c));e.onsuccess=function(b){if(b=b.target.result){var c=b["delete"]();c.onsuccess=function(){M(a,1)};c.onerror=function(){M(a,c.error,!0)}}else M(a,0)};e.onerror=function(b){b.preventDefault();M(a,e.error,!0)}};
l.vb=function(a,b){function c(h){h++;if(h>=b.length)0<g.length?M(a,g,!0):M(a,d);else{b[h].j()!=e&&(e=b[h].j(),f=a.a.objectStore(e));var k=f["delete"](b[h].G());k.onsuccess=function(){d++;c(h)};k.onerror=function(a){a.preventDefault();g[h]=k.error;c(h)}}}var d=0,e,f;I(this.logger,O(a)+" removeByKeys: "+b.length+" keys");var g=[];c(-1)};
l.Oa=function(a,b,c){var d=a.a.objectStore(b),e=d.count(c);I(this.logger,O(a)+" clearByKeyRange: "+b+" "+c);e.onsuccess=function(b){var e=b.target.result,h=d["delete"](c);h.onsuccess=function(){M(a,e)};h.onerror=function(){M(a,h.error,!0)}};e.onerror=function(b){b.preventDefault();M(a,e.error,!0)}};l.Eb=function(a,b,c){var d=a.a.objectStore(b);I(this.logger,O(a)+" "+b+" "+c);var e=d["delete"](c);e.onsuccess=function(){M(a,void 0)};e.onerror=function(b){b.preventDefault();M(a,e.error,!0)}};
l.Ob=function(a,b,c,d){var e=a.a.objectStore(b).index(c);I(this.logger,O(a)+" clearByIndexKeyRange: "+b+":"+c+" "+d);var f=[],g=e.openCursor(d),h=0;g.onsuccess=function(b){var c=b.target.result;if(c){var d=c["delete"]();d.onsuccess=function(){h++;c["continue"]()};d.onerror=function(a){f.push(d.error);a.preventDefault();c["continue"]()}}else 0<f.length?M(a,f,!0):M(a,h)};g.onerror=function(b){b.preventDefault();M(a,g.error,!0)}};
l.bb=function(a,b){var c=b.length,d=0;I(this.logger,O(a)+" clearByStores: "+b);for(var e=0;e<c;e++){var f=a.a.objectStore(b[e]).clear();f.onsuccess=function(){d++;d==c&&M(a,d)};f.onerror=function(b){d++;b.preventDefault();d==c&&M(a,f.error,!0)}}};
l.ib=function(a,b,c){var d=this;I(this.logger,O(a)+b+":"+c);var e=a.a.objectStore(b),f=e.get(c);f.onsuccess=function(b){I(d.logger,O(a)+" record "+c+(null!=b.target.result?" ":" not ")+" exists.");var f=b.target.result;if(!e.keyPath&&0==e.indexNames.length&&Nc&&x(f)&&0<=f.indexOf(";base64,")){'"'==f.charAt(0)&&'"'==f.charAt(f.length-1)&&(f=f.substr(1,f.length-2));f=f.split(";base64,");b=f[0].split(":")[1];for(var f=window.atob(f[1]),k=f.length,m=new Uint8Array(k),n=0;n<k;++n)m[n]=f.charCodeAt(n);
M(a,new Blob([m.buffer],{type:b}))}else M(a,b.target.result)};f.onerror=function(b){b.preventDefault();M(a,f.error,!0)}};
l.Nb=function(a,b,c){function d(b){if(null==c[b])if(f++,e[b]=void 0,f==h)M(a,e);else{var m=b+10;m<h&&d(m)}var n;n=g.get(c[b]);n.onsuccess=function(c){f++;e[b]=c.target.result;f==h?M(a,e):(c=b+10,c<h&&d(c))};n.onerror=function(b){f++;b.preventDefault();M(a,n.error,!0)}}var e=[];e.length=c.length;var f=0,g=a.a.objectStore(b),h=c.length;I(this.logger,O(a)+" "+b+":"+h+" ids");if(0<h)for(b=0;10>b&&b<h;b++)d(b);else M(a,[])};
l.ob=function(a,b){function c(f){var h=b[f],k=a.a.objectStore(h.j()).get(h.G());k.onsuccess=function(h){e++;d[f]=h.target.result;e==b.length?M(a,d):(h=f+10,h<b.length&&c(h))};k.onerror=function(b){e++;b.preventDefault();M(a,k.error,!0)}}var d=[];d.length=b.length;var e=0;I(this.logger,O(a)+" "+b.length+" ids");if(0<b.length)for(var f=0;10>f&&f<b.length;f++)c(f);else M(a,[])};
l.Ia=function(a,b,c,d,e){if(d&&e)throw new xd("unique count not available in IndexedDB");e=a.a.objectStore(b);b=O(a)+" "+b+(d?":"+d:"")+(c?":"+S(c):"");I(this.logger,b);var f;null!=d?(d=e.index(d),f=null!=c?d.count(c):d.count()):f=null!=c?e.count(c):e.count();f.onsuccess=function(b){M(a,b.target.result)};f.onerror=function(b){b.preventDefault();M(a,f.error,!0)}};
l.Z=function(a,b,c,d,e,f,g,h,k,m){var n=[],p=a.a.objectStore(c),q=h?k?"prevunique":"prev":k?"nextunique":"next";c=O(a)+" "+b+" "+c+(d?":"+d:"")+(e?S(e):"");h&&(c+=" reverse");k&&(c+=" unique");if(m&&t(m[0])){k=d?!t(m[1]):!0;var u=m[0],A=e?e.lower:void 0,B=e?e.upper:void 0,H=e?!!e.lowerOpen:!1;e=e?!!e.upperOpen:!1;e=re(h?new R(A,u,H,k):new R(u,B,k,e));c+=" starting from "+S(m[0]);t(m[1])&&(c+=", "+S(m[1]))}I(this.logger,c);var G;G=1==b||2==b||3==b?d?p.index(d).openKeyCursor(e,q):p.openCursor(e,q):
d?p.index(d).openCursor(e,q):p.openCursor(e,q);var P=!1;G.onsuccess=function(c){if(c=c.target.result){if(!P){if(0<g){P=!0;c.advance(g);return}if(m&&d&&t(m[0]))if(t(m[1])){var e=Ed.cmp(c.key,m[0]),k=h?-1:1;if(0==e){e=Ed.cmp(c.primaryKey,m[1]);if(0==e){P=!0;c["continue"]();return}if(e==k)P=!0;else{c["continue"]();return}}else P=!0}else P=!0;else P=!0}1==b?n.push(c.key):2==b?n.push(c.primaryKey):3==b?(k={},d&&(k[d]=c.key),p.keyPath?k[p.keyPath]=c.primaryKey:k._ROWID_=c.primaryKey,n.push(k)):4==b?n.push(c.value):
n.push([c.key,c.primaryKey,c.value]);if(n.length<f)c["continue"]();else m&&(m[0]=pe(c.key),m[1]=pe(c.primaryKey)),M(a,n)}else m&&(m[0]=void 0,m[1]=void 0),M(a,n)};G.onerror=function(b){b.preventDefault();M(a,G.error,!0)}};function ch(a,b){this.a=b}C(ch,bh);ch.prototype.logger=E("ydn.db.core.req.IndexedDb");ch.prototype.b=function(a,b,c,d){c=T(this.a,c);return new ah(a,b,c,d)};function dh(a,b){this.a=b;this.c=a}dh.prototype.logger=E("ydn.db.sql.req.nosql.Node");dh.prototype.toJSON=function(){return{sql:this.a}};dh.prototype.toString=function(){return"idb.Node:"};
dh.prototype.b=function(a,b){var c=Va(this.a.a)[0],d=this.a.i,e=this.a.hc,e=isNaN(e)?100:e,f=this.a.ic,f=isNaN(f)?0:f,g=this.a.l,h=$g(this.a),k=null,m=this.a.Qb;if(0==d.length)k=null;else if(1==d.length)k=se(d[0].a);else throw new vd("too many conditions.");null===h||Wd(a,function(a,b,c){var d=a;b||(d=a.map(function(a){var b=h.length;if(1==b)return Fd(a,h[0]);for(var c={},d=0;d<b;d++)c[h[d]]=Fd(a,h[d]);return c}));c(d,b)});var d=0<d.length?d[0].qa:void 0,n=O(a)+" executing on"+c;d&&(n+=":"+d);n+=
" "+Ae(k);J(this.logger,n);g&&g!=this.c.keyPath?b.Z(a,4,c,g,k,e,f,m,!1):t(d)&&d!=this.c.keyPath?b.Z(a,4,c,d,k,e,f,m,!1):b.Z(a,4,c,null,k,e,f,m,!1)};function eh(a,b){dh.call(this,a,b)}C(eh,dh);
eh.prototype.b=function(a,b){var c,d=Va(this.a.a)[0],e=this.a.i,f=null;if(0==e.length)f=null;else if(1==e.length)f=se(e[0].a);else throw new vd("too many conditions.");var g=this.a.c,e=0<e.length?e[0].qa:void 0,h=O(a)+" executing "+g+" on "+d;e&&(h+=":"+e);h+=" "+Ae(f);J(this.logger,h);if("COUNT"==g)f?b.Ia(a,d,f,e,!1):b.Ia(a,d,null,void 0,!1);else{var k,h=$g(this.a);if(!h||0==h.length)throw new Ef("field name require for reduce operation: "+g);h=h[0];if("MIN"==g)k=fh(h);else if("MAX"==g)k=gh(h);else if("AVG"==
g)c=0,k=hh(h);else if("SUM"==g)c=0,k=ih(h);else throw new zf(g);var m;t(e)?m=new Ig(d,e,f):m=new Hg(d,f);var d=b.b(a.a,O(a),d,4),n=m.load([d]);n.R=function(b){M(a,b,!0)};var p=0;n.K=function(b){null!=b?(b=m.c?n.A():n.O(),c=k(b,c,p),n.advance(1),p++):M(a,c)}}};function hh(a){return function(b,c,d){t(c)||(c=0);return(c*d+b[a])/(d+1)}}function ih(a){return function(b,c){return c+b[a]}}function fh(a){return function(b,c){var d=b[a];return t(c)?c<d?c:d:d}}
function gh(a){return function(b,c){var d=b[a];return t(c)?c>d?c:d:d}};function jg(a,b){this.a=b}C(jg,ch);jg.prototype.logger=E("ydn.db.sql.req.IndexedDb");jg.prototype.executeSql=function(a,b,c){if(c=Yg(b,c))throw new Wf(c);c=Va(b.a);if(1==c.length){var d=T(this.a,c[0]);if(!d)throw new Tf(c[0]);var e=$g(b);if(e)for(var f=0;f<e.length;f++)if(!We(d,e[f]))throw new Tf('Index "'+e[f]+'" not found in '+c[0]);var g;b.c?g=new eh(d,b):g=new dh(d,b);g.b(a,this)}else throw new zf(b.U);};function jh(a,b,c,d){yg.call(this,a,b,c,d);this.P=null;this.h=this.i=void 0}C(jh,yg);l=jh.prototype;l.logger=E("ydn.db.core.req.WebsqlCursor");l.A=function(){return this.h};l.Ub=function(a,b,c,d,e){jh.D.Ub.call(this,a,b,c,d,e);this.P=x(b)?Re(this.b,b):null};l.O=function(){return this.o};function kh(a,b){a.i=void 0;a.h=void 0;a.o=void 0;if(t(b))if(z(b)){var c=Je(b[a.b.g],a.b.type);a.h=c;if(a.g){var d=Re(a.b,a.W);a.i=Je(b[a.W],d.type)}else a.i=c;a.o=a.La?c:lh(b,a.b)}else a.o=b}
function mh(a,b,c){Re(a.b,a.W);var d=[],e=a.W,f=a.B,g=a.i;if(null!=f){var h=f.lower,k=f.upper,m=f.lowerOpen,n=f.upperOpen;a.reverse?k=null!=k&&-1==Q(k,g)?k:g:h=null!=h&&1==Q(h,g)?h:g;null!=h&&null!=k?f=ue(h,k,!!m,!!n):f=null!=h?ye.lowerBound(h,!!m):ye.upperBound(k,!!n)}else f=a.reverse?ye.upperBound(g):ye.lowerBound(g);e=Qe(a.b,d,a.u,e,f,a.reverse,a.unique);c=a.reverse?ye.upperBound(c,!1):ye.lowerBound(c,!1);c=Qe(a.b,d,a.u,a.b.g,c,a.reverse,a.unique);e.w=e.w?e.w+(" AND "+c.w):c.w;c="SELECT "+e.select+
" FROM "+e.aa+(e.w?" WHERE "+e.w:"")+(e.group?" GROUP BY "+e.group:"")+" ORDER BY "+e.ca;c+=" LIMIT 1";I(a.logger,a+": continuePrimary:  SQL: "+c+" : "+S(d));a.f.executeSql(c,d,function(c,d){0<d.rows.length?kh(a,d.rows.item(0)):kh(a);b.call(a,a.i,a.h,a.o);b=null},function(c,d){F(a.logger,"get error: "+d.message);zg(a,d);kh(a);b.call(a,a.h,a.i,a.o);b=null;return!1})}
function nh(a,b,c,d,e,f){var g=!d;d=[];a.g&&null!=f&&null!=c?c=Ue(a.b,a.u,d,a.P.getName(),a.B,c,g,f,a.reverse,a.unique):null!=c?(f=a.P?a.P.getName():null,c=Te(a.b,a.u,d,f,a.B,a.reverse,a.unique,c,g)):(c=Pe(a.b,d,a.u,a.g?a.P.f:a.b.g,a.B,a.reverse,a.unique),a.g&&(c+=", "+a.b.f+" ASC"));c+=" LIMIT 1";0<e&&(c+=" OFFSET "+e);I(a.logger,a+": continue:  SQL: "+c+" : "+S(d));a.f.executeSql(c,d,function(c,d){0<d.rows.length?kh(a,d.rows.item(0)):kh(a);b.call(a,a.i,a.h,a.o);b=null},function(c,d){F(a.logger,
"get error: "+d.message);zg(a,d);kh(a);b.call(a,a.h,a.i,a.o);b=null;return!1})}l.lb=function(){return!!this.f};l.update=function(a){if(!this.lb())throw new Sf;var b=new D,c=this.A();a=af(this.b,a,c);var d="REPLACE INTO "+Se(this.b)+" ("+a.cc.join(", ")+") VALUES ("+a.oc.join(", ")+")";I(this.logger,this+': update "'+d+'" : '+S(a.values));this.f.executeSql(d,a.values,function(){b.callback(c)},function(a,c){b.s(c);return!1});return b};
l.advance=function(a){var b=this.i,c=this.h,d=!0;null==this.i||this.g&&null==this.h||(--a,d=!1);nh(this,function(a,d,g){var h=null!=b&&null!=a&&0==Q(b,a);if(this.g){var k=null!=d&&null!=c&&0==Q(d,c);if(h&&k)throw new yd("current: "+b+";"+c+" next: "+a+";"+d);}else if(h)throw new yd("current: "+b+" next: "+a);this.ba(a,d,g)},this.i,d,a,this.h)};l.va=function(a){null!=a?nh(this,this.ba,a,!0):this.advance(1)};l.openCursor=function(a,b){nh(this,this.ba,a,!1,0,b)};
l.clear=function(){if(!this.lb())throw new Sf;var a=new D,b=this.b.g,b="DELETE FROM "+Se(this.b)+" WHERE "+b+" = ?",c=[this.A()];I(this.logger,this+': clear "'+b+'" : '+S(c));this.f.executeSql(b,c,function(b,c){a.callback(c.rowsAffected)},function(b,c){a.s(c);return!1});return a};l.Ya=function(a){var b=Q(a,this.h);if(0==b||1==b&&this.reverse||-1==b&&!this.reverse)throw new Ef(this+" to continuePrimaryKey  from "+this.h+" to "+a+" on "+this.da+" direction is wrong");mh(this,this.ba,a)};
l.toString=function(){return"WebSql"+jh.D.toString.call(this)};function oh(a,b){this.a=b}C(oh,Yf);l=oh.prototype;l.logger=E("ydn.db.crud.req.WebSql");
function lh(a,b){if(b.wa&&!b.keyPath&&0==b.a.length&&a._default_){var c=a._default_;if(-1==c.indexOf(";base64,"))return lf(c);'"'==c.charAt(0)&&'"'==c.charAt(c.length-1)&&(c=c.substr(1,c.length-2));for(var d=c.split(";base64,"),c=d[0].split(":")[1],d=window.atob(d[1]),e=d.length,f=new Uint8Array(e),g=0;g<e;++g)f[g]=d.charCodeAt(g);return new Blob([f.buffer],{type:c})}c=a._default_?lf(a._default_):{};null!=b.keyPath&&(d=Je(a[b.keyPath],b.type),null!=d&&$e(b,c,d));for(d=0;d<b.a.length;d++)e=b.index(d),
f=e.f,"_default_"==f||e.h||e.multiEntry||"DATE"!=e.type&&!b.wa||(f=Je(a[f],e.type),t(f)&&Ie(e,c,f));return c}
l.S=function(a,b,c,d,e,f){function g(b,d){if(null==e[b])if(I(m.logger,"empty object at "+b+" of "+e.length),p++,p==e.length)J(m.logger,q+" success "+q),M(a,n,u);else{var H=b+2;H<e.length&&g(H,d)}var G;G=t(f)?af(h,e[b],f[b]):af(h,e[b]);H=k+Se(h)+" ("+G.cc.join(", ")+") VALUES ("+G.oc.join(", ")+");";I(m.logger,O(a)+" SQL: "+H+" PARAMS: "+G.values+" REQ: "+b+" of "+e.length);d.executeSql(H,G.values,function(f,q){function H(b,c){var e="ydn.db.me:"+h.getName()+":"+b.getName(),e=k+Ha(e)+" ("+h.f+", "+
b.c+") VALUES (?, ?)",f=[Ce(ca,h.type),Ce(c,b.type)];I(m.logger,O(a)+" multiEntry "+e+" "+f);d.executeSql(e,f,function(){},function(a,b){F(m.logger,"multiEntry index insert error: "+b.message);return!1})}p++;var ca=t(G.key)?G.key:q.insertId;1>q.rowsAffected&&(u=!0,ca=new Pf(ca+" no-op"));for(var vb=0,je=h.a.length;vb<je;vb++){var Db=h.index(vb);if(Db.multiEntry)for(var Ub=Fd(e[b],Db.keyPath),ik=(Ub?Ub.length:0)||0,Kf=0;Kf<ik;Kf++)H(Db,Ub[Kf])}c?M(a,ca):(n[b]=ca,p==e.length?M(a,n,u):(vb=b+2,vb<e.length&&
g(vb,f)))},function(d,f){p++;u=!0;6==f.code?f.name="ConstraintError":F(m.logger,"error: "+f.message+" "+q);if(c)M(a,f,!0);else if(n[b]=f,p==e.length)I(m.logger,"success "+q),M(a,n,u);else{var h=b+2;h<e.length&&g(h,d)}return!1})}b=!b;var h=T(this.a,d),k=b?"INSERT INTO ":"INSERT OR REPLACE INTO ";d=a.a;var m=this,n=[],p=0,q=O(a)+" inserting "+e.length+" objects.",u=!1;if(0<e.length)for(b=0;2>b&&b<e.length;b++)g(b,d);else J(this.logger,"success"),M(a,[])};
l.tb=function(a,b,c){if(0==c.length)M(a,[]);else{for(var d=[],e=0,f=0,g=this,h=function(h,k){var m=[];I(g.logger,"put "+k.length+" objects to "+h);for(var n=Ye(T(g.a,h)),p=n?void 0:[],q=0;q<k.length;q++)m.push(b[k[q]]),n||p.push(c[k[q]].G());n=Td(a);Qb(n,function(b){for(var c=0;c<k.length;c++)d[k[c]]=b[c];e++;e==f&&M(a,d)},function(){e++;e==f&&M(a,d,!0)});g.S(n,!1,!1,h,m,p)},k="",m=[],n=[],p=0;p<c.length;p++){var q=c[p].j(),u=c[p].G();q!=k?(f++,0<m.length&&h(k,m),m=[p],n=[u],k=q):(m.push(p),n.push(u))}0<
m.length&&h(k,m)}};l.ib=function(a,b,c){var d=a.a,e=T(this.a,b),f=this;b=e.f;c=[Ce(c,e.type)];b="SELECT * FROM "+Se(e)+" WHERE "+b+" = ?";var g=O(a)+" SQL: "+b+" PARAMS: "+c;I(this.logger,g);d.executeSql(b,c,function(b,c){if(0<c.rows.length){var d=c.rows.item(0);null!=d?(d=lh(d,e),M(a,d)):(J(f.logger,"success no result: "+g),M(a,void 0))}else J(f.logger,"success no result: "+g),M(a,void 0)},function(b,c){F(f.logger,"error: "+g+" "+c.message);M(a,c,!0);return!1})};
l.Nb=function(a,b,c){function d(b,e){var p=k.f,q=[Ce(c[b],k.type)],u="SELECT * FROM "+Se(k)+" WHERE "+p+" = ?";I(f.logger,"SQL: "+u+" PARAMS: "+q);e.executeSql(u,q,function(e,f){h++;if(0<f.rows.length){var n=f.rows.item(0);null!=n&&(g[b]=lh(n,k))}else g[b]=void 0;h==c.length?M(a,g):(n=b+10,n<c.length&&d(n,e))},function(e,k){h++;F(f.logger,"error: "+u+" "+k.message);if(h==c.length)M(a,g);else{var n=b+10;n<c.length&&d(n,e)}return!1})}var e=a.a,f=this,g=[],h=0,k=T(this.a,b);if(0<c.length)for(b=0;10>
b&&b<c.length;b++)d(b,e);else J(f.logger,"success"),M(a,[])};
l.ob=function(a,b){function c(d,h){var n=b[d],p=n.j(),q=T(e.a,p),p=ne(n),n=q.f,p=[Ce(p,q.type)],u="SELECT * FROM "+Se(q)+" WHERE "+n+" = ?";I(e.logger,"SQL: "+u+" PARAMS: "+p);h.executeSql(u,p,function(h,m){g++;if(0<m.rows.length){var n=m.rows.item(0);null!=n&&(f[d]=lh(n,q))}else f[d]=void 0;g==b.length?(I(e.logger,"success "+u),M(a,f)):(n=d+10,n<b.length&&c(n,h))},function(b,c){M(a,c,!0);return!1})}var d=a.a,e=this,f=[],g=0;if(0<b.length)for(var h=0;10>h&&h<b.length;h++)c(h,d);else I(this.logger,
"success"),M(a,[])};
l.bb=function(a,b){function c(d,g){function h(a){a="ydn.db.me:"+k.getName()+":"+a.getName();a="DELETE FROM  "+Ha(a);I(e.logger,"SQL: "+a);g.executeSql(a,[])}var k=T(e.a,b[d]),m="DELETE FROM  "+Se(k);I(e.logger,"SQL: "+m+" PARAMS: []");g.executeSql(m,[],function(g){d==b.length-1?(I(e.logger,"success "+m),M(a,b.length)):c(d+1,g)},function(b,c){M(a,c,!0);return!1});for(var n=0,p=k.a.length;n<p;n++){var q=k.index(n);q.multiEntry&&h(q)}}var d=a.a,e=this;0<b.length?c(0,d):(I(this.logger,"success"),M(a,
0))};
l.vb=function(a,b){function c(h){if(h>=b.length)M(a,f,g);else{var k=T(e.a,b[h].j()),m=Ce(b[h].G(),k.type),n=" WHERE "+k.f+" = ?",p="DELETE FROM "+Se(k)+n,q=O(a)+" SQL: "+p+" PARAMS: "+[m];d.executeSql(p,[m],function(){f++;c(h)},function(a,b){F(e.logger,"error: "+q+b.message);g=!0;c(h);return!1});h++;for(var p=function(b){b="ydn.db.me:"+k.getName()+":"+b.getName();b="DELETE FROM  "+Ha(b)+n;I(e.logger,O(a)+NaN+b);d.executeSql(b,[m])},u=0,A=k.a.length;u<A;u++){var B=k.index(u);B.multiEntry&&p(B)}}}var d=
a.a,e=this,f=0,g=!1;I(this.logger,O(a)+" removeByKeys: "+b.length+" keys");c(0)};
l.ub=function(a,b,c){function d(b){b="ydn.db.me:"+f.getName()+":"+b.getName();b="DELETE FROM  "+Ha(b)+k;I(h.logger,O(a)+NaN+b);e.executeSql(b,[g])}var e=a.a,f=T(this.a,b),g=Ce(c,f.type),h=this,k=" WHERE "+f.f+" = ?";b="DELETE FROM "+Se(f)+k;I(this.logger,O(a)+" SQL: "+b+" PARAMS: "+[g]);e.executeSql(b,[g],function(b,c){M(a,c.rowsAffected)},function(b,c){M(a,c,!0);return!1});b=0;for(c=f.a.length;b<c;b++){var m=f.index(b);m.multiEntry&&d(m)}};l.Eb=function(a,b,c){ph(this,a,b,void 0,c)};
l.Oa=function(a,b,c){ph(this,a,b,void 0,c)};l.Ob=function(a,b,c,d){ph(this,a,b,c,d)};
function ph(a,b,c,d,e){function f(c){c="ydn.db.me:"+h.getName()+":"+c.getName();c="DELETE FROM  "+Ha(c)+n;I(a.logger,O(b)+NaN+c);g.executeSql(c,m)}var g=b.a,h=T(a.a,c);c="DELETE FROM "+Se(h);var k=[],m=[],n="";null!=e&&(t(d)?(d=Re(h,d),Be(d.c,d.type,e,m,k)):Be(h.f,h.type,e,m,k),n=" WHERE "+m.join(" AND "));c+=n;var p=O(b)+" SQL: "+c+" PARAMS: "+k;I(a.logger,p);g.executeSql(c,k,function(c,d){I(a.logger,"success "+p);M(b,d.rowsAffected)},function(c,d){F(a.logger,"error: "+p+d.message);M(b,d,!0);return!1});
e=0;for(d=h.a.length;e<d;e++)c=h.index(e),c.multiEntry&&f(c)}l.eb=function(a,b){function c(g){var h="SELECT COUNT(*) FROM "+Ha(b[g]);I(e.logger,"SQL: "+h+" PARAMS: []");d.executeSql(h,[],function(d,e){var h=e.rows.item(0);f[g]=parseInt(h["COUNT(*)"],10);g++;g==b.length?M(a,f):c(g)},function(b,c){M(a,c,!0);return!1})}var d=a.a,e=this,f=[];0==b.length?(I(this.logger,"success"),M(a,0)):c(0)};
l.Ia=function(a,b,c,d,e){var f=[];b=Pe(T(this.a,b),f,6,d,c,!1,e);I(this.logger,O(a)+" SQL: "+b+" PARAMS: "+f);a.a.executeSql(b,f,function(b,c){var d=c.rows.item(0);M(a,Ff(d))},function(b,c){M(a,c,!0);return!1})};
l.Z=function(a,b,c,d,e,f,g,h,k,m){var n=this,p=[],q=T(this.a,c),u=q.g,A=q.type,B=A,H=null!=d&&d!==u?Re(q,d):null,G=d||u;H&&(B=H.type);c=[];if(m&&t(m[0])){var P=m[0];H&&t(m[1])?(d=m[1],e=Ue(q,b,c,H.getName(),e,P,!0,d,h,k)):e=Te(q,b,c,d,e,h,k,P,!0)}else e=Pe(q,c,b,G,e,h,k);y(f)&&(e+=" LIMIT "+f);y(g)&&(e+=" OFFSET "+g);var ja=a+" SQL: "+e+" ;params= "+S(c);I(this.logger,ja);a.a.executeSql(e,c,function(c,d){for(var e=d.rows.length,f,g=0;g<e;g++)f=d.rows.item(g),2==b?p[g]=Je(f[u],A):1==b?p[g]=Je(f[G],
B):3==b?p[g]=[Je(f[G],B),Je(f[u],A)]:null!=f&&(p[g]=lh(f,q));J(n.logger,"success "+a);m&&f&&(m[0]=Je(f[G],B),m[1]=Je(f[u],A));M(a,p)},function(b,c){F(n.logger,"error: "+ja+c.message);M(a,c,!0);return!1})};function qh(a,b){this.a=b}C(qh,oh);qh.prototype.logger=E("ydn.db.core.req.WebSql");qh.prototype.b=function(a,b,c,d){c=T(this.a,c);return new jh(a,b,c,d)};function rh(a,b){this.b=b;this.f=a;this.a=$g(b)}rh.prototype.logger=E("ydn.db.sql.req.websql.Node");rh.prototype.toJSON=function(){return{sql:this.b.U}};rh.prototype.toString=function(){return"websql.Node:"};function sh(a,b){if(a.a){if(1==a.a.length){if(z(b))return ib(b,a.a[0]);return}for(var c={},d=0;d<a.a.length;d++)c[a.a[d]]=ib(b,a.a[d]);return c}return lh(b,a.f)}
rh.prototype.c=function(a,b,c){var d=this,e=[];b.executeSql(this.b.U,c,function(b,c){for(var h=c.rows.length,k=0;k<h;k++){var m=c.rows.item(k);if(z(m))var n=sh(d,m);e.push(n)}a(e)},function(b,c){F(d.logger,"Sqlite error: "+c.message);a(c,!0);return!0})};function th(a,b){rh.call(this,a,b)}C(th,rh);th.prototype.c=function(a,b,c){var d=this;b.executeSql(this.b.U,c,function(b,c){var d=c.rows.length;if(1==d)d=Ff(c.rows.item(0)),a(d);else if(0==d)a(void 0);else throw new Rf;},function(b,c){F(d.logger,"Sqlite error: "+c.message);a(c,!0);return!0})};function kg(a,b){this.a=b}C(kg,qh);kg.prototype.logger=E("ydn.db.sql.req.WebSql");kg.prototype.executeSql=function(a,b,c){var d=Va(b.a);if(1==d.length){var e=T(this.a,d[0]);if(!e)throw new Tf(d[0]);var f=$g(b);if(f)for(var g=0;g<f.length;g++)if(!We(e,f[g]))throw new Tf('Index "'+f[g]+'" not found in '+d[0]);var h;b.c?h=new th(e,b):h=new rh(e,b);h.c(function(b,c){M(a,b,c)},a.a,c)}else throw new zf(b.U);};function uh(){this.a=!1}uh.prototype.a=!1;uh.prototype.state=function(){return this.a};function vh(a,b,c,d){yg.call(this,a,b,c,d);this.l=this.c=this.a=void 0;this.i=this.h=null;this.o=new uh;this.wb=this.pa=null}C(vh,yg);l=vh.prototype;l.logger=E("ydn.db.core.req.SimpleCursor");l.lb=function(){return!!this.f};l.update=function(a){wh(this.wb,this.A(),a);return Yb()};l.advance=function(a){function b(b){d++;if(!b||d>=a)return xh(c,b)}var c=this,d=this.h?-1:0;this.reverse?yh(this.pa,b,this.h):zh(this.pa,b,this.h)};
l.va=function(a){if(null!=a){var b=this,c=new Y(a),d=function(c){b.h=c;if(!c)return xh(b,c);var d=Q(c.value.key,a);if(b.reverse){if(1!=d)return xh(b,c)}else if(-1!=d)return xh(b,c)};this.reverse?yh(this.pa,d,c):zh(this.pa,d,c)}else this.advance(1)};function Ah(a){setTimeout(function(){a.o.state()?(a.o.a=!1,a.ba(a.a,a.c,a.l),Ah(a)):(a.i(),a.i=null)},4)}
function xh(a,b){if(a.h=b){var c=b.value;if(a.B)if(a.reverse||null==a.B.upper)a.reverse&&null!=a.B.lower&&(d=Q(c.key,a.B.lower),-1==d||0==d&&a.B.lowerOpen)&&(a.h=null);else{var d=Q(c.key,a.B.upper);if(1==d||0==d&&a.B.upperOpen)a.h=null}if(a.h){if(a.unique&&null!=a.a&&null!=c.key&&0==Q(a.a,c.key))return;a.a=c.key;a.c=a.g?c.A():a.a;4==a.u&&(a.La?a.l=a.c:a.l=Bh(a.wb,a.c))}}a.h||(a.a=void 0,a.c=void 0,a.l=void 0);return a.o.a=!0}
l.openCursor=function(a,b){var c=null;if(this.B)if(this.reverse){var d=this.g?"\uffff":void 0;null!=this.B.upper&&(c=new Y(this.B.upper,d))}else null!=this.B.lower&&(c=new Y(this.B.lower));null!=a&&(c=this.g?new Y(a,b):new Y(a));this.i=this.f.m(function(b){function d(b){var e=b.value,f=e.key;if(b&&null!=f)if(null!=a){if(0==Ch(c,e))return}else if(this.B&&(!this.reverse&&this.B.lowerOpen&&null!=this.B.lower&&(e=Q(f,this.B.lower),0==e)||this.reverse&&this.B.upperOpen&&null!=this.B.upper&&(e=Q(f,this.B.upper),
0==e)))return;return xh(this,b)}this.wb=Dh(b,this.H);this.pa=Eh(this.wb,this.W);this.reverse?yh(this.pa,ka(d,this),c):zh(this.pa,ka(d,this),c);Ah(this)},this)};l.clear=function(){throw new wd;};l.Ya=function(){throw new wd;};l.toString=function(){return"Simple"+vh.D.toString.call(this)};function Fh(a,b,c){a=["ydn.db",a];t(b)&&(a.push(b),t(c)&&(a.push(c),t(void 0)&&a.push(Id(void 0))));return a.join("^|")};function Y(a,b){this.key=a;this.a=b}Y.prototype.A=function(){return this.a};Y.prototype.toString=function(){return"ydn.db.con.simple.Node("+this.key+(null!=this.a?", "+this.a+")":")")};function Ch(a,b){var c=Q(a.key,b.key);return 0===c?null!=a.a?null!=b.a?Q(a.a,b.a):1:null!=b.a?-1:0:c};function Gh(a){this.$=a||Hh}function Hh(a,b){return String(a)<String(b)?-1:String(a)>String(b)?1:0}l=Gh.prototype;l.I=null;l.$=null;l.ga=null;l.fa=null;
l.add=function(a){if(null==this.I)return this.fa=this.ga=this.I=new Ih(a),!0;var b=null;Jh(this,function(c){var d=null,e=this.$(c.value,a);0<e?(d=c.left,null==c.left&&(b=new Ih(a,c),c.left=b,c==this.ga&&(this.ga=b))):0>e&&(d=c.right,null==c.right&&(b=new Ih(a,c),c.right=b,c==this.fa&&(this.fa=b)));return d});b&&(Jh(this,function(a){a.count++;return a.parent},b.parent),Kh(this,b.parent));return!!b};
function Lh(a,b){Jh(a,function(a){var d=null,e=this.$(a.value,b);0<e?d=a.left:0>e?d=a.right:Mh(this,a);return d})}l.clear=function(){this.fa=this.ga=this.I=null};l.contains=function(a){var b=!1;Jh(this,function(c){var d=null,e=this.$(c.value,a);0<e?d=c.left:0>e?d=c.right:b=!0;return d});return b};l.indexOf=function(a){var b=-1,c=0;Jh(this,function(d){var e=this.$(d.value,a);if(0<e)return d.left;d.left&&(c+=d.left.count);if(0>e)return c++,d.right;b=c;return null});return b};
l.Ib=function(){return this.I?this.I.count:0};l.jb=function(){var a=[];Nh(this,function(b){a.push(b)});return a};function Nh(a,b){if(a.I){var c,d=c=Oh(a);for(c=c.left?c.left:c;null!=d;)if(null!=d.left&&d.left!=c&&d.right!=c)d=d.left;else{if(d.right!=c&&b(d.value))break;var e=d,d=null!=d.right&&d.right!=c?d.right:d.parent;c=e}}}function Jh(a,b,c){for(c=c?c:a.I;c&&null!=c;)c=b.call(a,c)}
function Kh(a,b){Jh(a,function(a){var b=a.left?a.left.height:0,e=a.right?a.right.height:0;1<b-e?(a.left.right&&(!a.left.left||a.left.left.height<a.left.right.height)&&Ph(this,a.left),Qh(this,a)):1<e-b&&(a.right.left&&(!a.right.right||a.right.right.height<a.right.left.height)&&Qh(this,a.right),Ph(this,a));b=a.left?a.left.height:0;e=a.right?a.right.height:0;a.height=Math.max(b,e)+1;return a.parent},b)}
function Ph(a,b){Rh(b)?(b.parent.left=b.right,b.right.parent=b.parent):Sh(b)?(b.parent.right=b.right,b.right.parent=b.parent):(a.I=b.right,a.I.parent=null);var c=b.right;b.right=b.right.left;null!=b.right&&(b.right.parent=b);c.left=b;b.parent=c;c.count=b.count;b.count-=(c.right?c.right.count:0)+1}
function Qh(a,b){Rh(b)?(b.parent.left=b.left,b.left.parent=b.parent):Sh(b)?(b.parent.right=b.left,b.left.parent=b.parent):(a.I=b.left,a.I.parent=null);var c=b.left;b.left=b.left.right;null!=b.left&&(b.left.parent=b);c.right=b;b.parent=c;c.count=b.count;b.count-=(c.left?c.left.count:0)+1}
function Mh(a,b){if(null!=b.left||null!=b.right){var c=null,d;if(null!=b.left){d=Th(a,b.left);Jh(a,function(a){a.count--;return a.parent},d);if(d!=b.left){if(d.parent.right=d.left)d.left.parent=d.parent;d.left=b.left;d.left.parent=d;c=d.parent}d.parent=b.parent;d.right=b.right;d.right&&(d.right.parent=d);b==a.fa&&(a.fa=d)}else{d=Oh(a,b.right);Jh(a,function(a){a.count--;return a.parent},d);if(d!=b.right){if(d.parent.left=d.right)d.right.parent=d.parent;d.right=b.right;d.right.parent=d;c=d.parent}d.parent=
b.parent;d.left=b.left;d.left&&(d.left.parent=d);b==a.ga&&(a.ga=d)}d.count=b.count;Rh(b)?b.parent.left=d:Sh(b)?b.parent.right=d:a.I=d;Kh(a,c?c:d)}else Jh(a,function(a){a.count--;return a.parent},b.parent),Rh(b)?(b.parent.left=null,b==a.ga&&(a.ga=b.parent),Kh(a,b.parent)):Sh(b)?(b.parent.right=null,b==a.fa&&(a.fa=b.parent),Kh(a,b.parent)):a.clear()}function Oh(a,b){if(!b)return a.ga;var c=b;Jh(a,function(a){var b=null;a.left&&(b=c=a.left);return b},b);return c}
function Th(a,b){if(!b)return a.fa;var c=b;Jh(a,function(a){var b=null;a.right&&(b=c=a.right);return b},b);return c}function Ih(a,b){this.value=a;this.parent=b?b:null;this.count=1}Ih.prototype.left=null;Ih.prototype.right=null;Ih.prototype.height=1;function Sh(a){return!!a.parent&&a.parent.right==a}function Rh(a){return!!a.parent&&a.parent.left==a};function Uh(a){this.$=a||Hh}C(Uh,Gh);function zh(a,b,c){if(a.I){var d;if(c instanceof Ih)d=c;else if(c){if(Jh(a,function(a){var b=null;0<this.$(a.value,c)?(b=a.left,d=a):0>this.$(a.value,c)?b=a.right:d=a;return b}),!d)return}else d=Oh(a);a=d;for(var e=d.left?d.left:d;null!=a;)if(null!=a.left&&a.left!=e&&a.right!=e)a=a.left;else{if(a.right!=e&&b(a))return;var f=a;a=null!=a.right&&a.right!=e?a.right:a.parent;e=f}b(null)}}
function yh(a,b,c){if(a.I){var d;if(c instanceof Ih)d=c;else if(c){if(Jh(a,ka(function(a){var b=null;0<this.$(a.value,c)?b=a.left:(0>this.$(a.value,c)&&(b=a.right),d=a);return b},a)),!d)return}else d=Th(a);a=d;for(var e=d.right?d.right:d;null!=a;)if(null!=a.right&&a.right!=e&&a.left!=e)a=a.right;else{if(a.left!=e&&b(a))return;var f=a;a=null!=a.left&&a.left!=e?a.left:a.parent;e=f}b(null)}};function Vh(a,b,c){this.g=a;this.storage=b;this.b=c;this.a={};a=this.b.keyPath;this.c=v(a)?a.join(","):a||"_ROWID_";this.a[this.c]=null;this.f=Fh(this.g,this.b.getName(),this.c)+"^|"}
function Eh(a,b){var c=b||a.c;if(!a.a[c]){a.a[c]=new Uh(Ch);for(var d=a.storage.length,e=0;e<d;e++){var f=a.storage.key(e);if(null!==f&&0==f.lastIndexOf(a.f,0)){var g=Ld(f.substr(a.f.length));if(c==a.c)a.a[c].add(new Y(g));else{var h=a.storage.getItem(f);if(null!==h)if(f=Re(a.b,c),h=lf(h),h=He(f,h),f.multiEntry){if(v(h))for(f=0;f<h.length;f++)a.a[c].add(new Y(h[f],g))}else a.a[c].add(new Y(h,g))}}}}return a.a[c]}
function Wh(a,b,c){for(var d in a.a){var e=a.a[d];if(e)if(d==a.c)Lh(e,new Y(b));else{var f=Re(a.b,d),f=Fd(c,f.keyPath);Lh(e,new Y(b,f))}}}function Xh(a){for(var b in a.a){var c=a.a[b];c&&c.clear()}a.a={}}
function wh(a,b,c,d){if(null==b&&(a.b.keyPath&&(b=Ze(a.b,c)),a.b.b&&null==b)){b=a.f+Id(void 0);var e=lf(a.storage.getItem(b));e.key_count||(e.key_count=0);e.key_count++;a.storage.setItem(b,S(e));b=e.key_count}d&&(d=null!==a.storage.getItem(a.f+Id(b)));if(d)return null;a.storage.setItem(a.f+Id(b),S(c));d=b;for(var f in a.a)if(e=a.a[f])if(f==a.c)e.add(new Y(d));else{var g=Re(a.b,f),g=Fd(c,g.keyPath);null!=g&&e.add(new Y(d,g))}return b}
function Yh(a,b){var c=a.f+Id(b),d=a.storage.getItem(c);if(null===d)return 0;a.storage.removeItem(c);c=lf(d);Wh(a,b,c);return 1}Vh.prototype.clear=function(){Xh(this);Zh(this)};function Bh(a,b){var c=a.storage.getItem(a.f+Id(b)),d=void 0;if(null!==c)for(var d=lf(c),c=0,e=a.b.a.length;c<e;c++){var f=a.b.index(c);if("DATE"==f.type){var g=He(f,d);g&&Ie(f,d,new Date(g))}}return d}Vh.prototype.getName=function(){return this.b.getName()};
function $h(a,b,c){b=b||a.c;a=Eh(a,b);var d=null,e=null,f=0,g=!1,h=!1;null!=c&&(null!=c.lower&&(d=new Y(c.lower)),null!=c.upper&&(e=new Y(c.upper)),g=c.lowerOpen,h=c.upperOpen);zh(a,function(a){if(null!=a&&(a=a.value,!g||null==d||0!=Q(a.key,d.key))){if(null!=e&&(a=Q(a.key,e.key),1===a||0===a&&h))return!0;f++}},d);return f}
function Zh(a,b){var c=Eh(a,a.c),d=null,e=null,f=0,g=[],h=[],k=!1,m=!1;null!=b&&(null!=b.lower&&(d=new Y(b.lower)),null!=b.upper&&(e=new Y(b.upper)),k=b.lowerOpen,m=b.upperOpen);zh(c,function(b){if(null!=b&&(b=b.value,!k||null==d||0!=Ch(b,d))){if(null!=e){var c=Ch(b,e);if(1===c||0===c&&m)return!0}var c=a.f+Id(b.key),q=a.storage.getItem(c);null!==q&&(a.storage.removeItem(c),f++,10>g.length&&(g.push(b.key),h.push(lf(q))))}},d);if(10>g.length)for(c=0;c<g.length;c++)Wh(a,g[c],h[c]);else Xh(a);return f}
function ai(a,b,c,d,e,f,g,h,k){function m(c){if(c&&(H++,!(H<g))){var d=c.value;if(e){if(P&&null!=B&&(c=q?Ch(d,B):Q(d.key,B.key),0==c))return;if(null!=A&&(c=q?Ch(d,A):Q(d.key,A.key),-1==c||0==c&&G))return k&&(k[0]=void 0,k[1]=void 0),!0}else{if(G&&null!=A&&(c=q?Ch(d,A):Q(d.key,A.key),0==c))return;if(null!=B&&(c=q?Ch(d,B):Q(d.key,B.key),1==c||0==c&&P))return k&&(k[0]=void 0,k[1]=void 0),!0}c=d.key;if(!h||!u||null==p||0!=Q(p,c)){d=u?d.A():c;if(2==b)n.push(d);else if(1==b)n.push(c);else if(3==b)n.push([c,
d]);else if(4==b){var m=Bh(a,d);n.push(m)}else n.push([c,d,Bh(a,d)]);k&&(k[0]=c,k[1]=d)}p=c;if(t(f)&&n.length>=f)return!0}}var n=[],p,q=!!k&&null!=k[0];c=c||a.c;var u=c!=a.c;c=Eh(a,c);var A=null,B=null;t(g)||(g=0);var H=-1,G=!1,P=!1;null!=d&&(null!=d.lower&&(A=u&&e?new Y(d.lower,"\uffff"):new Y(d.lower)),null!=d.upper&&(B=u&&!e?new Y(d.upper,"\uffff"):new Y(d.upper)),G=!!d.lowerOpen,P=!!d.upperOpen);if(q){e?P=!0:G=!0;d=k[0];var ja=t(k[1])?k[1]:"\uffff";e?B=u?new Y(d,ja):new Y(d):A=u?new Y(d,ja):new Y(d)}e?
yh(c,m,B):zh(c,m,A);return n}Vh.prototype.ra=function(a,b,c,d,e){return ai(this,2,a,b,c,d,e)};Vh.prototype.toString=function(){return"ydn.db.con.simple.Store:"+this.g+":"+this.b.getName()};function bi(){this.clear()}l=bi.prototype;l.Fb=function(){return this};l.setItem=function(a,b){t(this.a[a])||(this.keys.push(a.toString()),this.length=this.keys.length);this.a[a]=b};l.getItem=function(a){return t(this.a[a])?this.a[a]:null};l.removeItem=function(a){delete this.a[a];Ua(this.keys,a.toString());this.length=this.keys.length};l.length=0;l.key=function(a){a=this.keys[a];return t(a)?this.a[a]:null};l.clear=function(){this.a={};this.keys=[];this.length=0};function ci(a){this.h=a||new bi;this.g={}}function Dh(a,b){var c=T(a.a,b);if(c)a.g[b]||(a.g[b]=new Vh(a.f,a.c,c));else throw new yd('store name "'+b+'" not found.');return a.g[b]}ci.prototype.Y=function(a){var b=this;setTimeout(function(){var c=Fh(b.f),c=b.c.getItem(c),c=new rf(c);a(c)},10)};function di(a,b){this.b=a;this.a=b}di.prototype.m=function(a,b){var c=this.b;setTimeout(function(){a.call(b,c)},4);var d=this;return function(){d.a("complete",null);d.a=null;d.b=null}};function ei(a,b){this.a=b}C(ei,Yf);l=ei.prototype;l.logger=E("ydn.db.crud.req.SimpleStore");l.tb=function(a,b,c){this.S(a,!0,!1,null,b,c)};
l.S=function(a,b,c,d,e,f){I(this.logger,O(a)+" "+(b?"put":"add")+"Object"+(c?"":"s "+e.length+" objects"));var g=a.a.m(function(h){var k;if(c)k=Dh(h,d),h=f?f[0]:void 0,h=wh(k,h,e[0],!b),null!=h?M(a,h):(k=mf(h),k=new Pf(k),M(a,k,!0));else{for(var m=d,n=[],p=!1,q=f||{},u=0;u<e.length;u++){var A;d?A=q[u]:(m=f[u],A=m.G(),m=m.j());k&&k.getName()==m||(k=Dh(h,m));A=wh(k,A,e[u],!b);null!=A?n.push(A):(p=!0,n.push(new Pf))}M(a,n,p)}g();g=null},this)};
l.ib=function(a,b,c){var d=a.a.m(function(e){e=Bh(Dh(e,b),c);M(a,e);d();d=null},this)};function fi(a,b,c,d){var e=b.a.m(function(a){for(var g=[],h=c,k,m=0;m<d.length;m++){var n=d[m];n instanceof me&&(h=n,n=h.G(),h=h.j());k&&k.getName()==h||(k=Dh(a,h));n=Bh(k,n);g[m]=n}M(b,g,!1);e();e=null},a)}l.Nb=function(a,b,c){fi(this,a,b,c)};l.ob=function(a,b){fi(this,a,null,b)};
l.ub=function(a,b,c){var d=O(a)+" removeById "+b+" "+c;I(this.logger,d);var e=this,f=a.a.m(function(g){g=Yh(Dh(g,b),c);J(e.logger,"success "+d+(0==g?" [not found]":""));M(a,g);f();f=null},this)};l.vb=function(a,b){I(this.logger,O(a)+" removeByKeys "+b.length+" keys");var c,d=0,e=a.a.m(function(f){for(var g=0;g<b.length;g++){var h=b[g].j(),k=b[g].G();c&&c.getName()==h||(c=Dh(f,h));d+=Yh(c,k)}M(a,d);e();e=null},this)};l.Eb=function(a,b,c){this.Oa(a,b,c)};
l.Oa=function(a,b,c){var d=O(a)+" removeByKeyRange "+(c?S(c):"");I(this.logger,d);var e=this,f=a.a.m(function(g){g=Zh(Dh(g,b),c);J(e.logger,d+" deleted "+g+" records.");M(a,g);f();f=null},this)};l.Ob=function(a,b,c,d){var e=O(a)+" removeByIndexKeyRange "+(d?S(d):"");I(this.logger,e);var f=a.a.m(function(e){e=Dh(e,b);for(var h=e.ra(c,d),k=h.length,m=0;m<k;m++)Yh(e,h[m]);M(a,k);f();f=null},this)};
l.bb=function(a,b){var c=O(a)+" clearByStores";I(this.logger,c);var d=a.a.m(function(e){for(var f=0;f<b.length;f++)Dh(e,b[f]).clear();J(this.logger,"success "+c);M(a,b.length);d();d=null},this)};l.eb=function(a,b){var c=a.a.m(function(d){for(var e=[],f=0;f<b.length;f++){var g=Dh(d,b[f]);e.push($h(g))}M(a,e);c();c=null},this)};
l.Ia=function(a,b,c,d){var e=O(a)+" count"+(null!=d?"Index":"")+(null!=c?"KeyRange":"Store");I(this.logger,e);var f=a.a.m(function(g){g=$h(Dh(g,b),d,c);J(this.logger,"success "+e);M(a,g);f();f=null},this)};l.Z=function(a,b,c,d,e,f,g,h,k,m){var n=O(a)+" "+c+" "+(e?mf(e):"");I(this.logger,n);var p=a.a.m(function(q){q=ai(Dh(q,c),b,d,e,h,f,g,k,m);J(this.logger,n+" "+q.length+" records found.");M(a,q);p();p=null},this)};function gi(a,b){this.a=b}C(gi,ei);gi.prototype.b=function(a,b,c,d){c=T(this.a,c);return new vh(a,b,c,d)};function lg(a,b){this.a=b}C(lg,gi);lg.prototype.logger=E("ydn.db.sql.req.SimpleStore");lg.prototype.executeSql=function(a,b,c){if(c=Yg(b,c))throw new Wf(c);c=Va(b.a);if(1==c.length){var d=T(this.a,c[0]);if(!d)throw new Tf(c[0]);var e=$g(b);if(e)for(var f=0;f<e.length;f++)if(!We(d,e[f]))throw new K('Index "'+e[f]+'" not found in '+c[0]);var g;b.c?g=new eh(d,b):g=new dh(d,b);g.b(a,this)}else throw new vd(b.U);};function hi(a,b,c,d){ig.call(this,a,b,c,d)}C(hi,Sg);hi.prototype.executeSql=function(a,b){for(var c=new Wg(a),d=Va(c.a),e=0;e<d.length;e++){var f=T(this.b,d[e]);if(!f)throw new K("store: "+f+" not exists.");}J(this.logger,"executeSql: "+a+" params: "+b);var g=this.a.request("sql",Va(c.a),c.f);N(g,function(){U(this).executeSql(g,c,b||[])},this);return g};function ii(a,b,c){W.call(this,a,b,c)}C(ii,Vg);ii.prototype.Aa=function(a,b){return new hi(this,this.b,a,b)};ii.prototype.executeSql=function(a,b){return this.a.executeSql(a,b)};function ji(a,b){t(a)&&5242880<a&&rd(this.logger,ed,"storage size request ignored, use Quota Management API instead");this.C=null;this.Pa=b||NaN}l=ji.prototype;
l.connect=function(a,b){function c(a,c,d){J(e.logger,(d?"changing":"upgrading")+" version to "+a.version+" from "+g);for(d=0;d<b.stores.length;d++)ki(e,a,c,b.stores[d]);c=a.objectStoreNames;var f=c.length;for(d=0;d<f;d++)tf(b,c[d])||(a.deleteObjectStore(c[d]),J(e.logger,"store: "+c[d]+" deleted."))}function d(a,b){f.c?F(e.logger,"database already set."):t(b)?(F(e.logger,b?b.message:"Error received."),e.C=null,f.s(b)):(e.C=a,e.C.onabort=function(a){I(e.logger,e+": abort");e.Wa(a.target.error)},e.C.onerror=
function(a){I(e.logger,e+": error");e.Wa(a.target.error)},e.C.onversionchange=function(a){I(e.logger,e+" closing connection for onversionchange to: "+a.version);if(e.C&&(e.C.onabort=null,e.C.onblocked=null,e.C.onerror=null,e.C.onversionchange=null,e.rb(a),!a.defaultPrevented)){e.C.close();e.C=null;var b=Error();b.name=a.type;e.zb(b)}},f.callback(parseFloat(g)))}var e=this,f=new D,g=void 0,h=b.version;rd(this.logger,id,"Opening database: "+a+" ver: "+(b.b?"auto":h));var k;k=t(h)?Ed.open(a,h):Ed.open(a);
k.onsuccess=function(f){var h=f.target.result;t(g)||(g=h.version);rd(e.logger,id,"Database: "+h.name+", ver: "+h.version+" opened.");if(b.b)e.Y(function(f){if(b instanceof wf)for(var g=0;g<f.stores.length;g++)tf(b,f.stores[g].getName())||xf(b,f.stores[g].clone());f=uf(b,f,!1,!0);if(0<f.length){rd(e.logger,id,"Schema change require for difference in "+f);var k=y(h.version)?h.version+1:1;if("IDBOpenDBRequest"in r){h.close();var m=Ed.open(a,k);m.onupgradeneeded=function(a){a=a.target.result;rd(e.logger,
id,"re-open for version "+a.version);c(a,m.transaction,!1)};m.onsuccess=function(a){d(a.target.result)};m.onerror=function(){rd(e.logger,id,e+": fail.");d(null)}}else{var p=h.setVersion(k+"");p.a=function(a){F(e.logger,"migrating from "+h.version+" to "+k+" failed.");d(null,a)};p.onsuccess=function(){p.transaction.oncomplete=G;c(h,p.transaction,!0)};var G=function(){var b=Ed.open(a);b.onsuccess=function(a){a=a.target.result;rd(e.logger,id,e+": OK.");d(a)};b.onerror=function(){rd(e.logger,id,e+": fail.");
d(null)}};null!=p.transaction&&(p.transaction.oncomplete=G)}}else d(h)},void 0,h);else if(b.version>h.version){var k=h.setVersion(b.version);k.a=function(a){F(e.logger,"migrating from "+h.version+" to "+b.version+" failed.");d(null,a)};k.onsuccess=function(){c(h,k.transaction,!0)}}else b.version==h.version?rd(e.logger,id,"database version "+h.version+" ready to go"):F(e.logger,"connected database version "+h.version+" is higher than requested version."),e.Y(function(a){a=uf(b,a,!1,!0);0<a.length?
(rd(e.logger,id,a),d(null,new Cf("different schema: "+a))):d(h)},void 0,h)};k.onupgradeneeded=function(a){a=a.target.result;g=NaN;rd(this.logger,id,"upgrade needed for version "+a.version);c(a,k.transaction,!1)};k.onerror=function(c){sd(e.logger,'open request to database "'+a+'" '+(t(b.version)?" with version "+b.version:"")+" cause error of "+k.error.name);d(null,c)};k.onblocked=function(c){sd(e.logger,"database "+a+" "+b.version+" block, close other connections.");d(null,c)};y(this.Pa)&&!isNaN(this.Pa)&&
setTimeout(function(){"done"!=k.readyState&&(sd(e.logger,e+": database state is still "+k.readyState),d(null,new Xf("connection timeout after "+e.Pa)))},this.Pa);return f};l.Pa=18E4;l.zb=function(){};l.Wa=function(){};l.rb=function(){};l.Fa=function(){return"indexeddb"};l.Sb=function(){return this.C||null};l.yb=function(){return!!this.C};l.logger=E("ydn.db.con.IndexedDb");l.C=null;l.xb=function(){return this.C?parseFloat(this.C.version):void 0};
l.Y=function(a,b,c){c=c||this.C;if(t(b)){if(null===b){if(0==c.objectStoreNames.length){a(new rf(c.version));return}throw new Bf;}c=b.db}else{b=[];for(var d=c.objectStoreNames.length-1;0<=d;d--)b[d]=c.objectStoreNames[d];if(0==b.length){a(new rf(c.version));return}b=c.transaction(b,Cd)}for(var e=c.objectStoreNames,f=[],g=e.length,d=0;d<g;d++){for(var h=b.objectStore(e[d]),k=[],m=0,n=h.indexNames.length;m<n;m++){var p=h.index(h.indexNames[m]);k[m]=new Ee(p.keyPath,void 0,p.unique,p.multiEntry,p.name)}f[d]=
new Ne(h.name,h.keyPath,h.autoIncrement,void 0,k)}b=new rf(c.version,f);a(b)};
function ki(a,b,c,d){function e(){var a={autoIncrement:!!d.b};null!=d.keyPath&&(a.keyPath=d.keyPath);return b.createObjectStore(d.getName(),a)}rd(a.logger,jd,"Creating Object Store for "+d.getName()+" keyPath: "+d.keyPath);if(b.objectStoreNames.contains(d.getName())){c=c.objectStore(d.getName());Le(d.keyPath||"",c.keyPath||"")?(b.deleteObjectStore(d.getName()),rd(a.logger,ed,"store: "+d.getName()+" deleted due to keyPath change."),c=e()):da(c.autoIncrement)&&da(d.b)&&c.autoIncrement!=d.b&&(b.deleteObjectStore(d.getName()),
rd(a.logger,ed,"store: "+d.getName()+" deleted due to autoIncrement change."),c=e());for(var f=c.indexNames,g=0;g<d.a.length;g++){var h=d.index(g);!f.contains(h.getName())&&h.g&&(c.clear(),rd(a.logger,ed,"store: "+d.getName()+" cleared since generator index need re-indexing."))}for(var k=0,m=0,n=0,g=0;g<d.a.length;g++){var h=d.index(g),p=!1;if(f.contains(h.getName())){var q=c.index(h.getName()),u=null!=q.unique&&null!=h.unique&&q.unique!=h.unique,A=null!=q.multiEntry&&null!=h.multiEntry&&q.multiEntry!=
h.multiEntry,q=null!=q.keyPath&&null!=h.keyPath&&!!Le(q.keyPath,h.keyPath);if(u||A||q)c.deleteIndex(h.getName()),p=!0,k--,n++}else"BLOB"!=h.type&&(p=!0);p&&(h.unique||h.multiEntry?(p={unique:h.unique,multiEntry:h.multiEntry},c.createIndex(h.getName(),h.keyPath,p)):c.createIndex(h.getName(),h.keyPath),k++)}for(g=0;g<f.length;g++)We(d,f[g])||(c.deleteIndex(f[g]),m++);rd(a.logger,jd,"Updated store: "+c.name+", "+k+" index created, "+m+" index deleted, "+n+" modified.")}else{c=e();for(g=0;g<d.a.length;g++)h=
d.index(g),"BLOB"==h.type?rd(a.logger,fd,"Index "+h+" of blob data type ignored."):(I(a.logger,"Creating index: "+h+" for "+d.getName()),h.unique||h.multiEntry?(p={unique:h.unique,multiEntry:h.multiEntry},c.createIndex(h.getName(),h.keyPath,p)):c.createIndex(h.getName(),h.keyPath));J(a.logger,"Created store: "+c)}}
l.gb=function(a,b,c,d){var e=this.C;if(!b){b=[];for(var f=e.objectStoreNames.length-1;0<=f;f--)b[f]=e.objectStoreNames[f]}0==b.length?a(null):(b=e.transaction(b,c),b.oncomplete=function(a){d("complete",a)},b.onabort=function(a){d("abort",a)},a(b),a=null)};l.close=function(){rd(this.logger,jd,this+" closing connection");this.C.close()};l.toString=function(){return"IndexedDB:"+(this.C?this.C.name+":"+this.C.version:"")};
Yd.push(function(a,b){if(!Ed||b&&"indexeddb"!=b)return null;var c=Ed.deleteDatabase(a),d=new Rd("IDBVersionChangeEvent ");c.onblocked=function(a){Ad(d,a)};c.onerror=function(a){d.s(a)};c.onsuccess=function(a){d.callback(a)};return d});function li(a){ci.call(this,a);this.b=NaN}C(li,ci);l=li.prototype;l.logger=E("ydn.db.con.SimpleStorage");l.xb=function(){return this.b};
l.connect=function(a,b){function c(a,b){setTimeout(function(){b?(J(d.logger,d+" opening fail"),e.s(b)):(J(d.logger,d+" version "+d.xb()+" open"),e.callback(a))},10)}var d=this,e=new D;this.c=this.h.Fb(a);this.f=a;this.a=b;var f=Fh(this.f);this.b=NaN;var g=lf(this.c.getItem(f));t(g.version)&&!y(g.version)&&(g.version=NaN);if(g)if(g=new rf(g),uf(this.a,g,!1,!1))if(!this.a.b&&!isNaN(g.version)&&this.a.version>g.version)c(NaN,new Qf("existing version "+g.version+" is larger than "+this.a.version));else{var h=
this.a.version;this.b=t(h)?h:g.version+1;for(h=0;h<this.a.count();h++)var k=this.a.stores[h]||null;if(this.a instanceof wf)for(h=0;h<g.count();h++)k=g.stores[h]||null,xf(this.a,k);h=this.a.toJSON();h.version=this.b||NaN;this.c.setItem(f,S(h));c(g.version||NaN)}else{for(h=0;h<this.a.count();h++)k=this.a.stores[h]||null;this.b=g.version||NaN;c(this.b)}else g=b.toJSON(),this.b=1,g.version=this.b,this.c.setItem(f,S(g)),c(NaN);return e};l.yb=function(){return!!this.f};l.Sb=function(){return this.c||null};
l.zb=function(){};l.Wa=function(){};l.rb=function(){};l.Fa=function(){return"memory"};l.close=function(){};l.gb=function(a,b,c,d){a(new di(this,function(a,b){d(a,b)}))};l.toString=function(){return"SimpleStorage:"+this.Fa()+":"+(this.f+":"+this.b)};function mi(){li.call(this,this)}C(mi,li);mi.prototype.Fb=function(){return window.localStorage};mi.prototype.Fa=function(){return"localstorage"};Yd.push(function(a,b){if(!b||"localstorage"==b){var c=new mi,d=new wf;c.connect(a,d);c.Y(function(a){for(var b=0;b<a.stores.length;b++)Dh(c,a.stores[b].getName()).clear()})}});function ni(){li.call(this,this)}C(ni,li);ni.prototype.Fb=function(){return window.sessionStorage};ni.prototype.Fa=function(){return"sessionstorage"};
Yd.push(function(a,b){if(!b||"sessionstorage"==b){var c=new ni,d=new wf;c.connect(a,d);c.Y(function(a){for(var b=0;b<a.stores.length;b++)Dh(c,a.stores[b].getName()).clear()})}});function oi(a,b){this.a=t(a)?a:4194304;this.b=b||"websql"}l=oi.prototype;
l.connect=function(a,b){function c(b,c){var f=b.version?parseInt(b.version,10):0,g=c.b?isNaN(f)?1:f+1:c.version;td(e.logger,a+": changing version from "+b.version+" to "+g);var h=!1,k=0;b.changeVersion(b.version,g+"",function(a){e.Y(function(b){h=!0;for(var d=0;d<c.count();d++){var f=T(b,(c.stores[d]||null).getName()),f=f?Xe(f,c.stores[d]||null):null;pi(e,a,c.stores[d]||null,function(a){a&&k++},f)}for(d=0;d<b.count();d++)f=b.stores[d]||null,tf(c,f.getName())||(c instanceof wf?xf(c,f):(f="DROP TABLE "+
Se(f),J(e.logger,f),a.executeSql(f,[],function(){},function(a,b){throw b;})))},a,b)},function(c){sd(e.logger,"SQLError "+c+" "+c.code+"("+c.message+") while changing version from "+b.version+" to "+g+" on "+a);throw c;},function(){if(h){var f=".";k!=c.stores.length&&(f=" but unexpected stores exists.");I(e.logger,a+":"+b.version+" ready"+f);d(b)}else F(e.logger,a+": changing version voided.")})}function d(a,b){t(b)?(e.J=null,g.s(b)):(e.J=a,g.callback(parseFloat(f)))}var e=this,f=NaN,g=new D,h=null;
try{"sqlite"==this.b?r.sqlitePlugin?(h=r.sqlitePlugin.openDatabase(a,"",a,this.a),h.readTransaction||(h.readTransaction=h.transaction),h.changeVersion=function(a,b,c,d,e){h.transaction(c,d,e)}):(F(this.logger,"sqlitePlugin not found."),h=null,this.Ab=Error("sqlitePlugin not found.")):h=r.openDatabase(a,"",a,this.a)}catch(k){if("SECURITY_ERR"==k.name)F(this.logger,"SECURITY_ERR for opening "+a),h=null,this.Ab=new Vf(k);else throw k;}if(h){var f=h.version||"",m="database "+a+(0==f.length?"":" version "+
h.version);null!=b.version&&b.version==h.version?(td(e.logger,"Existing "+m+" opened as requested."),d(h)):this.Y(function(a){(a=uf(b,a,!0,!1))?(0==f?td(e.logger,"New "+m+" created."):b.b?td(e.logger,"Existing "+m+" opened and schema change for "+a):td(e.logger,"Existing "+m+" opened and  schema change to version "+b.version+" for "+a),c(h,b)):(td(e.logger,"Existing "+m+" with same schema opened."),d(h))},null,h)}else d(null,this.Ab);return g};l.Fa=function(){return this.b};l.Ab=null;l.J=null;
l.Sb=function(){return this.J||null};l.logger=E("ydn.db.con.WebSql");l.zb=function(){};l.Wa=function(){};
function qi(a){var b=a.u,c="CREATE TABLE IF NOT EXISTS "+Se(a)+" (",d=a.f,c=c+(d+" "+b+" PRIMARY KEY ");a.b&&(c+=" AUTOINCREMENT ");if(!a.wa||!a.keyPath&&0==a.a.length)c+=" ,_default_ BLOB";for(var e=[],f=[d],g=0,h=a.a.length;g<h;g++){var k=a.index(g),m="";if(k.multiEntry){var m="ydn.db.me:"+a.getName()+":"+k.getName(),n=k.unique?" UNIQUE ":"",k="CREATE TABLE IF NOT EXISTS "+Ha(m)+" ("+d+" "+b+", "+k.c+" "+k.i+n+")";e.push(k)}else k.unique&&(m=" UNIQUE "),n=k.c,-1==f.indexOf(n)&&(c+=", "+n+" "+k.i+
m,f.push(n))}e.unshift(c+")");return e}l.xb=function(){return this.J?parseFloat(this.J.version):void 0};
l.Y=function(a,b,c){function d(a,b){throw b;}function e(b,c){if(c&&c.rows){for(var d=0;d<c.rows.length;d++){var e=c.rows.item(d);if("__WebKitDatabaseInfoTable__"!=e.name&&"sqlite_sequence"!=e.name&&"table"==e.type){var q="sql"in e?e.sql:void 0;I(f.logger,"Parsing table schema from SQL: "+q);for(var u=q.substr(q.indexOf("("),q.lastIndexOf(")")).match(/(?:"[^"]*"|[^,])+/g),A=void 0,B,q=[],H=!1,G=!1,P=0;P<u.length;P++){var ja=u[P].match(/\w+|"[^"]+"/g),ua=Oa(ja,function(a){return a.toUpperCase()}),ca=
Ea(ja[0],'"'),ja=Fe(ua[1]);if(-1!=ua.indexOf("PRIMARY")&&-1!=ua.indexOf("KEY")){B=ja;if(x(ca)&&!ta(ca)&&"_ROWID_"!=ca){var vb=ca.split(","),A=ca;1<vb.length&&(A=vb,B=void 0)}-1!=ua.indexOf("AUTOINCREMENT")&&(H=!0)}else if("_ROWID_"!=ca)if("_default_"==ca)G=!0;else{var je="UNIQUE"==ua[2];0==ca.lastIndexOf(e.tbl_name+"-",0)&&(ca=ca.substr(e.tbl_name.length+1));ua=new Ee(ca,ja,je);q.push(ua)}}if(0==e.name.lastIndexOf("ydn.db.me:",0)){var Db=e.name.split(":");if(3<=Db.length){var Ub=Db[1],A=new Ee(Db[2],
ja,je,!0),u=Sa(q,function(a){return a.getName()==Db[2]});0<=u?q[u]=A:q.push(A);u=Sa(h,function(a){return a.getName()===Ub});0<=u?(P=h[u],h[u]=new Ne(P.getName(),P.keyPath,H,B,q,void 0,!G)):h.push(new Ne(Ub,void 0,!1,void 0,[A]));I(f.logger,'multi entry index "'+A.getName()+'" found in '+Ub+(-1==u?"*":""))}else F(f.logger,'Invalid multiEntry store name "'+e.name+'"')}else P=Sa(h,function(a){return a.getName()===e.name}),0<=P?(u=h[P].index(0),q.push(u),h[P]=new Ne(e.name,A,H,B,q,void 0,!G)):(q=new Ne(e.name,
A,H,B,q,void 0,!G),h.push(q))}}d=new rf(g,h);a(d)}}var f=this,g=(c=c||this.J)&&c.version?parseFloat(c.version):void 0,g=isNaN(g)?void 0:g,h=[];b?b.executeSql("SELECT * FROM sqlite_master",[],e,d):c.readTransaction(function(b){f.Y(a,b,c)},function(a){sd(f.logger,"opening tx: "+a.message);throw a;},e)};
function pi(a,b,c,d,e){function f(a){b.executeSql(a,[],function(){g++;g==h.length&&(d(!0),d=null)},function(b,e){g++;g==h.length&&(d(!1),d=null);var f="SQLError creating table: "+c.getName()+" "+e.message+' for executing "'+a;throw new Uf(e,f);})}var g=0,h=qi(c),k="Create";if(e){e=bf(c,e);if(0==e.length){I(a.logger,"same table "+c.getName()+" exists.");d(!0);d=null;return}k="Modify";F(a.logger,"table: "+c.getName()+" has changed by "+e+" ALTER TABLE cannot run in WebSql, dropping old table.");h.unshift("DROP TABLE IF EXISTS "+
Ha(c.getName()))}I(a.logger,k+" table: "+c.getName()+": "+h.join(";"));for(a=0;a<h.length;a++)f(h[a])}l.yb=function(){return!!this.J};l.close=function(){this.J=null};
l.gb=function(a,b,c,d){function e(a){I(h.logger,h+": Tx "+c+" request cause error.");d("abort",a)}function f(){d("complete",{type:"complete"})}function g(b){a(b)}var h=this;null===this.J&&(a(null),d("abort",this.Ab));c==Cd?this.J.readTransaction(g,e,f):c==Dd?this.J.changeVersion(this.J.version,this.J.version+1+"",g,e,f):this.J.transaction(g,e,f)};
Yd.push(function(a,b){if(ea(r.openDatabase)&&(!b||"websql"==b)){var c=new oi,d=new wf;J(c.logger,"deleting websql database: "+a);var d=c.connect(a,d),e=function(){var b=c.logger;b&&b.log(fd,"all tables in "+a+" deleted.",void 0)};d.L(function(){c.gb(function(b){b.executeSql('SELECT * FROM sqlite_master WHERE type = "table"',[],function(d,e){if(e&&e.rows){for(var k=e.rows.length,m=0,n=0;n<k;n++){var p=e.rows.item(n);"__WebKitDatabaseInfoTable__"!=p.name&&"sqlite_sequence"!=p.name&&(m++,I(c.logger,
"deleting table: "+p.name),b.executeSql("DROP TABLE "+p.name))}J(c.logger,m+' tables deleted from "'+a+'"')}},function(a,b){throw b;})},[],L,e)});d.Yb(function(){F(c.logger,"Connecting "+a+" failed.")})}});oi.prototype.rb=function(){};oi.prototype.toString=function(){return"WebSql:"+(this.J?":"+this.J.version:"")};/*
 Copyright 2012 YDN Authors, Yathit. All Rights Reserved.
 Licensed under the Apache License, Version 2.0 (the "License");.
*/
vg.prototype.Gb=function(a){return"indexeddb"==a&&Ed?new ji(this.o,this.P):"sqlite"==a&&r.sqlitePlugin?new oi(this.o,"sqlite"):"websql"==a&&ea(r.openDatabase)?new oi(this.o):"localstorage"==a&&window.localStorage?new mi:"sessionstorage"==a&&window.sessionStorage?new ni:"memory"==a?new li:null};/*
 Copyright 2012 YDN Authors, Yathit. All Rights Reserved.
 Licensed under the Apache License, Version 2.0 (the "License");.
*/
ii.prototype.executeSql=ii.prototype.executeSql;hi.prototype.executeSql=hi.prototype.executeSql;function ri(a,b,c){W.call(this,a,b,c)}C(ri,ii);na("ydn.db.Storage",ri);function si(){this.a=ma()}var ti=new si;si.prototype.set=function(a){this.a=a};si.prototype.get=function(){return this.a};function ui(a){this.g=a||"";this.h=ti}ui.prototype.c=!0;ui.prototype.a=!0;ui.prototype.b=!1;function vi(a){a=new Date(a.g);return wi(a.getFullYear()-2E3)+wi(a.getMonth()+1)+wi(a.getDate())+" "+wi(a.getHours())+":"+wi(a.getMinutes())+":"+wi(a.getSeconds())+"."+wi(Math.floor(a.getMilliseconds()/10))}function wi(a){return 10>a?"0"+a:String(a)}function xi(a,b){var c=(a.g-b)/1E3,d=c.toFixed(3),e=0;if(1>c)e=2;else for(;100>c;)e++,c*=10;for(;0<e--;)d=" "+d;return d}function yi(a){ui.call(this,a)}C(yi,ui);
yi.prototype.b=!0;yi.prototype.f=function(a){return a?zi(this,a).la():""};
function zi(a,b){var c;switch(b.f.value){case cd.value:c="dbg-sh";break;case dd.value:c="dbg-sev";break;case ed.value:c="dbg-w";break;case fd.value:c="dbg-i";break;default:c="dbg-f"}var d=[];d.push(a.g," ");a.a&&d.push("[",vi(b),"] ");d.push("[",xi(b,a.h.get()),"s] ");d.push("[",b.b,"] ");var d=xc(d.join("")),e=Dc;if(a.b&&b.a){var e=Bc("br"),f;try{var g;var h=b.a,k=aa("window.location.href");if(x(h))g={message:h,name:"Unknown error",lineNumber:"Not available",fileName:k,stack:"Not available"};else{var m,
n,p=!1;try{m=h.lineNumber||h.Wc||"Not available"}catch(q){m="Not available",p=!0}try{n=h.fileName||h.filename||h.sourceURL||r.$googDebugFname||k}catch(u){n="Not available",p=!0}g=!p&&h.lineNumber&&h.fileName&&h.stack&&h.message&&h.name?h:{message:h.message||"Not available",name:h.name||"UnknownError",lineNumber:m,fileName:n,stack:h.stack||"Not available"}}var A;var B=g.fileName;null!=B||(B="");if(/^https?:\/\//i.test(B)){var H;h=B;h instanceof ic?H=h:(h=h.sa?h.la():String(h),h=lc.test(h)?mc(h):"about:invalid#zClosurez",
H=pc(h));cc("view-source scheme plus HTTP/HTTPS URL");var G="view-source:"+kc(H);A=pc(G)}else{var P=cc("sanitizedviewsrc");A=pc(bc(P))}f=Cc(xc("Message: "+g.message+"\nUrl: "),Bc("a",{href:A,target:"_new"},g.fileName),xc("\nLine: "+g.lineNumber+"\n\nBrowser stack:\n"+g.stack+"-> [end]\n\nJS stack traversal:\n"+Vc(void 0)+"-> "))}catch(ja){f=xc("Exception trying to expose exception! You win, we lose. "+ja)}e=Cc(e,f)}f=xc(b.c);c=Bc("span",{"class":c},Cc(f,e));return a.c?Cc(d,c,Bc("br")):Cc(d,c)}
function Ai(a){ui.call(this,a)}C(Ai,ui);Ai.prototype.f=function(a){var b=[];b.push(this.g," ");this.a&&b.push("[",vi(a),"] ");b.push("[",xi(a,this.h.get()),"s] ");b.push("[",a.b,"] ");b.push(a.c);this.b&&(a=a.a)&&b.push("\n",a instanceof Error?a.message:a.toString());this.c&&b.push("\n");return b.join("")};function Bi(){this.g=ka(this.h,this);this.a=new Ai;this.a.a=!1;this.a.b=!1;this.b=this.a.c=!1;this.c="";this.f={}}Bi.prototype.h=function(a){if(!this.f[a.b]){var b=this.a.f(a),c=Ci;if(c)switch(a.f){case cd:Di(c,"info",b);break;case dd:Di(c,"error",b);break;case ed:Di(c,"warn",b);break;default:Di(c,"debug",b)}else this.c+=b}};var Ci=r.console;function Di(a,b,c){if(a[b])a[b](c);else a.log(c)};var Ei=!Lc||Lc&&9<=Uc;!Mc&&!Lc||Lc&&Lc&&9<=Uc||Mc&&Sc("1.9.1");Lc&&Sc("9");function Fi(a,b){hb(b,function(b,d){"style"==d?a.style.cssText=b:"class"==d?a.className=b:"for"==d?a.htmlFor=b:d in Gi?a.setAttribute(Gi[d],b):0==d.lastIndexOf("aria-",0)||0==d.lastIndexOf("data-",0)?a.setAttribute(d,b):a[d]=b})}var Gi={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};
function Hi(a,b,c){function d(c){c&&b.appendChild(x(c)?a.createTextNode(c):c)}for(var e=2;e<c.length;e++){var f=c[e];!w(f)||z(f)&&0<f.nodeType?d(f):Na(Ii(f)?Va(f):f,d)}}function Ii(a){if(a&&"number"==typeof a.length){if(z(a))return"function"==typeof a.item||"string"==typeof a.item;if(ea(a))return"function"==typeof a.item}return!1}function Ji(a){this.a=a||r.document||document}
function Ki(a,b){var c;c=a.a;var d=b&&"*"!=b?b.toUpperCase():"";c.querySelectorAll&&c.querySelector&&d?c=c.querySelectorAll(d+""):c=c.getElementsByTagName(d||"*");return c}
Ji.prototype.b=function(a,b,c){var d=this.a,e=arguments,f=e[0],g=e[1];if(!Ei&&g&&(g.name||g.type)){f=["<",f];g.name&&f.push(' name="',wa(g.name),'"');if(g.type){f.push(' type="',wa(g.type),'"');var h={};kb(h,g);delete h.type;g=h}f.push(">");f=f.join("")}f=d.createElement(f);g&&(x(g)?f.className=g:v(g)?f.className=g.join(" "):Fi(f,g));2<e.length&&Hi(d,f,e);return f};
Ji.prototype.contains=function(a,b){if(a.contains&&1==b.nodeType)return a==b||a.contains(b);if("undefined"!=typeof a.compareDocumentPosition)return a==b||Boolean(a.compareDocumentPosition(b)&16);for(;b&&a!=b;)b=b.parentNode;return b==a};function Li(a){Lc&&t(a.cssText)?a.cssText=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}":a.innerHTML=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}"}
;function Mi(a){this.g=ka(this.h,this);this.b=new yi;this.c=this.b.a=!1;this.a=a;this.f=this.a.ownerDocument||this.a.document;a=(a=this.a)?new Ji(9==a.nodeType?a:a.ownerDocument||a.document):ra||(ra=new Ji);var b=null,c=a.a;Lc&&c.createStyleSheet?(b=c.createStyleSheet(),Li(b)):(c=Ki(a,"head")[0],c||(b=Ki(a,"body")[0],c=a.b("head"),b.parentNode.insertBefore(c,b)),b=a.b("style"),Li(b),c.appendChild(b));this.a.className+=" logdiv"}
Mi.prototype.h=function(a){if(a){var b=100>=this.a.scrollHeight-this.a.scrollTop-this.a.clientHeight,c=this.f.createElement("div");c.className="logmsg";a=zi(this.b,a);c.innerHTML=uc(a);this.a.appendChild(c);b&&(this.a.scrollTop=this.a.scrollHeight)}};Mi.prototype.clear=function(){this.a&&(this.a.innerHTML=uc(Dc))};var Ni=!Lc||Lc&&9<=Uc,Oi=Lc&&!Sc("9");!Nc||Sc("528");Mc&&Sc("1.9b")||Lc&&Sc("8")||Kc&&Sc("9.5")||Nc&&Sc("528");Mc&&!Sc("8")||Lc&&Sc("9");function Pi(a){Pi[" "](a);return a}Pi[" "]=function(){};function Qi(a,b){ee.call(this,a?a.type:"");this.b=this.target=null;this.clientY=this.clientX=this.Lb=this.Kb=0;this.a=this.state=null;if(a){this.a=a;this.type=a.type;this.target=a.target||a.srcElement;this.b=b;var c=a.relatedTarget;if(c&&Mc)try{Pi(c.nodeName)}catch(d){}Object.defineProperties?Object.defineProperties(this,{Kb:{configurable:!0,enumerable:!0,get:this.ec,set:this.Dc},Lb:{configurable:!0,enumerable:!0,get:this.fc,set:this.Ec}}):(this.Kb=this.ec(),this.Lb=this.fc());this.clientX=void 0!==
a.clientX?a.clientX:a.pageX;this.clientY=void 0!==a.clientY?a.clientY:a.pageY;this.state=a.state;a.defaultPrevented&&this.preventDefault()}}C(Qi,ee);l=Qi.prototype;l.preventDefault=function(){Qi.D.preventDefault.call(this);var a=this.a;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,Oi)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};l.ec=function(){return Nc||void 0!==this.a.offsetX?this.a.offsetX:this.a.layerX};
l.Dc=function(a){Object.defineProperties(this,{Kb:{writable:!0,enumerable:!0,configurable:!0,value:a}})};l.fc=function(){return Nc||void 0!==this.a.offsetY?this.a.offsetY:this.a.layerY};l.Ec=function(a){Object.defineProperties(this,{Lb:{writable:!0,enumerable:!0,configurable:!0,value:a}})};var Ri=null,Si=null;E("ydn.debug");na("ydn.debug.log",function(a,b,c){a=a||"ydn";if(y(b))b=new bd("log",b);else if(x(b)){b=b.toUpperCase();if(!ld){ld={};for(var d=0,e;e=kd[d];d++)ld[e.value]=e,ld[e.name]=e}b=ld[b]||null}else b=hd;(d=E(a))?d.b=b:window.console.log("logger "+a+" not available.");t(c)?!Si&&(a=Si=new Mi(c),1!=a.c&&(c=qd(),b=a.g,c.a||(c.a=[]),c.a.push(b),a.c=!0),a=qd())&&(a.b=ed):!Ri&&!Si&&(a=Ri=new Bi,1!=a.b&&(c=qd(),b=a.g,c.a||(c.a=[]),c.a.push(b),a.b=!0),a=qd())&&(a.b=ed)});function Ti(a,b){be.call(this);this.f=b;this.b=[];if(a>this.f)throw Error("[goog.structs.SimplePool] Initial cannot be greater than max");for(var c=0;c<a;c++)this.b.push(this.a())}C(Ti,be);Ti.prototype.a=function(){return{}};Ti.prototype.c=function(a){if(z(a))if(ea(a.dc))a.dc();else for(var b in a)delete a[b]};Ti.prototype.ja=function(){Ti.D.ja.call(this);for(var a=this.b;a.length;)this.c(a.pop());delete this.b};function Ui(){this.a=[];this.c=new Ic;this.f=new Ic;this.h=1;this.g=new Ti(0,4E3);this.g.a=function(){return new Vi};this.i=new Ti(0,50);this.i.a=function(){return new Wi};var a=this;this.b=new Ti(0,2E3);this.b.a=function(){return String(a.h++)};this.b.c=function(){}}E("goog.debug.Trace");function Wi(){this.time=this.count=0}Wi.prototype.toString=function(){var a=[];a.push(this.type," ",this.count," (",Math.round(10*this.time)/10," ms)");return a.join("")};function Vi(){}
function Xi(a,b,c){var d=[];-1==b?d.push("    "):d.push(Yi(a.b-b));d.push(" ",Zi(a.b-0));0==a.a?d.push(" Start        "):1==a.a?(d.push(" Done "),d.push(Yi(a.g-a.startTime)," ms ")):d.push(" Comment      ");d.push(c,a);0<a.f&&d.push("[VarAlloc ",a.f,"] ");return d.join("")}Vi.prototype.toString=function(){return null==this.type?this.c:"["+this.type+"] "+this.c};
Ui.prototype.toString=function(){for(var a=[],b=-1,c=[],d=0;d<this.a.length;d++){var e=this.a[d];1==e.a&&c.pop();a.push(" ",Xi(e,b,c.join("")));b=e.b;a.push("\n");0==e.a&&c.push("|  ")}if(0!=this.c.Ib()){var f=ma();a.push(" Unstopped timers:\n");Hc(this.c,function(b){a.push("  ",b," (",f-b.startTime," ms, started at ",Zi(b.startTime),")\n")})}b=this.f.ra();for(d=0;d<b.length;d++)c=this.f.get(b[d]),1<c.count&&a.push(" TOTAL ",c,"\n");a.push("Total tracers created ",0,"\n","Total comments created ",
0,"\n","Overhead start: ",0," ms\n","Overhead end: ",0," ms\n","Overhead comment: ",0," ms\n");return a.join("")};function Yi(a){a=Math.round(a);var b="";1E3>a&&(b=" ");100>a&&(b="  ");10>a&&(b="   ");return b+a}function Zi(a){a=Math.round(a);return String(100+a/1E3%60).substring(1,3)+"."+String(1E3+a%1E3).substring(1,4)}new Ui;var $i="closure_listenable_"+(1E6*Math.random()|0),aj=0;function bj(a,b,c,d,e){this.listener=a;this.a=null;this.src=b;this.type=c;this.ab=!!d;this.kb=e;this.key=++aj;this.Ca=this.$a=!1}function cj(a){a.Ca=!0;a.listener=null;a.a=null;a.src=null;a.kb=null};function dj(a){this.src=a;this.a={};this.b=0}dj.prototype.add=function(a,b,c,d,e){var f=a.toString();a=this.a[f];a||(a=this.a[f]=[],this.b++);var g=ej(a,b,d,e);-1<g?(b=a[g],c||(b.$a=!1)):(b=new bj(b,this.src,f,!!d,e),b.$a=c,a.push(b));return b};function fj(a,b){var c=b.type;c in a.a&&Ua(a.a[c],b)&&(cj(b),0==a.a[c].length&&(delete a.a[c],a.b--))}function ej(a,b,c,d){for(var e=0;e<a.length;++e){var f=a[e];if(!f.Ca&&f.listener==b&&f.ab==!!c&&f.kb==d)return e}return-1};var gj="closure_lm_"+(1E6*Math.random()|0),hj={},ij=0;function jj(a,b,c,d,e){if(v(b))for(var f=0;f<b.length;f++)jj(a,b[f],c,d,e);else c=kj(c),a&&a[$i]?a.ka.add(String(b),c,!1,d,e):lj(a,b,c,!1,d,e)}function lj(a,b,c,d,e,f){if(!b)throw Error("Invalid event type");var g=!!e,h=mj(a);h||(a[gj]=h=new dj(a));c=h.add(b,c,d,e,f);c.a||(d=nj(),c.a=d,d.src=a,d.listener=c,a.addEventListener?a.addEventListener(b.toString(),d,g):a.attachEvent(oj(b.toString()),d),ij++)}
function nj(){var a=pj,b=Ni?function(c){return a.call(b.src,b.listener,c)}:function(c){c=a.call(b.src,b.listener,c);if(!c)return c};return b}function qj(a,b,c,d,e){if(v(b))for(var f=0;f<b.length;f++)qj(a,b[f],c,d,e);else c=kj(c),a&&a[$i]?a.ka.add(String(b),c,!0,d,e):lj(a,b,c,!0,d,e)}
function rj(a,b,c,d,e){if(v(b))for(var f=0;f<b.length;f++)rj(a,b[f],c,d,e);else(c=kj(c),a&&a[$i])?(a=a.ka,b=String(b).toString(),b in a.a&&(f=a.a[b],c=ej(f,c,d,e),-1<c&&(cj(f[c]),La.splice.call(f,c,1),0==f.length&&(delete a.a[b],a.b--)))):a&&(a=mj(a))&&(b=a.a[b.toString()],a=-1,b&&(a=ej(b,c,!!d,e)),(c=-1<a?b[a]:null)&&sj(c))}
function sj(a){if(!y(a)&&a&&!a.Ca){var b=a.src;if(b&&b[$i])fj(b.ka,a);else{var c=a.type,d=a.a;b.removeEventListener?b.removeEventListener(c,d,a.ab):b.detachEvent&&b.detachEvent(oj(c),d);ij--;(c=mj(b))?(fj(c,a),0==c.b&&(c.src=null,b[gj]=null)):cj(a)}}}function oj(a){return a in hj?hj[a]:hj[a]="on"+a}function tj(a,b,c,d){var e=!0;if(a=mj(a))if(b=a.a[b.toString()])for(b=b.concat(),a=0;a<b.length;a++){var f=b[a];f&&f.ab==c&&!f.Ca&&(f=uj(f,d),e=e&&!1!==f)}return e}
function uj(a,b){var c=a.listener,d=a.kb||a.src;a.$a&&sj(a);return c.call(d,b)}
function pj(a,b){if(a.Ca)return!0;if(!Ni){var c=b||aa("window.event"),d=new Qi(c,this),e=!0;if(!(0>c.keyCode||void 0!=c.returnValue)){a:{var f=!1;if(0==c.keyCode)try{c.keyCode=-1;break a}catch(g){f=!0}if(f||void 0==c.returnValue)c.returnValue=!0}c=[];for(f=d.b;f;f=f.parentNode)c.push(f);for(var f=a.type,h=c.length-1;0<=h;h--){d.b=c[h];var k=tj(c[h],f,!0,d),e=e&&k}for(h=0;h<c.length;h++)d.b=c[h],k=tj(c[h],f,!1,d),e=e&&k}return e}return uj(a,new Qi(b,this))}
function mj(a){a=a[gj];return a instanceof dj?a:null}var vj="__closure_events_fn_"+(1E9*Math.random()>>>0);function kj(a){if(ea(a))return a;a[vj]||(a[vj]=function(b){return a.handleEvent(b)});return a[vj]};function wj(){be.call(this);this.ka=new dj(this);this.b=this;this.a=null}C(wj,be);wj.prototype[$i]=!0;wj.prototype.addEventListener=function(a,b,c,d){jj(this,a,b,c,d)};wj.prototype.removeEventListener=function(a,b,c,d){rj(this,a,b,c,d)};wj.prototype.ja=function(){wj.D.ja.call(this);if(this.ka){var a=this.ka,b=0,c;for(c in a.a){for(var d=a.a[c],e=0;e<d.length;e++)++b,cj(d[e]);delete a.a[c];a.b--}}this.a=null};
function xj(a,b,c,d){b=a.ka.a[String(b)];if(!b)return!0;b=b.concat();for(var e=!0,f=0;f<b.length;++f){var g=b[f];if(g&&!g.Ca&&g.ab==c){var h=g.listener,k=g.kb||g.src;g.$a&&fj(a.ka,g);e=!1!==h.call(k,d)&&e}}return e&&0!=d.mc};/*
 Copyright 2012 YDN Authors, Yathit. All Rights Reserved.
 Licensed under the Apache License, Version 2.0 (the "License");.
*/
function yj(a){a.i||(a.i=new wj);return a.i}vg.prototype.addEventListener=function(a,b,c,d){if("ready"==a)qj(yj(this),a,b,c,d);else{var e="created error fail ready deleted updated versionchange".split(" "),f=function(a){if(!(0<=Ma(e,a)))throw new K('Invalid event type "'+a+'"');};if(w(a))for(var g=0;g<a.length;g++)f(a[g]);else f(a);jj(yj(this),a,b,c,d)}};vg.prototype.removeEventListener=function(a,b,c,d){rj(yj(this),a,b,c,d)};
vg.prototype.N=function(a){var b=yj(this),c,d=b.a;if(d)for(c=[];d;d=d.a)c.push(d);b=b.b;d=a.type||a;if(x(a))a=new ee(a,b);else if(a instanceof ee)a.target=a.target||b;else{var e=a;a=new ee(d,b);kb(a,e)}var e=!0,f;if(c)for(var g=c.length-1;0<=g;g--)f=a.b=c[g],e=xj(f,d,!0,a)&&e;f=a.b=b;e=xj(f,d,!0,a)&&e;e=xj(f,d,!1,a)&&e;if(c)for(g=0;g<c.length;g++)f=a.b=c[g],e=xj(f,d,!1,a)&&e};vg.prototype.addEventListener=vg.prototype.addEventListener;vg.prototype.removeEventListener=vg.prototype.removeEventListener;Vg.prototype.countOf=Vg.prototype.Ja;Vg.prototype.keysOf=Vg.prototype.Na;Vg.prototype.open=Vg.prototype.open;Vg.prototype.scan=Vg.prototype.Qc;Vg.prototype.valuesOf=Vg.prototype.Sa;Sg.prototype.countOf=Sg.prototype.Ja;Sg.prototype.keysOf=Sg.prototype.Na;Sg.prototype.open=Sg.prototype.open;Sg.prototype.scan=Sg.prototype.Tb;Sg.prototype.valuesOf=Sg.prototype.Sa;yg.prototype.getKey=yg.prototype.Rc;yg.prototype.getPrimaryKey=yg.prototype.A;yg.prototype.getValue=yg.prototype.O;yg.prototype.update=yg.prototype.update;
yg.prototype.clear=yg.prototype.clear;na("ydn.db.Iterator",X);na("ydn.db.KeyIterator",Fg);na("ydn.db.ValueIterator",Hg);na("ydn.db.IndexIterator",Gg);na("ydn.db.IndexValueIterator",Ig);X.prototype.getState=X.prototype.xc;X.prototype.getKeyRange=X.prototype.pc;X.prototype.getIndexName=X.prototype.Ic;X.prototype.getStoreName=X.prototype.j;X.prototype.isReversed=X.prototype.ha;X.prototype.isUnique=X.prototype.Ea;X.prototype.isKeyIterator=X.prototype.Kc;X.prototype.isIndexIterator=X.prototype.yc;
X.prototype.getPrimaryKey=X.prototype.A;X.prototype.getKey=X.prototype.Jc;X.prototype.resume=X.prototype.qc;X.prototype.reset=X.prototype.Pb;X.prototype.reverse=X.prototype.reverse;Fg.where=function(a,b,c,d,e){return new Fg(a,De(b,c,d,e))};Hg.where=function(a,b,c,d,e){return new Hg(a,De(b,c,d,e))};Gg.where=function(a,b,c,d,e,f){return new Gg(a,b,De(c,d,e,f))};Ig.where=function(a,b,c,d,e,f){return new Ig(a,b,De(c,d,e,f))};na("ydn.db.Streamer",Ng);Ng.prototype.push=Ng.prototype.push;
Ng.prototype.collect=Ng.prototype.Oc;Ng.prototype.setSink=Ng.prototype.Fc;function zj(a,b){Qg.call(this,a,b)}C(zj,Qg);zj.prototype.h=function(){return!1};zj.prototype.c=function(a,b){function c(b){t(a[b])?(e=!1,d[b]=!0):(d[b]=!1,0<=b-1&&c(b-1))}var d=[],e=!0;c(a.length-1);e&&(d=[]);return Rg(this,d,b)};function Aj(a,b){Qg.call(this,a,b)}C(Aj,Qg);
Aj.prototype.c=function(a,b){var c=[],d=b[0];if(null==d)return[];for(var e=!0,f=!1,g=d,h=[],k=1;k<a.length;k++)if(null!=b[k]){var m=Q(d,b[k]);h[k]=m;this.b?-1==m?e=!1:1==m&&(e=!1,f=!0,-1==Q(b[k],g)&&(g=b[k])):1==m?e=!1:-1==m&&(e=!1,f=!0,1==Q(b[k],g)&&(g=b[k]))}else e=!1,f=!0;if(e)for(f=0;f<a.length;f++)null!=b[f]&&(c[f]=!0);else if(f)for(f=0;f<a.length;f++)null!=b[f]&&(this.b?-1==Q(g,b[f])&&(c[f]=g):1==Q(g,b[f])&&(c[f]=g));else for(k=this.b?-1:1,f=1;f<a.length;f++)h[f]===k&&(c[f]=d);return e?(this.g++,
this.a&&this.a.push(g),c):{continuePrimary:c}};function Bj(a,b){Qg.call(this,a,b)}C(Bj,Qg);Bj.prototype.logger=E("ydn.db.algo.ZigzagMerge");
Bj.prototype.c=function(a,b){function c(a,b){var c=a.slice(0,a.length-1);c.push(b);return c}function d(a){return a[a.length-1]}var e=[];if(0==a.length||null==a[0]||null==a[0])return[];for(var f=!0,g=0,h=d(a[g]),k=[],m=1;m<a.length;m++)if(null!=a[m]){var n=d(a[m]),p=Q(h,n);k[m]=p;this.b?-1==p?f=!1:1==p&&(f=!1,h=n,g=1):1==p?f=!1:-1==p&&(f=!1,h=n,g=1)}else return[];m=this.b?-1:1;if(f){for(f=0;f<a.length;f++)null!=a[f]&&(e[f]=!0);this.a&&(this.f?this.a.push(b[0],h):this.a.push(b[0]));return e}if(0==g)for(f=
1;f<a.length;f++)k[f]==m&&(e[f]=c(a[f],h));else for(f=0;f<a.length;f++)f!=g&&null!=a[f]&&Q(h,d(a[f]))===m&&(e[f]=c(a[f],h));return{"continue":e}};na("ydn.db.algo.NestedLoop",zj);na("ydn.db.algo.ZigzagMerge",Bj);na("ydn.db.algo.SortedMerge",Aj);function Cj(a){this.b=a||[]}Cj.prototype.a=function(a){return-1==this.b.indexOf(a)?a:null};function Dj(){}
Dj.prototype.a=function(a){var b={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},c={icate:"ic",ative:"",alize:"al",iciti:"ic",ical:"ic",ful:"",ness:""};a=a.toLowerCase();var d,e,f=a;if(3>a.length)return a;var g,h;a=a.substr(0,1);"y"==a&&(f=a.toUpperCase()+f.substr(1));g=/^(.+?)(ss|i)es$/;e=/^(.+?)([^s])s$/;
g.test(f)?f=f.replace(g,"$1$2"):e.test(f)&&(f=f.replace(e,"$1$2"));g=/^(.+?)eed$/;e=/^(.+?)(ed|ing)$/;g.test(f)?(e=g.exec(f),g=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,g.test(e[1])&&(g=/.$/,f=f.replace(g,""))):e.test(f)&&(e=e.exec(f),d=e[1],e=/^([^aeiou][^aeiouy]*)?[aeiouy]/,e.test(d)&&(f=d,e=/(at|bl|iz)$/,h=/([^aeiouylsz])\1$/,d=/^[^aeiou][^aeiouy]*[aeiouy][^aeiouwxy]$/,e.test(f)?f+="e":h.test(f)?(g=/.$/,f=f.replace(g,"")):d.test(f)&&(f+="e")));g=/^(.+?)y$/;g.test(f)&&(e=g.exec(f),
d=e[1],g=/^([^aeiou][^aeiouy]*)?[aeiouy]/,g.test(d)&&(f=d+"i"));g=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/;g.test(f)&&(e=g.exec(f),d=e[1],e=e[2],g=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,g.test(d)&&(f=d+b[e]));g=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/;g.test(f)&&(e=g.exec(f),d=e[1],e=e[2],g=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,g.test(d)&&(f=d+c[e]));g=
/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/;e=/^(.+?)(s|t)(ion)$/;g.test(f)?(e=g.exec(f),d=e[1],g=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,g.test(d)&&(f=d)):e.test(f)&&(e=e.exec(f),d=e[1]+e[2],e=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,e.test(d)&&(f=d));g=/^(.+?)e$/;g.test(f)&&(e=g.exec(f),d=e[1],g=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,
e=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*([aeiouy][aeiou]*)?$/,h=/^[^aeiou][^aeiouy]*[aeiouy][^aeiouwxy]$/,g.test(d)||e.test(d)&&!h.test(d))&&(f=d);g=/ll$/;e=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/;g.test(f)&&e.test(f)&&(g=/.$/,f=f.replace(g,""));"y"==a&&(f=a.toLowerCase()+f.substr(1));return f};function Ej(a){this.b=a}
Ej.prototype.a=function(a){a=a.toLowerCase();a=a.replace(/([^c])\1/g,"$1");a=function(a){return a.match(/^(kn|gn|pn|ae|wr)/)?a.substr(1,a.length-1):a}(a);a=a.replace(/mb$/,"m");a=a.replace(/ck/g,"k");a=function(a){a=a.replace(/([^s]|^)(c)(h)/g,"$1x$3").trim();a=a.replace(/cia/g,"xia");a=a.replace(/c(i|e|y)/g,"s$1");return a=a.replace(/c/g,"k")}(a);a=function(a){a=a.replace(/d(ge|gy|gi)/g,"j$1");return a=a.replace(/d/g,"t")}(a);a=function(a){a=a.replace(/gh(^$|[^aeiou])/g,"h$1");return a=a.replace(/g(n|ned)$/g,
"$1")}(a);a=function(a){a=a.replace(/([^g]|^)(g)(i|e|y)/g,"$1j$3");a=a.replace(/gg/g,"g");return a=a.replace(/g/g,"k")}(a);a=a.replace(/([aeiou])h([^aeiou])/g,"$1$2");a=a.replace(/ph/g,"f");a=a.replace(/q/g,"k");a=a.replace(/s(h|io|ia)/g,"x$1");a=function(a){a=a.replace(/^x/,"s");return a=a.replace(/x/g,"ks")}(a);a=function(a){a=a.replace(/t(ia|io)/g,"x$1");return a=a.replace(/th/,"0")}(a);a=a.replace(/tch/g,"ch");a=a.replace(/v/g,"f");a=a.replace(/^wh/,"w");a=a.replace(/w([^aeiou]|$)/g,"$1");a=a.replace(/y([^aeiou]|$)/g,
"$1");a=a.replace(/z/,"s");a=a.charAt(0)+a.substr(1,a.length).replace(/[aeiou]/g,"");a.length>=this.b&&(a=a.substring(0,this.b));return a=a.toUpperCase()};var Fj=new Ej(32),Gj=new Dj,Hj=new Cj("a a's able about above according accordingly across actually after afterwards again against ain't all allow allows almost alone along already also although always am among amongst an and another any anybody anyhow anyone anything anyway anyways anywhere apart appear appreciate appropriate are aren't around as aside ask asking associated at available away awfully b be became because become becomes becoming been before beforehand behind being believe below beside besides best better between beyond both brief but by c c'mon c's came can can't cannot cant cause causes certain certainly changes clearly co com come comes concerning consequently consider considering contain containing contains corresponding could couldn't course currently d definitely described despite did didn't different do does doesn't doing don't done down downwards during e each edu eg eight either else elsewhere enough entirely especially et etc even ever every everybody everyone everything everywhere ex exactly example except f far few fifth first five followed following follows for former formerly forth four from further furthermore g get gets getting given gives go goes going gone got gotten greetings h had hadn't happens hardly has hasn't have haven't having he he's hello help hence her here here's hereafter hereby herein hereupon hers herself hi him himself his hither hopefully how howbeit however i i'd i'll i'm i've ie if ignored immediate in inasmuch inc indeed indicate indicated indicates inner insofar instead into inward is isn't it it'd it'll it's its itself j just k keep keeps kept know knows known l last lately later latter latterly least less lest let let's like liked likely little look looking looks ltd m mainly many may maybe me mean meanwhile merely might more moreover most mostly much must my myself n name namely nd near nearly necessary need needs neither never nevertheless new next nine no nobody non none noone nor normally not nothing novel now nowhere o obviously of off often oh ok okay old on once one ones only onto or other others otherwise ought our ours ourselves out outside over overall own p particular particularly per perhaps placed please plus possible presumably probably provides q que quite qv r rather rd re really reasonably regarding regardless regards relatively respectively right s said same saw say saying says second secondly see seeing seem seemed seeming seems seen self selves sensible sent serious seriously seven several shall she should shouldn't since six so some somebody somehow someone something sometime sometimes somewhat somewhere soon sorry specified specify specifying still sub such sup sure t t's take taken tell tends th than thank thanks thanx that that's thats the their theirs them themselves then thence there there's thereafter thereby therefore therein theres thereupon these they they'd they'll they're they've think third this thorough thoroughly those though three through throughout thru thus to together too took toward towards tried tries truly try trying twice two u un under unfortunately unless unlikely until unto up upon us use used useful uses using usually uucp v value various very via viz vs w want wants was wasn't way we we'd we'll we're we've welcome well went were weren't what what's whatever when whence whenever where where's whereafter whereas whereby wherein whereupon wherever whether which while whither who who's whoever whole whom whose why will willing wish with within without won't wonder would wouldn't x y yes yet you you'd you'll you're you've your yours yourself yourselves z zero".split(" "));function Ij(a){this.data=a;this.a=0}Ij.prototype.next=function(a){for(var b=this.a,c=this.data[b],c=1,d=0;0<=b&&b<this.data.length;){c=this.data[b];if(c instanceof Array)if(a<c[0])c=-1;else if(a>c[1])c=1;else return this.a=b,!0;else{if(c==a)return this.a=b,!0;c=a<c?-1:1}if(0==d)d=c;else if(d!=c)break;b+=c;if(b>this.data.length||0>b)break}return!1};
function Jj(a,b){for(var c=0,d=0,e=a.length,f=0;f<e;++f){a:{var d=a.charCodeAt(f),g=new Ij(categ_letters_numbers_data);if(y(d))d=g.next(d);else{for(var h=0,k=d.length;h<k;++h)if(!1===g.next(d[h])){d=!1;break a}d=!0}}d||((d=f-c)&&b(c,d),c=f+1)}(d=e-c)&&b(c,d)};function Kj(a,b){this.g=b;this.value=a}Kj.prototype.O=function(){return this.value};Kj.prototype.b=function(){return 1};Kj.prototype.G=function(){return this.value};Kj.prototype.toString=function(){return"Entry:"+this.value};function Lj(a,b,c,d,e,f){Kj.call(this,d,e);this.H=a;this.c=b;this.f=c;this.pb=f||[]}C(Lj,Kj);l=Lj.prototype;l.Qa=function(){return{k:this.g,v:this.value.toLowerCase(),id:this.G(),loc:this.pb}};l.G=function(){return[this.H,this.f,this.c,this.value]};l.j=function(){return this.H};l.A=function(){return this.f};l.toString=function(){return["IndexEntry",this.H,this.f,this.value].join(":")};function Mj(a,b,c,d,e){Kj.call(this,b,c);this.h=d;this.a=e;this.type=a;this.ac=1}C(Mj,Kj);Mj.prototype.b=function(){return this.a*this.type*this.ac};Mj.prototype.G=function(){return this.value+"|"+this.h};function Nj(a,b){Lj.call(this,b.j(),b.c,b.A(),b.O(),b.g,[]);this.i=a;this.a=[b]}C(Nj,Lj);Nj.prototype.count=function(){return this.a.length};function Oj(a,b){for(var c=b.a[0],d=0;d<a.a.length;d++)if(a.a[d].c==c.c&&a.a[d].value==c.value)return;a.a.push(c)}Nj.prototype.b=function(){for(var a=0,b=0;b<this.a.length;b++)var c=this.a[b],d=pf(this.i,c.j(),c.c),c=c.b(),a=a+c*d.b;return a};function cb(a,b){var c=a.b(),d=b.b();return c<=d?1:-1}
Nj.prototype.Qa=function(){for(var a={value:this.value,primaryKey:this.f,storeName:this.H,score:this.b(),tokens:[]},b=0;b<this.a.length;b++)a.tokens[b]=this.a[b].Qa();return a};Nj.prototype.toString=function(){return["RankEntry",this.H,this.f,this.value].join(":")+"["+this.a.length+"]"};function Pj(a){var b=[],c;a=a.split(/\s+/);for(var d=0;d<a.length;d++){c=a[d];for(var e=c.length-1,f=Array(e),g=0;g<e;g++)f[g]=c.substring(g,g+2);c=f;b.push.apply(b,c)}return b};function Qj(a,b,c,d,e,f,g){Lj.call(this,b,c,d,e,f,g);this.a=a}C(Qj,Lj);Qj.prototype.b=function(){var a,b=this.value;a=Pj(this.a.value.toLowerCase().replace(/^\s+|\s+$/g,""));var b=Pj(b.toLowerCase().replace(/^\s+|\s+$/g,"")),c=0,d=a.length+b.length,e,f,g,h;for(e=0;e<a.length;e++)for(g=a[e],f=0;f<b.length;f++)if(h=b[f],g==h){c++;delete b[f];break}a=2*c/d;b=Math.log(this.pb.length+1);c=this.a.b();return b*a*c};Qj.prototype.Qa=function(){return{keyPath:this.c,value:this.value,loc:this.pb.slice()}};
Qj.prototype.toString=function(){return["ResultEntry",this.H,this.f,this.value].join(":")};function Rj(a,b){this.a=a;this.b=b;this.f=[];this.c=0}function Sj(a,b){for(var c,d,e=a.a.getName(),f=0;f<a.b.length;f++){var g=a.b[f],h=g.type;.4==h||.6==h?(d="v",c=g.O().toLowerCase(),c=xe(c)):(d="v",c=g.O().toLowerCase(),c=te(c));b(e,d,c,g);a.c++;.6==h&&(d="k",c=g.g,c=te(c),b(e,d,c,g),a.c++)}}function Tj(a){for(var b=[a.a.getName()],c=0;c<a.a.count();c++){var d=a.a.index(c).j();-1==b.indexOf(d)&&b.push(d)}return b}
Rj.prototype.g=function(){for(var a=[],b=[],c=0;c<this.f.length;c++){var d=this.f[c];if(0==d.a.type)-1==Sa(b,function(a){return a.A()==d.A()&&a.j()==d.j()})&&b.push(d);else{var e=new Nj(this.a,d),f=Sa(a,function(a){return a.A()==e.A()&&a.j()==e.j()});if(0<=f){var g=a[f];La.splice.call(a,f,1);Oj(g,e);e=g}bb(a,e)}}for(f=0;f<b.length;f++)for(g=b[f],c=a.length-1;0<=c;--c){var h=a[c];if(g.A()==h.A()&&g.j()==h.j()){a.splice(f,1);break}}return a.map(function(a){return a.Qa()})};function Uj(a){this.a=a;if("en"==a.c){a=a.f||["stop","stemmer","metaphone"];for(var b=[],c=0;c<a.length;c++)if("metaphone"==a[c])b.push(Fj);else if("stemmer"==a[c])b.push(Gj);else if("stop"==a[c])b.push(Hj);else throw Error('Invalid normalizer "'+a[c]+'" for English lang');a=b}else a=[];this.b=a}function Vj(a,b){for(var c=0;c<a.b.length;c++){var d=a.b[c].a(b);if(d)b=d;else return null}return b}
function Wj(a,b){var c=[],d=[];Jj(b,function(a,e){c.push(b.substr(a,e));d.push(a)});for(var e=[],f=0;f<c.length;f++)e[f]=Vj(a,c[f]);for(var g=[],h=0,f=0;f<c.length;f++){var k=c[f],m=e[f],n="*"==b.charAt(d[f]+k.length),p=n?d[f]+k.length+1:d[f]+k.length,p='"'==b.charAt(d[f]-1)&&'"'==b.charAt(p),q="-"==b.charAt(p?d[f]-2:d[f]-1),u=.8;n?u=.4:p?u=1:q?u=0:null!=m&&(u=.6);k=new Mj(u,k,m,d[f],1/(f+2));g.push(k);h+=k.b()}for(f=0;f<g.length;++f)g[f].ac=1/h;return g}
function Xj(a,b,c,d){var e=[],f=[];Jj(b,function(a,c){e.push(b.substr(a,c));f.push(a)});for(var g=[],h=0;h<e.length;h++)g[h]=Vj(a,e[h]);a=c.j();c=c.a;for(var k=[],h=0;h<e.length;h++){var m=e[h],n=g[h];if(null!=n){var p=Ra(k,function(a){return a.O()==m});p||(p=new Lj(a,c,d,m,n),k.push(p));p.pb.push(f[h])}}return k}function Yj(a,b,c,d){for(var e=[],f=0;f<a.a.count();f++){var g=a.a.index(f);if(g.j()==b){var h=Fd(d,g.a);x(h)&&(e=e.concat(Xj(a,h,g,c)))}}return e};W.prototype.Zb=function(a,b){var c=this;b.a=new Uj(b);df(a,function(d,e){function f(e){var f=a.getName();oe(e)&&Wd(d,function(a,g,h){if(g)h(a,g);else{Ad(d,a);var k=re(ue([f,e],[f,e,"\uffff"])),B=b.getName();pg(c.a,B,k).ya(function(){h(a,g)})}})}function g(b){var e=a.getName();Wd(d,function(a,f,g){f?g(a,f):(Ad(d,a),b&&(b=re(ue([e,b.lower],[e,b.upper,"\uffff"]))),pg(c.a,e,b).ya(function(){g(a,f)}))})}function h(e,f){var g=a.getName();Wd(d,function(a,h,k){Ad(d,a);if(h)k(a,h);else{var B=b.getName();v(a)||
(a=[a]);for(var H=0;H<a.length;H++){var G=a[H];if(oe(G)){if(f){var P=re(ue([g,G],[g,G,"\uffff"]));pg(c.a,B,P)}G=Yj(b.a,g,G,e[H]).map(function(a){return a.Qa()});G=ng(c.a,B,G);H==a.length-1&&G.ya(function(){k(a,h)})}}}})}var k=d.o;"put"==k?h([e[1]],!0):"put:array"==k?h(e[1],!0):"add"==k?h([e[1]],!1):"add:array"==k?h(e[1],!1):"rm:iter"==k||"clear"==k?g(e[1]):"rm"==k&&f(e[1])})};
function Zj(a,b){var c=Tj(b);I(a.logger,"query "+b);var d=a.a.request("search",c,Cd);N(d,function(){var a=U(this);Sj(b,function(c,g,h,k){var m=Td(d);a.Z(m,4,c,g,se(h),100,0,!1,!1);m.ya(function(a){var c=null;a instanceof Array||(c=a,a=[]);for(var e=0;e<a.length;e++){var f;f=a[e];var g=f.id,g=x(g)?Ld(g):g,h=g[3];(f=1==this.type&&h!=this.value?null:new Qj(this,g[0],g[2],g[1],h,f.k,f.loc))&&b.f.push(f)}b.c--;a=0==b.c?!1:b.b[b.b.length-1].h===this.h?!0:null;!0===a?Ad(d,b):!1===a&&d.callback(b.g());if(c)throw c;
},k)})},a);return d}W.prototype.R=function(a,b){var c=vf(this.b,a);if(!c)throw new K('full text index catalog "'+a+'" not found.');var c=c.a,d=Wj(c,b),c=0==d.length?null:new Rj(c.a,d);return c?Zj(this.a,c):(this.logger.log(id,'query "'+b+'" contains only noise and search is ignored',void 0),Xd("search",null))};W.prototype.search=W.prototype.R;Rj.prototype.collect=Rj.prototype.g;function ak(a,b,c){this.db=a;this.b=b;this.type=c||0;this.c=null};function bk(a,b,c,d){this.f=a;this.a=b||null;this.h=!!c;this.g=!!d;this.b=[];this.c=[]}function ck(a,b){for(var c=b.length-1;0<=c;c--)if(b[c]==a.b[a.b.length-1])b=b.slice(0,c);else break;a.c=b;if(a.a&&a.b[0]){if(a.a.lower!=a.a.upper)throw new Pf("Ordering no allowed with range query");a.a=xe([a.a.lower])}return null}
function dk(a,b){if((0!=a.b.length||0!=a.c.length)&&ek(a)&&!fk(a))throw new Pf('Require index "'+a.b.concat(a.c).join(", ")+'" not found in store "'+a.f.getName()+'"');var c=new X(a.f.getName(),gk(a),a.a,a.h,a.g,!b);c.F=a.b.length;return c}l=bk.prototype;l.j=function(){return this.f.getName()};l.clone=function(){var a=new bk(this.f,this.a,this.h,this.g);a.c=this.c.slice();a.b=this.b.slice();return a};
function fk(a){var b=a.b.concat(a.c),c=Ve(a.f,b);return c||b[b.length-1]==a.f.keyPath&&(c=Ve(a.f,b.slice(0,b.length-1)))?c:null}function gk(a){return(a=fk(a))?a.getName():void 0}l.reverse=function(){var a=this.clone();a.h=!this.h;return a};l.unique=function(a){var b=this.clone();b.g=!!a;return b};function ek(a){return 0<a.b.length?!0:1==a.c.length?a.c[0]!=a.f.keyPath:1<a.c.length?!0:!1}
l.w=function(a,b,c,d,e){c=De(b,c,d,e);if(0<this.b.length)if(this.a)if(null!=this.a.lower&&null!=this.a.upper&&0==Q(this.a.lower,this.a.upper))a=v(this.a.lower)?this.a.lower.slice().push(b):[this.a.lower,b],d=null!=d?d:"\uffff",c=v(this.a.upper)?this.a.upper.slice().push(d):[this.a.upper,d],this.a=De(b,a,d,c);else if(1==this.b.length&&this.b[0]==a||v(a)&&Za(this.b,a))this.a=this.a.oa(c);else return"cannot use where clause with existing filter";else return"cannot use where clause with existing filter";
else this.b=v(a)?a:[a],this.a=this.a?this.a.oa(c):c;return null};function hk(a,b,c,d){ak.call(this,a,b,c);this.a=d}C(hk,ak);hk.prototype.open=function(){var a={push:function(){}},a=jk(this)?new Bj(a):new Aj(a);return this.db.Tb(a,kk(this),L)};function kk(a){for(var b=[],c=0;c<a.a.length;c++)b[c]=dk(a.a[c]);return b}function jk(a){for(var b=0;b<a.a.length;b++)if(0<a.a[b].b.length)return!0;return!1}hk.prototype.Jb=function(){return this.a.slice()};hk.prototype.select=function(){throw Error("not impl");};
hk.prototype.reverse=function(){var a=this.a.map(function(a){return a.reverse()});return new hk(this.db,this.b,this.type,a)};function Z(a,b,c,d){ak.call(this,a,b,c);this.a=d}C(Z,ak);l=Z.prototype;l.Mc=function(){return new Z(this.db,this.b,this.type,this.a.clone())};l.reverse=function(){var a=this.a.reverse();return new Z(this.db,this.b,this.type,a)};l.unique=function(a){if(!da(a))throw new K("unique value must be a boolean, but "+typeof a+" found");a=this.a.unique(a);return new Z(this.db,this.b,this.type,a)};
l.ca=function(a){var b=x(a)?[a]:a;a=this.a.clone();if(b=ck(a,b))throw Error(b);return new Z(this.db,this.b,this.type,a)};l.w=function(a,b,c,d,e){if(gk(this.a)&&gk(this.a)!=a){var f=De(b,c,d,e),f=new bk(T(this.b,this.a.j()),f,this.a.h,this.a.g);return this.oa(new Z(this.db,this.b,this.type,f))}if(!gk(this.a)&&!We(T(this.b,this.a.j()),a))throw new K('index "'+a+'" not exists in '+this.a.j());f=this.a.clone();if(a=f.w(a,b,c,d,e))throw new K(a);return new Z(this.db,this.b,this.type,f)};
l.select=function(a){var b=T(this.b,this.a.j()),c=x(a)?[a]:a,d=this.type;a=this.a.clone();d=gk(this.a);if(1==c.length)if(d=c[0],"_ROWID_"==d||d==b.keyPath)d=2;else if(d&&"*"!=d)if(We(b,d)){if(b=ck(a,c))throw new K(b);d=1}else throw new K('Invalid select "'+d+'", index not found in store "'+b.getName()+'"');else d=4;else if(2==c.length){if(!d)throw new K("Only primary key can be selected for this query.");for(var e=0;2>e;e++){var f;if(f="_ROWID_"!=c[e]){f=b;var g=c[e];f=!(t(f.keyPath)&&(1==f.h.length?
f.keyPath===g:w(g)&&Za(f.h,g)))}if(f&&c[e]!=d)throw new K('select field name must be "'+d+'", but "'+c[e]+'" found.');}d=3}else throw new K("Selecting more than 2 field names is not supported, but "+c.length+" fields selected.");return new Z(this.db,this.b,d,a)};l.Nc=function(a){a=a||100;var b=4,c=lk(this);this.c&&this.c[0]&&(c=c.qc(this.c[0],this.c[1]));if(2==this.type||3==this.type||1==this.type)b=this.type;a=Ug(this.db,b,c,a);a.L(function(){"rest"==c.f&&(this.c=[c.i,c.A()])},this);return a};
l.Jb=function(){return[this.a.clone()]};function lk(a,b){var c=!!b;t(b)||(c=2==a.type||3==a.type||1==a.type);return dk(a.a,!c)}
l.Ac=function(a,b){var c=lk(this);c.c&&(c=new X(c.g,c.b,c.a,c.ha(),c.Ea(),!1,c.h));if(1>arguments.length)throw new K("too few arguments");if(2==arguments.length){if(!x(a)&&v(a)){if(!v(b))throw new K("an array is expected for second argument but, "+mf(b)+" of type "+typeof b+" found");if(a.length!=b.length)throw new K("length of two input arguments must be equal but, "+a.length+" and "+b.length+" found");}}else if(1==arguments.length){if(!z(a))throw new K("an object is expected but, "+mf(a)+" of type "+
typeof a+" found");}else throw new K("too many arguments");var d=this.db.open(function(c){var f=c.O();if(x(a))Gd(f,a,b);else if(v(a))for(var g=0;g<a.length;g++)Gd(f,a[g],b[g]);else if(z(a))for(g in a)a.hasOwnProperty(g)&&(f[g]=a[g]);Rb(d,c.update(f))},c,L,this);return d};l.open=function(a,b){return this.db.open(a,lk(this,!1),L,b)};l.count=function(){return ek(this.a)?this.a.g?this.db.count(dk(this.a)):this.db.count(this.a.j(),gk(this.a),this.a.a):this.db.count(this.a.j(),this.a.a)};
l.clear=function(){return ek(this.a)?this.db.clear(this.a.j(),gk(this.a),this.a.a):this.db.clear(this.a.j(),this.a.a)};l.oa=function(a){a=a.Jb().concat(this.Jb());return new hk(this.db,this.b,this.type,a)};
Vg.prototype.aa=function(a,b,c,d,e){if(!x(a))throw new TypeError('store name "'+a+'"');if(!tf(this.b,a))throw new K('Store "'+a+'" not found.');var f=null;if(t(b)){if(!t(c))throw new K("boundary value must be defined.");f=De(b,c,d,e)}else if(t(d))throw new K("second boundary must not be defined.");a=new bk(T(this.b,a),f);return new Z(this.a,this.b,null,a)};
Sg.prototype.aa=function(a,b,c,d,e){if(!x(a))throw new TypeError('store name "'+a+'"');if(!tf(this.b,a))throw new K('Store "'+a+'" not found.');var f=null;if(t(b)){if(!t(c))throw new K("boundary value must be defined.");f=De(b,c,d,e)}else if(t(d))throw new K("second boundary must not be defined.");a=new bk(T(this.b,a),f);return new Z(this,this.b,null,a)};E("ydn.db.query.ConjunctionCursor");Z.prototype.copy=Z.prototype.Mc;Z.prototype.count=Z.prototype.count;Z.prototype.list=Z.prototype.Nc;Z.prototype.order=Z.prototype.ca;Z.prototype.patch=Z.prototype.Ac;Z.prototype.reverse=Z.prototype.reverse;Z.prototype.unique=Z.prototype.unique;Z.prototype.where=Z.prototype.w;Vg.prototype.from=Vg.prototype.aa;Sg.prototype.from=Sg.prototype.aa;function mk(a){this.h=a;this.b=this.h.length/4;this.f=this.b+6;this.c=[[],[],[],[]];this.g=[[],[],[],[]];this.a=Array(4*(this.f+1));for(a=0;a<this.b;a++)this.a[a]=[this.h[4*a],this.h[4*a+1],this.h[4*a+2],this.h[4*a+3]];var b=Array(4);for(a=this.b;a<4*(this.f+1);a++){b[0]=this.a[a-1][0];b[1]=this.a[a-1][1];b[2]=this.a[a-1][2];b[3]=this.a[a-1][3];if(0==a%this.b){var c=b,d=c[0];c[0]=c[1];c[1]=c[2];c[2]=c[3];c[3]=d;nk(b);b[0]^=ok[a/this.b][0];b[1]^=ok[a/this.b][1];b[2]^=ok[a/this.b][2];b[3]^=ok[a/this.b][3]}else 6<
this.b&&4==a%this.b&&nk(b);this.a[a]=Array(4);this.a[a][0]=this.a[a-this.b][0]^b[0];this.a[a][1]=this.a[a-this.b][1]^b[1];this.a[a][2]=this.a[a-this.b][2]^b[2];this.a[a][3]=this.a[a-this.b][3]^b[3]}}function pk(a,b){for(var c,d=0;4>d;d++)for(var e=0;4>e;e++)c=4*e+d,c=b[c],a.c[d][e]=c}function qk(a){for(var b=[],c=0;4>c;c++)for(var d=0;4>d;d++)b[4*d+c]=a.c[c][d];return b}function rk(a,b){for(var c=0;4>c;c++)for(var d=0;4>d;d++)a.c[c][d]^=a.a[4*b+d][c]}
function sk(a,b){for(var c=0;4>c;c++)for(var d=0;4>d;d++)a.c[c][d]=b[a.c[c][d]]}function tk(a){for(var b=1;4>b;b++)for(var c=0;4>c;c++)a.g[b][c]=a.c[b][c];for(b=1;4>b;b++)for(c=0;4>c;c++)a.c[b][c]=a.g[b][(c+b)%4]}function uk(a){for(var b=1;4>b;b++)for(var c=0;4>c;c++)a.g[b][(c+b)%4]=a.c[b][c];for(b=1;4>b;b++)for(c=0;4>c;c++)a.c[b][c]=a.g[b][c]}function nk(a){a[0]=vk[a[0]];a[1]=vk[a[1]];a[2]=vk[a[2]];a[3]=vk[a[3]]}
var vk=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,
61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],wk=[82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,
255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,
26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125],ok=[[0,0,0,0],[1,0,0,0],[2,0,0,0],[4,0,0,0],[8,0,0,0],[16,0,0,0],[32,0,0,0],[64,0,0,0],[128,0,0,0],[27,0,0,0],[54,0,0,0]],xk=[0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,
32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,118,120,122,124,126,128,130,132,134,136,138,140,142,144,146,148,150,152,154,156,158,160,162,164,166,168,170,172,174,176,178,180,182,184,186,188,190,192,194,196,198,200,202,204,206,208,210,212,214,216,218,220,222,224,226,228,230,232,234,236,238,240,242,244,246,248,250,252,254,27,25,31,29,19,17,23,21,11,9,15,13,3,1,7,5,59,57,63,61,51,49,55,53,43,41,47,45,35,33,39,
37,91,89,95,93,83,81,87,85,75,73,79,77,67,65,71,69,123,121,127,125,115,113,119,117,107,105,111,109,99,97,103,101,155,153,159,157,147,145,151,149,139,137,143,141,131,129,135,133,187,185,191,189,179,177,183,181,171,169,175,173,163,161,167,165,219,217,223,221,211,209,215,213,203,201,207,205,195,193,199,197,251,249,255,253,243,241,247,245,235,233,239,237,227,225,231,229],yk=[0,3,6,5,12,15,10,9,24,27,30,29,20,23,18,17,48,51,54,53,60,63,58,57,40,43,46,45,36,39,34,33,96,99,102,101,108,111,106,105,120,123,
126,125,116,119,114,113,80,83,86,85,92,95,90,89,72,75,78,77,68,71,66,65,192,195,198,197,204,207,202,201,216,219,222,221,212,215,210,209,240,243,246,245,252,255,250,249,232,235,238,237,228,231,226,225,160,163,166,165,172,175,170,169,184,187,190,189,180,183,178,177,144,147,150,149,156,159,154,153,136,139,142,141,132,135,130,129,155,152,157,158,151,148,145,146,131,128,133,134,143,140,137,138,171,168,173,174,167,164,161,162,179,176,181,182,191,188,185,186,251,248,253,254,247,244,241,242,227,224,229,230,
239,236,233,234,203,200,205,206,199,196,193,194,211,208,213,214,223,220,217,218,91,88,93,94,87,84,81,82,67,64,69,70,79,76,73,74,107,104,109,110,103,100,97,98,115,112,117,118,127,124,121,122,59,56,61,62,55,52,49,50,35,32,37,38,47,44,41,42,11,8,13,14,7,4,1,2,19,16,21,22,31,28,25,26],zk=[0,9,18,27,36,45,54,63,72,65,90,83,108,101,126,119,144,153,130,139,180,189,166,175,216,209,202,195,252,245,238,231,59,50,41,32,31,22,13,4,115,122,97,104,87,94,69,76,171,162,185,176,143,134,157,148,227,234,241,248,199,
206,213,220,118,127,100,109,82,91,64,73,62,55,44,37,26,19,8,1,230,239,244,253,194,203,208,217,174,167,188,181,138,131,152,145,77,68,95,86,105,96,123,114,5,12,23,30,33,40,51,58,221,212,207,198,249,240,235,226,149,156,135,142,177,184,163,170,236,229,254,247,200,193,218,211,164,173,182,191,128,137,146,155,124,117,110,103,88,81,74,67,52,61,38,47,16,25,2,11,215,222,197,204,243,250,225,232,159,150,141,132,187,178,169,160,71,78,85,92,99,106,113,120,15,6,29,20,43,34,57,48,154,147,136,129,190,183,172,165,
210,219,192,201,246,255,228,237,10,3,24,17,46,39,60,53,66,75,80,89,102,111,116,125,161,168,179,186,133,140,151,158,233,224,251,242,205,196,223,214,49,56,35,42,21,28,7,14,121,112,107,98,93,84,79,70],Ak=[0,11,22,29,44,39,58,49,88,83,78,69,116,127,98,105,176,187,166,173,156,151,138,129,232,227,254,245,196,207,210,217,123,112,109,102,87,92,65,74,35,40,53,62,15,4,25,18,203,192,221,214,231,236,241,250,147,152,133,142,191,180,169,162,246,253,224,235,218,209,204,199,174,165,184,179,130,137,148,159,70,77,
80,91,106,97,124,119,30,21,8,3,50,57,36,47,141,134,155,144,161,170,183,188,213,222,195,200,249,242,239,228,61,54,43,32,17,26,7,12,101,110,115,120,73,66,95,84,247,252,225,234,219,208,205,198,175,164,185,178,131,136,149,158,71,76,81,90,107,96,125,118,31,20,9,2,51,56,37,46,140,135,154,145,160,171,182,189,212,223,194,201,248,243,238,229,60,55,42,33,16,27,6,13,100,111,114,121,72,67,94,85,1,10,23,28,45,38,59,48,89,82,79,68,117,126,99,104,177,186,167,172,157,150,139,128,233,226,255,244,197,206,211,216,122,
113,108,103,86,93,64,75,34,41,52,63,14,5,24,19,202,193,220,215,230,237,240,251,146,153,132,143,190,181,168,163],Bk=[0,13,26,23,52,57,46,35,104,101,114,127,92,81,70,75,208,221,202,199,228,233,254,243,184,181,162,175,140,129,150,155,187,182,161,172,143,130,149,152,211,222,201,196,231,234,253,240,107,102,113,124,95,82,69,72,3,14,25,20,55,58,45,32,109,96,119,122,89,84,67,78,5,8,31,18,49,60,43,38,189,176,167,170,137,132,147,158,213,216,207,194,225,236,251,246,214,219,204,193,226,239,248,245,190,179,164,
169,138,135,144,157,6,11,28,17,50,63,40,37,110,99,116,121,90,87,64,77,218,215,192,205,238,227,244,249,178,191,168,165,134,139,156,145,10,7,16,29,62,51,36,41,98,111,120,117,86,91,76,65,97,108,123,118,85,88,79,66,9,4,19,30,61,48,39,42,177,188,171,166,133,136,159,146,217,212,195,206,237,224,247,250,183,186,173,160,131,142,153,148,223,210,197,200,235,230,241,252,103,106,125,112,83,94,73,68,15,2,21,24,59,54,33,44,12,1,22,27,56,53,34,47,100,105,126,115,80,93,74,71,220,209,198,203,232,229,242,255,180,185,
174,163,128,141,154,151],Ck=[0,14,28,18,56,54,36,42,112,126,108,98,72,70,84,90,224,238,252,242,216,214,196,202,144,158,140,130,168,166,180,186,219,213,199,201,227,237,255,241,171,165,183,185,147,157,143,129,59,53,39,41,3,13,31,17,75,69,87,89,115,125,111,97,173,163,177,191,149,155,137,135,221,211,193,207,229,235,249,247,77,67,81,95,117,123,105,103,61,51,33,47,5,11,25,23,118,120,106,100,78,64,82,92,6,8,26,20,62,48,34,44,150,152,138,132,174,160,178,188,230,232,250,244,222,208,194,204,65,79,93,83,121,
119,101,107,49,63,45,35,9,7,21,27,161,175,189,179,153,151,133,139,209,223,205,195,233,231,245,251,154,148,134,136,162,172,190,176,234,228,246,248,210,220,206,192,122,116,102,104,66,76,94,80,10,4,22,24,50,60,46,32,236,226,240,254,212,218,200,198,156,146,128,142,164,170,184,182,12,2,16,30,52,58,40,38,124,114,96,110,68,74,88,86,55,57,43,37,15,1,19,29,71,73,91,85,127,113,99,109,215,217,203,197,239,225,243,253,167,169,187,181,159,145,131,141];function Dk(a){for(var b=[],c=0,d=0;d<a.length;d++){for(var e=a.charCodeAt(d);255<e;)b[c++]=e&255,e>>=8;b[c++]=e}return b}function Ek(a,b){for(var c=[],d=0;d<a.length;d++)c.push(a[d]^b[d]);return c};function Fk(a){this.a=a};function Gk(){this.b=-1};function Hk(a,b){this.b=-1;this.b=Ik;this.f=r.Uint8Array?new Uint8Array(this.b):Array(this.b);this.g=this.c=0;this.a=[];this.i=a;this.h=b;this.l=r.Int32Array?new Int32Array(64):Array(64);t(Jk)||(r.Int32Array?Jk=new Int32Array(Kk):Jk=Kk);this.g=this.c=0;this.a=r.Int32Array?new Int32Array(this.h):Va(this.h)}var Jk;C(Hk,Gk);for(var Ik=64,Lk=Ik-1,Mk=[],Nk=0;Nk<Lk;Nk++)Mk[Nk]=0;var Ok=function(a){return La.concat.apply(La,arguments)}(128,Mk);
function Pk(a){for(var b=a.f,c=a.l,d=0,e=0;e<b.length;)c[d++]=b[e]<<24|b[e+1]<<16|b[e+2]<<8|b[e+3],e=4*d;for(b=16;64>b;b++){var e=c[b-15]|0,d=c[b-2]|0,f=(c[b-16]|0)+((e>>>7|e<<25)^(e>>>18|e<<14)^e>>>3)|0,g=(c[b-7]|0)+((d>>>17|d<<15)^(d>>>19|d<<13)^d>>>10)|0;c[b]=f+g|0}for(var d=a.a[0]|0,e=a.a[1]|0,h=a.a[2]|0,k=a.a[3]|0,m=a.a[4]|0,n=a.a[5]|0,p=a.a[6]|0,f=a.a[7]|0,b=0;64>b;b++)var q=((d>>>2|d<<30)^(d>>>13|d<<19)^(d>>>22|d<<10))+(d&e^d&h^e&h)|0,g=m&n^~m&p,f=f+((m>>>6|m<<26)^(m>>>11|m<<21)^(m>>>25|m<<
7))|0,g=g+(Jk[b]|0)|0,g=f+(g+(c[b]|0)|0)|0,f=p,p=n,n=m,m=k+g|0,k=h,h=e,e=d,d=g+q|0;a.a[0]=a.a[0]+d|0;a.a[1]=a.a[1]+e|0;a.a[2]=a.a[2]+h|0;a.a[3]=a.a[3]+k|0;a.a[4]=a.a[4]+m|0;a.a[5]=a.a[5]+n|0;a.a[6]=a.a[6]+p|0;a.a[7]=a.a[7]+f|0}
Hk.prototype.update=function(a,b){t(b)||(b=a.length);var c=0,d=this.c;if(x(a))for(;c<b;)this.f[d++]=a.charCodeAt(c++),d==this.b&&(Pk(this),d=0);else if(v(a))for(;c<b;){var e=a[c++];if(!("number"==typeof e&&0<=e&&255>=e&&e==(e|0)))throw Error("message must be a byte array");this.f[d++]=e;d==this.b&&(Pk(this),d=0)}else throw Error("message must be string or array");this.c=d;this.g+=b};
function Qk(a){var b=[],c=8*a.g;56>a.c?a.update(Ok,56-a.c):a.update(Ok,a.b-(a.c-56));for(var d=63;56<=d;d--)a.f[d]=c&255,c/=256;Pk(a);for(d=c=0;d<a.i;d++)for(var e=24;0<=e;e-=8)b[c++]=a.a[d]>>e&255;return b}
var Kk=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,
4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function Rk(){Hk.call(this,8,Sk)}C(Rk,Hk);var Sk=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];var Tk=null,Uk=null;function Vk(){this.c=[];this.b=this.a=0};function Wk(a){var b=a.creation;a=a.expiration;return!!a&&a<ma()||!!b&&b>ma()};function Xk(a,b,c,d,e,f){this.c=a;this.f=Dk(b);this.g=c;this.a=!!d;this.b=e||"aes-cbc";this.h=!!f;this.i=new ff}Xk.prototype.logger=E("ydn.crypto.Wrapper");
function Yk(a,b){var c=new Rk;c.update(Dk(b));c.update(a.f);c=Qk(c);if(!w(c))throw Error("encodeByteArray takes an array as a parameter");if(!Tk){Tk={};Uk={};for(var d=0;65>d;d++)Tk[d]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(d),Uk[d]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(d)}for(var d=Uk,e=[],f=0;f<c.length;f+=3){var g=c[f],h=f+1<c.length,k=h?c[f+1]:0,m=f+2<c.length,n=m?c[f+2]:0,p=g>>2,g=(g&3)<<4|k>>4,k=(k&15)<<2|n>>6,n=n&63;m||
(n=64,h||(k=64));e.push(d[p],d[g],d[k],d[n])}return e.join("")}
function Zk(a,b,c,d,e){var f=new Rk;f.update(Dk(c));f.update(b);f.update(a.f);c=Qk(f);d=Dk(d);if("rc4"==a.b){b=new Vk;var g;g||(g=c.length);e=b.c;for(a=0;256>a;++a)e[a]=a;for(a=f=0;256>a;++a){var f=f+e[a]+c[a%g]&255,h=e[a];e[a]=e[f];e[f]=h}b.a=0;b.b=0;c=b.a;g=b.b;e=b.c;for(a=0;1536>a;++a)c=c+1&255,g=g+e[c]&255,f=e[c],e[c]=e[g],e[g]=f;b.a=c;b.b=g;c=d;var k;k||(k=c.length);g=b.a;e=b.b;a=b.c;for(f=0;f<k;++f)g=g+1&255,e=e+a[g]&255,h=a[g],a[g]=a[e],a[e]=h,c[f]^=a[a[g]+a[e]&255];b.a=g;b.b=e}else{k=b.length-
d.length%b.length;for(g=0;g<k;g++)d.push(10);k=new mk(c);k=new Fk(k);if(e)for(c=[],g=0,e=b;g<d.length;){b=Ya(d,g,g+16);a=k.a;pk(a,b);rk(a,a.f);for(f=1;f<a.f;++f){uk(a);sk(a,wk);rk(a,a.f-f);for(var h=a.c,m=a.g[0],n=0;4>n;n++)m[0]=h[0][n],m[1]=h[1][n],m[2]=h[2][n],m[3]=h[3][n],h[0][n]=Ck[m[0]]^Ak[m[1]]^Bk[m[2]]^zk[m[3]],h[1][n]=zk[m[0]]^Ck[m[1]]^Ak[m[2]]^Bk[m[3]],h[2][n]=Bk[m[0]]^zk[m[1]]^Ck[m[2]]^Ak[m[3]],h[3][n]=Ak[m[0]]^Bk[m[1]]^zk[m[2]]^Ck[m[3]]}uk(a);sk(a,wk);rk(a,0);e=Ek(e,qk(a));Wa(c,e);e=b;
g+=16}else for(c=[],g=b,b=0;b<d.length;b+=16){e=Ek(Ya(d,b,b+16),g);g=k.a;pk(g,e);rk(g,0);for(e=1;e<g.f;++e){sk(g,vk);tk(g);a=g.c;f=g.g[0];for(h=0;4>h;h++)f[0]=a[0][h],f[1]=a[1][h],f[2]=a[2][h],f[3]=a[3][h],a[0][h]=xk[f[0]]^yk[f[1]]^f[2]^f[3],a[1][h]=f[0]^xk[f[1]]^yk[f[2]]^f[3],a[2][h]=f[0]^f[1]^xk[f[2]]^yk[f[3]],a[3][h]=yk[f[0]]^f[1]^f[2]^xk[f[3]];rk(g,e)}sk(g,vk);tk(g);rk(g,g.f);g=qk(g);Wa(c,g)}d=c}if(8192>d.length)d=String.fromCharCode.apply(null,d);else{k="";for(b=0;b<d.length;b+=8192)k+=String.fromCharCode.apply(null,
Ya(d,b,b+8192));d=k}return d}
function $k(a,b,c){if(c){var d=b;a.a||(d=Yk(a,b));b=c.keyName||c["key-name"];if(b!=a.c)throw a=Error(b),a.name="MasterKeyNotProvidedError",a;b=c.salt;var e=c.data;if(!x(e)||!v(b)||!b.length)throw"Storage: Invalid value was encountered";if(!Wk(c)){d=Zk(a,b,d,e,!0);try{if("rc4"!=a.b){var f=d.lastIndexOf(String.fromCharCode(10));32>=d.length-f&&(d=d.substr(0,f))}c.data=lf(d)}catch(g){if(a.h){try{c.data=eval("("+d+")")}catch(h){}if(!z(!c.data))throw"Storage: The value could not be decrypted";}else throw"Storage: The value could not be decrypted";
}return c.data}}else F(a.logger,b+" corrupted: "+c)}function al(a,b,c,d){for(var e=Yk(a,b),f=[],g=0;16>g;++g)f[g]=256*Math.random()|0;g=[];gf(a.i,c,g);c=Zk(a,f,e,g.join(""));g={};g.salt=f;g.data=c;t(d)||(d=a.g);d&&(g.expiration=d+ma());g.creation=ma();g.keyName=a.c;return a.a?[e,g]:[b,g]};function bl(a){this.a=[];this.c=[];var b=a.expiration,c=a.secrets,d=!!a.encryptKey;this.b=x(a.exposeKey)?a.exposeKey.split("."):a.exposeKey;var e=a.method;if(!c)throw new K("Encryption secrets required.");if(!v(c))throw new K("Encryption secrets must be arrays.");if(t(e)&&-1==["aes-cbc","rc4"].indexOf(e))throw new K("Encryption method must be aes-cbc or rc4, but "+e+" found.");for(var f=0;f<c.length;f++){var g=c[f],h;for(h in g)if(-1==Ma(["name","key"],h))throw new K('Unknown Encryption secret key "'+
h+'"');if(!x(g.name))throw new K("Encryption secret at "+f+" must have name of type string");if(!x(g.key))throw new K("Encryption secret at "+f+" must have key of type string");this.c.push(g.name);this.a.push(new Xk(g.name,g.key,b,d,e,a.unsafeParse))}}bl.prototype.h=function(a,b){null==b&&this.b&&(v(this.b)&&(b=ib(a,this.b)),x(b)||(b=ma()+""+Math.random()));var c=al(this.a[0],b,a);this.b&&(c[1].key=c[0]);return c[1]};
function cl(a,b,c){if(z(c)){for(var d=c.keyName,e=-1,f=0;f<a.c.length;f++)if(a.c[f]==d){e=f;break}if(-1==e)throw a=Error("Master key "+d+" not provided."),a.name="MasterKeyNotProvidedError",a.code=d,a;try{return $k(a.a[e],b,c)}catch(g){}}}bl.prototype.g=function(a,b){this.b&&(b=a.key);return cl(this,b,a)};bl.prototype.f=function(a,b){var c=0;x(c)?c=this.c.indexOf(c):y(b)&&(c=b);return Yk(this.a[c],a)};bl.prototype.count=function(){return this.a.length};W.prototype.Xb=function(a){var b=this;df(a,function(a,d){var e=a.o;if("add"==e||"put"==e){var e=d[2],f=d[1];x(e)?(e=al(b.f.a[0],e,f,void 0),d[2]=e[0],d[1]=e[1]):F(b.logger,'encrypted store key must be a string but "'+e+'" of type '+typeof e+" found")}else if("get"==e){var g=d[0],h=d[1];Wd(a,function(a,c,d){if(b.f.a[0].a){for(var e=[],f=0;f<b.f.count();f++)e[f]=new me(g,b.f.f(h,f));Qb(qg(b.a,e),function(a){for(var c=0;c<a.length;++c){var f=cl(b.f,e[c].G(),a[c]);if(null!=f){d(f);return}}d(void 0)},
function(){d(a,c)})}else a=cl(b.f,h,a),d(a,c)})}else if("rm"==e&&(g=d[0],h=d[1],b.f.a[0].a&&(d[1]=b.f.f(h),1<b.f.count())))for(e=[],f=1;f<b.f.count();f++)e.push(new me(g,h)),og(b.a,e)})};W.prototype.nc=function(a){if(!a)return!1;this.f=new bl(a);return!0};na("ydn.crypto.Cipher",bl);bl.prototype.hash=bl.prototype.f;bl.prototype.encrypt=bl.prototype.h;bl.prototype.decrypt=bl.prototype.g; 
var categ_letters_numbers_data=[[48,57],[65,90],[97,122],170,[178,179],181,[185,186],[188,190],[192,214],[216,246],[248,705],[710,721],[736,740],748
	,750,[880,884],[886,887],[890,893],902,[904,906],908,[910,929],[931,1013],[1015,1153],[1162,1319],[1329,1366],1369
	,[1377,1415],[1488,1514],[1520,1522],[1568,1610],[1632,1641],[1646,1647],[1649,1747],1749,[1765,1766],[1774,1788],1791
	,1808,[1810,1839],[1869,1957],1969,[1984,2026],[2036,2037],2042,[2048,2069],2074,2084,2088,[2112,2136],2208,[2210,2220]
	,[2308,2361],2365,2384,[2392,2401],[2406,2415],[2417,2423],[2425,2431],[2437,2444],[2447,2448],[2451,2472],[2474,2480]
	,2482,[2486,2489],2493,2510,[2524,2525],[2527,2529],[2534,2545],[2548,2553],[2565,2570],[2575,2576],[2579,2600]
	,[2602,2608],[2610,2611],[2613,2614],[2616,2617],[2649,2652],2654,[2662,2671],[2674,2676],[2693,2701],[2703,2705]
	,[2707,2728],[2730,2736],[2738,2739],[2741,2745],2749,2768,[2784,2785],[2790,2799],[2821,2828],[2831,2832],[2835,2856]
	,[2858,2864],[2866,2867],[2869,2873],2877,[2908,2909],[2911,2913],[2918,2927],[2929,2935],2947,[2949,2954],[2958,2960]
	,[2962,2965],[2969,2970],2972,[2974,2975],[2979,2980],[2984,2986],[2990,3001],3024,[3046,3058],[3077,3084],[3086,3088]
	,[3090,3112],[3114,3123],[3125,3129],3133,[3160,3161],[3168,3169],[3174,3183],[3192,3198],[3205,3212],[3214,3216]
	,[3218,3240],[3242,3251],[3253,3257],3261,3294,[3296,3297],[3302,3311],[3313,3314],[3333,3340],[3342,3344],[3346,3386]
	,3389,3406,[3424,3425],[3430,3445],[3450,3455],[3461,3478],[3482,3505],[3507,3515],3517,[3520,3526],[3585,3632]
	,[3634,3635],[3648,3654],[3664,3673],[3713,3714],3716,[3719,3720],3722,3725,[3732,3735],[3737,3743],[3745,3747],3749
	,3751,[3754,3755],[3757,3760],[3762,3763],3773,[3776,3780],3782,[3792,3801],[3804,3807],3840,[3872,3891],[3904,3911]
	,[3913,3948],[3976,3980],[4096,4138],[4159,4169],[4176,4181],[4186,4189],4193,[4197,4198],[4206,4208],[4213,4225],4238
	,[4240,4249],[4256,4293],4295,4301,[4304,4346],[4348,4680],[4682,4685],[4688,4694],4696,[4698,4701],[4704,4744]
	,[4746,4749],[4752,4784],[4786,4789],[4792,4798],4800,[4802,4805],[4808,4822],[4824,4880],[4882,4885],[4888,4954]
	,[4969,4988],[4992,5007],[5024,5108],[5121,5740],[5743,5759],[5761,5786],[5792,5866],[5870,5872],[5888,5900]
	,[5902,5905],[5920,5937],[5952,5969],[5984,5996],[5998,6000],[6016,6067],6103,6108,[6112,6121],[6128,6137],[6160,6169]
	,[6176,6263],[6272,6312],6314,[6320,6389],[6400,6428],[6470,6509],[6512,6516],[6528,6571],[6593,6599],[6608,6618]
	,[6656,6678],[6688,6740],[6784,6793],[6800,6809],6823,[6917,6963],[6981,6987],[6992,7001],[7043,7072],[7086,7141]
	,[7168,7203],[7232,7241],[7245,7293],[7401,7404],[7406,7409],[7413,7414],[7424,7615],[7680,7957],[7960,7965]
	,[7968,8005],[8008,8013],[8016,8023],8025,8027,8029,[8031,8061],[8064,8116],[8118,8124],8126,[8130,8132],[8134,8140]
	,[8144,8147],[8150,8155],[8160,8172],[8178,8180],[8182,8188],[8304,8305],[8308,8313],[8319,8329],[8336,8348],8450,8455
	,[8458,8467],8469,[8473,8477],8484,8486,8488,[8490,8493],[8495,8505],[8508,8511],[8517,8521],8526,[8528,8585]
	,[9312,9371],[9450,9471],[10102,10131],[11264,11310],[11312,11358],[11360,11492],[11499,11502],[11506,11507],11517
	,[11520,11557],11559,11565,[11568,11623],11631,[11648,11670],[11680,11686],[11688,11694],[11696,11702],[11704,11710]
	,[11712,11718],[11720,11726],[11728,11734],[11736,11742],11823,[12293,12295],[12321,12329],[12337,12341],[12344,12348]
	,[12353,12438],[12445,12447],[12449,12538],[12540,12543],[12549,12589],[12593,12686],[12690,12693],[12704,12730]
	,[12784,12799],[12832,12841],[12872,12879],[12881,12895],[12928,12937],[12977,12991],13312,19893,19968,40908
	,[40960,42124],[42192,42237],[42240,42508],[42512,42539],[42560,42606],[42623,42647],[42656,42735],[42775,42783]
	,[42786,42888],[42891,42894],[42896,42899],[42912,42922],[43000,43009],[43011,43013],[43015,43018],[43020,43042]
	,[43056,43061],[43072,43123],[43138,43187],[43216,43225],[43250,43255],43259,[43264,43301],[43312,43334],[43360,43388]
	,[43396,43442],[43471,43481],[43520,43560],[43584,43586],[43588,43595],[43600,43609],[43616,43638],43642,[43648,43695]
	,43697,[43701,43702],[43705,43709],43712,43714,[43739,43741],[43744,43754],[43762,43764],[43777,43782],[43785,43790]
	,[43793,43798],[43808,43814],[43816,43822],[43968,44002],[44016,44025],44032,55203,[55216,55238],[55243,55291]
	,[63744,64109],[64112,64217],[64256,64262],[64275,64279],64285,[64287,64296],[64298,64310],[64312,64316],64318
	,[64320,64321],[64323,64324],[64326,64433],[64467,64829],[64848,64911],[64914,64967],[65008,65019],[65136,65140]
	,[65142,65276],[65296,65305],[65313,65338],[65345,65370],[65382,65470],[65474,65479],[65482,65487],[65490,65495]
	,[65498,65500],[65536,65547],[65549,65574],[65576,65594],[65596,65597],[65599,65613],[65616,65629],[65664,65786]
	,[65799,65843],[65856,65912],65930,[66176,66204],[66208,66256],[66304,66334],[66336,66339],[66352,66378],[66432,66461]
	,[66464,66499],[66504,66511],[66513,66517],[66560,66717],[66720,66729],[67584,67589],67592,[67594,67637],[67639,67640]
	,67644,[67647,67669],[67672,67679],[67840,67867],[67872,67897],[67968,68023],[68030,68031],68096,[68112,68115]
	,[68117,68119],[68121,68147],[68160,68167],[68192,68222],[68352,68405],[68416,68437],[68440,68466],[68472,68479]
	,[68608,68680],[69216,69246],[69635,69687],[69714,69743],[69763,69807],[69840,69864],[69872,69881],[69891,69926]
	,[69942,69951],[70019,70066],[70081,70084],[70096,70105],[71296,71338],[71360,71369],[73728,74606],[74752,74850]
	,[77824,78894],[92160,92728],[93952,94020],94032,[94099,94111],[110592,110593],[119648,119665],[119808,119892]
	,[119894,119964],[119966,119967],119970,[119973,119974],[119977,119980],[119982,119993],119995,[119997,120003]
	,[120005,120069],[120071,120074],[120077,120084],[120086,120092],[120094,120121],[120123,120126],[120128,120132],120134
	,[120138,120144],[120146,120485],[120488,120512],[120514,120538],[120540,120570],[120572,120596],[120598,120628]
	,[120630,120654],[120656,120686],[120688,120712],[120714,120744],[120746,120770],[120772,120779],[120782,120831]
	,[126464,126467],[126469,126495],[126497,126498],126500,126503,[126505,126514],[126516,126519],126521,126523,126530
	,126535,126537,126539,[126541,126543],[126545,126546],126548,126551,126553,126555,126557,126559,[126561,126562],126564
	,[126567,126570],[126572,126578],[126580,126583],[126585,126588],126590,[126592,126601],[126603,126619],[126625,126627]
	,[126629,126633],[126635,126651],[127232,127242],131072,173782,173824,177972,177984,178205,[194560,195101]];
;

//# sourceMappingURL=ydn.db-isw-sql-e-crypt-cur-qry-text-dev.js.map
return ydn;}, (this || {}));
            